---
title: "Northern Pikeminnow Predation on Juvenile Chinook Salmon and Potential Impacts to Local Populations"
author:
  - Richard A. Carmichael:
      email: Richard.Carmichael@merck.com
      institute: [biomark]
      correspondence: true
  - Nicholas J. Porter:
      email: Nicholas.Porter@merck.com
      institute: [biomark]
      correspondence: false
  - Kevin E. See:
      email: Kevin.See@dfw.wa.gov
      institute: [biomark, wdfw]
      correspondence: false
  - Michael S. Hall:
      email: Mike.Hall1@merck.com
      institute: [biomark]
      correspondence: false
  - Tara E. Blackman:
      email: tara.blackman@mthoodenvironmental.com
      institute: [mhe]
      correspondence: false
  - Michael W. Ackerman:
      email: mike.ackerman@mthoodenvironmental.com
      institute: [biomark, mhe]
      correspondence: false
institute:
  - biomark: Biomark, Inc., 705 South 8th Street, Boise, Idaho, 83702, USA
  - wdfw: Washington Department of Fish and Wildife, Under A Bridge, Seattle, Washington, 00000, USA
  - mhe: Mount Hood Environmental, PO Box 4282, McCall, Idaho, 83638, USA
date: "`r format(Sys.time(), '%d %B, %Y')`"
always_allow_html: true
output: 
    bookdown::html_document2:
      fig_caption: yes
      number_sections: FALSE
      toc: no
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua      
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      number_sections: FALSE
      toc: no
      always_allow_html: true
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
fontsize: 12pt
mainfont: Times New Roman
bibliography: 
- references.bib      # Kevin's library
- AckermanLibrary.bib # Mike's library
csl: "../templates/american-fisheries-society.csl" # Insert path for the bib-style
abstract: |
  Abstract text here. 
keywords: |
  northern pikeminnow; Chinook salmon; predation; mark-recapture; bioenergetics
highlights: |
  These are the highlights. 
---

Keywords: `r rmarkdown::metadata$keywords`

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)
```

```{r load-libraries}
library(tidyverse)
library(magrittr)
library(lubridate)
library(tidytable)
library(janitor)
library(purrr)
library(here)
library(FSA)
library(knitr)
library(kableExtra)
library(stringi)

# format NA values in tables
options(knitr.kable.NA = '-')

# set default theme for figures
theme_set(theme_bw())

# when knitting to Word, use this
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')

if(doc.type == 'docx') {
  options(knitr.table.format = "pandoc")
}

```

\newpage

# Introduction

The Upper Salmon River major population group (MPG) supports eight independent, extant spring/summer Chinook Salmon *Oncorhynchus tshawytscha* populations including Salmon River (above Redfish Lake), Valley Creek, Yankee Fork Salmon River, East Fork Salmon River, Salmon River (mainstem below Redfish), Pahsimeroi River, Lemhi River, and North Fork Salmon River [@NOAA2017]. At least five of these eight populations must meet criteria set forth by @McElhany2000 and @ICTRT2007 for the MPG to be considered viable and for the recovery of the Snake River Evolutionary Significant Unit (ESU). Populations within the ESU have substantial cultural value, support downriver mainstem Snake and Columbia River commercial and subsistence fisheries, and support local fisheries and economies in years with sufficient abundance. All populations within the Upper Salmon River MPG have become depleted in recent decades. Declines in survival of juvenile Chinook Salmon have been attributed to the removal of beavers from the landscape (fur trade), mining activities, river simplification, water withdrawals, logging activities, urbanization, avian predation, proliferation of non-native species (e.g., non-native coastal rainbow trout *O. mykiss irideus* and brook trout *Salvelinus fontinalis*), warming streams and rivers, and modifications to downriver migration corridors (e.g., from hydropower projects). Moreover, the abundance of returning adults are further impacted by ocean and downriver harvests, poor ocean conditions, and changes to the spawning migration corridor. Each of these factors have contributed, to varying and unknown extents, to reduced adult escapement, the primary metric used to assess population viability. In response to the decline in Chinook Salmon abundance from the myriad human activities and associated habitat degradation, action agencies have attempted to improve juvenile survival and adult spawning conditions by investing in the rehabilitation of tributary ecosystems.

One potentially important, but perhaps under-appreciated source of mortality for Chinook Salmon is predation on emigrating juveniles by piscivorous fishes, including both native and non-native species. Dams and reservoirs in the Columbia River basin are the primary locations associated with high rates of predation on salmonids [@Petersen1994; @Ward1995]. There are generally two maechanisms that explain these high predation zones. First, migration rates of juvenile Chinook Salmon are reduced during reservoir passage [@Venditti2000], thereby increasing the time migrating smolts are vulnerable to predation. Second, reservoirs and downstream tailraces created by dams on the Columbia and Snake rivers have created favorable slow-water habitat for several species of piscivorous fish known to consume juvenile Chinook Salmon including Walleye *Sander vitreus*, Smallmouth Bass *Micropterus dolomieu*, and Northern Pikeminnow *Ptychocheilus oregonensis*. In the Lower Granite Reservoir on the Snake River, juvenile Chinook Salmon are common prey items of non-native Smallmouth Bass during some seasons [@Erhardt2018]. Walleye also prefer slow water habitats and are considered a potentially important source for Juvenile Chinook Salmon mortality [@NOAA2020], particularly as their abundance has significantly increased in Snake River dam facilities between 2008 and 2020.

In addition to non-native species, Northern Pikeminnow are a native, piscivorous fish preferring slow water habitats. Consequently, they too have benefited from dams on the Columbia River and become abundance predators on salmonid outmigrants [@Knutsen1999]. Indeed, Northern Pikeminnow are estimated to consume 8% (16.4 million) of the estimated 200 million juvenile salmonids emigrating through the lower Snake and Columbia rivers, annually [@Beamesderfer1996]. Predation by piscivorous fish may have been a factor in the below-average survival of wild Chinook Salmon in 2020 [@NOAA2020], however there is a dearth of current data on piscivorous predator populations in the Columbia River.

Habitat containing slow-velocities and other attributes that support piscivorous predators are not limited to dams and reservoirs. One such area is the Deadwater Slough in the Salmon River, which occupies a 25.3-acre reach of unnaturally slow and deep water (Figure \@ref(fig:map)). The Deadwater Slough contains little to no cover, increased depth, and fine substrate which favor piscivorous fish predators (e.g., Northern Pikeminnow, Smallmouth Bass) [@Watkins2015]. @Axel2015 demonstrated decreased rates of emigration and apparent survival for Sockeye Salmon *Oncorhynchus nerka* from Redfish Lake emigrating during the spring. Further, recent winter telemetry studies have indicated decreased transition probabilities (approximately 10% less than surrounding reaches) of juvenile Chinook salmon through Deadwater Slough during fall and winter months [@Ackerman2018; @Porter2019].

<!--
* @Axel2015 found increased mortality in a particular reach spanning location x to location y in the mainstem Salmon River on a study of juvenile (hatchery?) sockeye salmon released near Redfish Lake and actively migrating downriver.
  - in their case, these were actively migrating juveniles, and so transitional probabilities can likely be interpreted (almost) directly as survival
  - A previous study showed that the lowest transitional probabilities of Red Fish Lake Sockeye occurred in the Dead Water reach.
* @Ackerman2018 and @Porter2019, @Porter2020 found reduced (apparent) survival in a reach spanning near the town of North Fork to just downstream of Deadwater Slough.
  - in these cases, there's a chance that juvenile Chinook could exhibit concealment behavior prior to winter and so transition probability is interpreted as the probability of a fish surviving AND moving
* Anecdotally, locals (and others? maybe NOAA?) informed us that northern pikeminnow and perhaps other species are prevalent in Deadwater Slough.
-->

Spring/summer Chinook Salmon in the Upper Salmon MPG are stream-type and exhibit two distinct migration tactics; downstream rearing (DSR) and natal reach rearing (NRR) [@Copeland2014]. The DSR migrants leave the natal spawning area as subyearlings between June and November and typically overwinter in downstream, mainstem habitats until the following spring when they emigrate to the ocean as smolts. Alternatively, NRR migrants remain in their natal spawning areas for approximately one year after emergence until emigration to the ocean as smolts. Diversity of migratory tactics provides a mechanism for coping with adverse conditions in freshwater rearing and migration environments and buffers against catastrophic events, thereby increasing population resiliency.

The Deadwater Slough is in a reach of the Salmon River that is believed to be a historically important overwinter rearing area for DSR emigrants. Moreover, this reach is part of the migratory pathway for juvenile DSR and NRR emigrants from all eight extant populations. The slough lacks hydrological and structural features (i.e., a homogenous channel with fine substrate and little cover) that can provide essential refuge from predation. As a result, predation on juvenile Chinook salmon proximal to the Deadwater Slough has been cited as a concern for the Upper Salmon River MPG, impacting DSR migrants in the fall and NRR emigrants during the spring.

We hypothesize that increased densities of piscivorous predators in the Deadwater Slough may explain the reduced survival (or apparent survival) observed for juvenile Chinook Salmon [@Ackerman2018] and Sockeye Salmon [@Axel2015]. In this study, we estimated the abundance of a piscivorous fish predator population in the Deadwater Slough and their potential impacts to juvenile salmon emigrants, focusing on DSR and NRR Chinook Salmon. Our objectives for the study were four-fold:

1. Estimate the abundance (or relative abundance) of potential predators in the Deadwater Slough during the peaks of fall (DSR) and spring (NRR) juvenile emigrations.
2. Document predation on juvenile Chinook Salmon during the emigration periods using gastric lavage.
3. Use a bioenergetics approach to estimate the total consumption of juvenile DSR and NRR Chinook salmon during defined emigration periods.
4. Quantify the potential impacts of estimated predation on juvenile to Chinook Salmon adult returns.

We follow with a discussion of the various assumptions that went into the mark-recapture and bioenergetics models and assessment of impacts to adult returns and how violations of some assumptions may affect overall results and inferences from the study.


# Methods

## Study Site

The Deadwater Slough is an approximately 1.5 kilometer section of the mainstem Salmon River located roughly 5.8 river kilometers downstream from the town of North Fork, Idaho (Figure \@ref(fig:map)). The downstream end of the slough is located at the confluence of Dump Creek and the Salmon River. Around 1897, the failure of a small mining diversion reservoir in the Dump Creek drainage resulted in an erosion event that deposited substantial amounts of sediment at the confluence of the Salmon River, thereby creating an unnaturally slow and deep section in the river, spanning approximately 30 acres and averaging 68 m width. Both northern pikeminnow *Ptychocheilus oregonensis* and smallmouth bass *Micropterus dolomieu* inhabit the slough which likely provides favorable conditions for their feeding and growth (e.g., reduced water velocity, deep channel, warmer water temperature).


## Abundance of Piscivorous Fishes

```{r cmr-effort-data}
raw_df = readxl::read_excel(here("analysis/data/raw_data/Deadwater_predation_mark_recapture_11.09.21.xlsx")) %>%
  clean_names() %>%
  mutate(across(date,
                ymd)) %>%
  mutate(across(c(start_time, end_time),
                ~ ymd_hms(paste(year(date), month(date), day(date), hour(.), minute(.), second(.))))) %>%
  # split into sampling periods
  mutate(event_name = if_else(month(date) > 8,
                              paste("Fall", year(date), sep = "_"),
                              paste("Spring", year(date), sep = "_")))

# focus on pikeminnow
cmr_df = raw_df %>%
  filter(count > 0) %>%
  # pull out only Northern Pikeminnow
  filter(species == "Northern Pikeminnow") %>%
  mutate(mark_release = if_else(fish_status == "Live" &
                                  capture_type == "Mark",
                                T, F),
         recap = if_else(capture_type == "Recapture",
                         T, F))

effort_df = raw_df %>%
  select(event_name,
         site,
         date,
         crew,
         crew_count,
         method,
         equipment,
         start_time:total_effort,
         total_day_effort) %>%
  distinct() %>%
  mutate(across(total_effort,
                ~ . * crew_count)) %>%
  group_by(event_name,
           date) %>%
  summarise(across(total_effort,
                   sum),
            .groups = "drop") 

cpue_df = effort_df %>%
  # add how many pikeminnow were caught
  left_join(cmr_df %>%
              group_by(event_name, species, date) %>%
              summarise(n_fish = n(),
                        .groups = "drop")) %>%
  mutate(cpue = n_fish / total_effort)

```

```{r lincoln-petersen-estimator}
# using Lincoln-Petersen model, combining first 4 and last four days
# define mark and recapture periods
cap_periods = tibble(event_name = "Fall_2019",
                     cap_period = "Mark",
                     int = interval(start = ymd('20191112'),
                                    end = ymd('20191114'))) %>%
  bind_rows(tibble(event_name = "Fall_2019",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20191119'),
                                  end = ymd('20191121')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Mark",
                   int = interval(start = ymd('20201020'),
                                  end = ymd('20201023')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20201027'),
                                  end = ymd('20201030'))))

cmr_df$cap_period = NA_character_
for(i in 1:nrow(cap_periods)) {
  my_int = cap_periods$int[i]
  index = which(cmr_df$date %within% my_int)
  cmr_df$cap_period[index] = cap_periods$cap_period[i]
}


LP_mod = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species) %>%
  summarise(M = sum(cap_period == "Mark" & fish_status == "Live", na.rm = T),
            n = sum(cap_period == "Recapture"),
            m = sum(cap_period == "Recapture" & capture_type == "Recapture", na.rm = T),
            .groups = "drop") %>%
  nest(data = -c(event_name, species)) %>%
  crossing(model = c("Petersen",
                     "Chapman")) %>%
  mutate(mr_model = map2(data,
                       model,
                      .f = function(x, y) {
                        with(x,
                             mrClosed(M = M,
                                      n = n,
                                      m = m,
                                      method = y))
                      }),
         N_summ = map(mr_model,
                      .f = summary,
                      incl.SE = T),
         CI = map(mr_model,
                  .f = confint)) %>%
  mutate(N = map_dbl(N_summ,
                     .f = function(x) x[1]),
         SE = map_dbl(N_summ,
                      .f = function(x) x[2]),
         Lci = map_dbl(CI,
                         .f = function(x) x[1]),
         Uci = map_dbl(CI,
                         .f = function(x) x[2])) %>%
  select(-N_summ, -CI)

```

```{r schnabel-estimator, eval = T}
# using Schnabel and Schumacher-Eschmeyer estimators
N_mods = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species, date) %>%
  summarise(n = n(),
            m = sum(capture_type == "Recapture", na.rm = T),
            u = sum(capture_type == "Mark" | is.na(capture_type)),
            R = sum(fish_status == "Live", na.rm = T),
            .groups = "drop") %>%
  group_by(event_name, species) %>%
  mutate(M = lag(R - m),
         M = replace_na(M, 0),
         M = cumsum(M)) %>%
  nest() %>%
  crossing(model = c("Schnabel",
                     "SchumacherEschmeyer")) %>%
  mutate(mr_model = map2(data,
                         model,
                         .f = function(x, y) {
                           with(x,
                                mrClosed(n = n,
                                         m = m,
                                         R = R,
                                         method = y,
                                         chapman.mod = TRUE))
                         }),
         N = map_dbl(mr_model,
                     .f = summary),
         CI = map(mr_model,
                  .f = confint),
         Lci = map_dbl(CI,
                       .f = function(x) x[1]), 
         Uci = map_dbl(CI,
                       .f = function(x) x[2])) %>%
  ungroup() %>%
  select(-CI)

```

**Data = C/M/R and Effort**

* Capture methods used - We initially attempted electrofishing, snorkeling, netting, others?, but eventually settled on angling as best method for mark-recapture.
* Mark-recapture - We kept the mark and recapture events close together in an attempt to use a closed population model
* What are the assumptions of a closed population model?
* How was sampling performed? What relevant information was captured for each fish? How/where were fish released? How was effort recorded to calculate CPUE?
* Description of sampling time frame:
  - Fall 2019: Goal was to estimate abundance during the peak of DSR emigration i.e., timing was done to coincide to be shortly after peak fall (DSR) emigration at the lower Lemhi River screw trap with the hopes of documenting predation. DSR are the more abundant juvenile emigration tactic.
  - Fall 2020: Intent was to repeat the above, but instead during peak NRR emigration, but effort canceled due to COVID-19. Instead, sampling was re-schedule to fall when social distancing, etc. could be put in place.
  - Spring 2021: Did a relative abundance effort during spring 2021. Had to reduce to a CPUE (single-week) effort due to funding constraints. However, goal was to 1) document presence during NRR outmigration and 2) estimate CPUE to provide a relative comparison to the fall efforts.

All of our estimators rely on meeting several assumptions:
1. The population in closed (no immigration, emigration, births or deaths during the sampling period).
1. Marking a fish does not affect its chances of being caught
1. No loss of marks
1. No marks are missed or mistaken
1. All fish have the same chance of being caught in the second (and subsequent) sample(s)

We applied several abundance estimators, which fell into two broad categories: single census and multiple census. For the single census estimators, we treated the first week of sampling as the mark event, and the second week as the recapture event, pooling data within each of those weeks. The multiple census estimators treat each day as a survey, and use information about the total marked fish from all previous surveys to infer the total abundance.

The Lincoln-Petersen estimator is below, where $M$ is the number of fish marked and returned to the population, $n$ is the number of fish caught in the second/recapture event and $m$ is the number of marked fish in the second sample.

$$
\hat{N} = \frac{(M)(n)}{(m)}
$$

  
The Lincoln-Petersen estimator can be biased with small samples, so we also investigated the Chapman-modified Lincoln-Petersen estimator which is shown below.

$$
\hat{N} = \frac{(M + 1)(n + 1)}{(m + 1)} - 1
$$

The Schnabel estimator is shown below, where the $M$, $n$ and $m$ are indexed by the sampling occasion, $i$. In our example, the sampling occasions are defined as each day of sampling. This estimator does not have an associate standard error, but 95% confidence intervals can be calculated. The Schnabel estimator is essentially a weighted average of a series of Lincoln-Petersen estimators (with a Chapman modification). 

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M_i}{\left(\sum\limits_{i = 1}^k m_i \right) + 1}
$$

There is another estimator for this type of multiple census surveys, called the Schumacher-Eschmeyer estimator, which is based on minimizing the weighted sum of squares between the proportion of marked individuals in the sample and the unknown proportion of marked individuals in the population. It is shown below.

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M^2_i}{\sum\limits_{i = 1}^k m_i M_i}
$$
We additionally calculated the proportional stock density (PSD) of Northern Pikeminnow with 300 mm total length (TL) for stock and 400 mm TL for quality.
$$
PSD_{i} = 100 * \frac{FQ_{i}}{FS_{i}}
$$
where $FQ_{i}$ is the number of fish $\ge$ quality-length for species $i$, and $FS_{i}$ is the number of fish $\ge$ stock-length for species $i$.


## Predation On Juvenile Chinook Salmon

```{r gastric-data}
gastric_df = raw_df %>%
  filter(species == "Northern Pikeminnow") %>%
  mutate(fish_or_parts = case_when(stri_detect_fixed(stomach_contents, "Fish") ~ "Fish or Fish Parts",
                                   stri_detect_fixed(stomach_contents, "Empty") ~"Empty",
                                   stri_detect_fixed(comments, "Whole scuplin") ~ "Fish or Fish Parts",
                                   stri_detect_fixed(stomach_contents, "Whitefish") ~ "Fish or Fish Parts",
                                   TRUE ~ "Other")) %>%
  drop_na(length) %>%
  mutate(non_fish_wt = stomach_contents_weight - fish_content_weight) %>%
  dplyr::select(date, length, lavage_id, stomach_contents, comments, fish_or_parts, stomach_contents_weight, non_fish_wt,                  fish_content_weight) %>%
  filter(!stomach_contents %in% c("Lost sample CG27-001", "Did Not Lavage")) %>%
  drop_na(stomach_contents)
  
```

Gastric lavage [@Foster1977] was used to examine the stomach contents of Northern Pikeminnow for the presence of juvenile Chinook Salmon, other fishes (e.g., juvenile steelhead, juvenile Sockeye Salmon, Redside Shiner, etc.), and non-targets (e.g., macroinvertebrates, organic matter, etc.). Stomach contents were preserved with 99% isopropyl alcohol in whirl-paks and analyzed in a laboratory. For each sample, wet weight (grams) was recorded for the combined stomach content and for the fish content. Fish and fish remnants were identified to the lowest taxonomic unit, when possible, or were categorized as unknown. A subset of Northern Pikeminnow captures were euthanized for dissection after gastric lavage to validate the efficacy of the methodology.


## Bioenergetics

```{r shoup-temp-data}
temp_df = read_tsv(here("analysis/data/raw_data/USGS_13307000_Salmon_River_Nr_Shoup.txt"),
                   comment = "#") %>%
  rename(discharge_cfs = `47768_00060`,
         discharge_cfs_cd = `47768_00060_cd`,
         gage_ht_ft = `47769_00065`,
         gage_ht_ft_cd = `47769_00065_cd`,
         water_temp_c = `47773_00010`,
         water_temp_c_cd = `47773_00010_cd`)

```

To estimate the consumption of juvenile Chinook Salmon outmigrants by Northern Pikeminnow in the Deadwater Slough, we used the Fish Bioenergetics v4.0 applicatioon developed by @Deslauriers2017. The daily rate of consumption in grams for an individual Northern Pikeminnow was based on predator and prey energy densities, predator start and end weights, and water temperatures. Predator energy density for Northern Pikeminnow was fixed at 6,703 Joules(J)/g [@Deslauriers2017]. Prey energy densities were fixed at 21,500 J/g for juvenile Chinook salmon based on estimate from @Moss2016. To calculate the average predator start weight, we converted the average length of Northern Pikeminnow captured during our study to a weight using a weight-length formula for Northern Pikeminnow [@Parker1995] from the FSA package [@Ogle2021]. Continuous water temperature data from 2019 were used in two alternative models, on using the baseline start and end weights and the second with a 10% increase in average end weight of Northern Pikeminnow.

We ran three bioenergetic models for this study. For the first model, we chose a 78-day period from September 1 through November 17 when DSR emigrants are known to enter the mainstem Salmon River from natal tributaries (e.g., Lemhi River) and begin their downstream migration. During this time, water temperatures exceed the range (0-7$^\circ$C) that would illicit concealment behavior or torpor from juvenile Chinook Salmon. This model assumed no growth for Northern Pikeminnow. The second model was run for one-year and assumed no growth for Northern Pikeminnow. The assumption of no growth for pikeminnow was included to show what may be occurring if the populaiton of Northern Pikeminnow is stable. If growth of the population is occurring, the alternative model shows how an increase of 10% body weight changes the estimtes of consumption over a full year period. To estimate the number of possible Chinook Salmon that could be consumed, we assumed a weight of 12 g per individual Chinook Salmon. This weight was an average from juvenile Chinook Salmon emigrating past six rotary screw traps operating in the Upper Salmon above Deadwater Slough including traps in the Lemhi, Pahsimeroi, and North Fork Salmon rivers and one trap operating near the Sawtooth hatchery.

<!--
To estimate the impacts from northern pikeminnow on juvenile Chinook Salmon outmigrants in Deadwater Slough, we used an R-based application of Fish Bioenergetics v4.0 developed by @Deslauriers2017. We estimated a daily rate of consumption for an individual northern pikeminnow based on predator and prey energy densities, water temperatures, and predator start and end weights. We also ran two alternative models one with a year of temperature inputs from 2019, and another with the same temperature inputs but a 10% growth in weight of the average pikeminnow at the end of the model. The average length of northern pikeminnow captured at the Deadwater Slough during our study was 370.6 mm which calculates to an average starting weight of 847 g using the FSA package (@Ogle2021) in R which provides a weight-length formula for northern pikeminnow sourced from @Parker1995. Predator energy density for northern pikeminnow was available in the Bioenergetics v4.0 application and was fixed at 6,703 Joules(J)/g. Prey energy densities was taken from @Moss2016 where they estimated juvenile Chinook Salmon at 21,500 J/g. Using these temperatures, weights, and energy inputs, we estimated a total consumption in grams for an individual norther pikeminnow within Deadwater Slough.

We ran three bioenergetic models for this study. First, we chose a 78-day period from September 1 through November 17 where we know Chinook Salmon DSR emigrants begin to enter the mainstem Salmon River from natal tributaries (e.g., Lemhi River) and begin to migrate downstream, but when temperatures are still high enough that juveniles are not yet exhibiting concealment behavior or torpor. The second model was still assuming no growth but taking the entire year into account for the model rather than the 78-day fall period. The assumption of no growth for pikeminnow was included to show what may be occurring if the population of northern pikeminnow is stable. If growther of the population is occurring, the alternative model shows how an increase of 10% body weight changes the estimates of consumption over a full year period. To estimate the number of possible Chinook Salmon that could be consumed, we assumed a weight of 12 g per individual chinook Salmon. This weight was an average from juvenile Chinook salmon emigrating past six rotary screw traps operating in the Upper Salmon above Deadwater Slough including traps in the Lemhi, Pahsimeroi, and North Fork Salmon rivers and one trap operating near the Sawtooth hatchery.
-->


## Impacts to Adult Returns

Text here...

<!-- After making some assumptions (e.g., on SARs) attempt to estimate how results from objective #3 could translate into impacts on adult returns (via a thought experiment or simulation approach) -->


# Results

## Abundance of Piscivorous Fishes

```{r abund-est}
all_est = LP_mod %>%
  select(event_name, species, model, N:Uci) %>%
  bind_rows(N_mods %>%
             select(event_name, species, model, N:Uci)) %>%
  mutate(range = Uci - Lci,
         prop_range = range / N) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  mutate(model = fct_recode(model,
                            "Schumacher-Eschmeyer" = "SchumacherEschmeyer")) %>%
  arrange(event_name, model)
```

<!--
* Total population estimates of Pike Minnow. Chart or table, but likely a chart.
* What is that equate to as a density? e.g., how many pikeminnow per 10 square meters? Is that a reasonable number?
-->

PSD for northern pikeminnow across all three years was 42.26% or 42.26% of fish were over the quality size classification 400 mm TL we denoted in the Methods, demonstrating a high percentage of above average size classs present within Deadwater Slough.


## Predation On Juvenile Chinook Salmon

During 2019, 660 northern pikeminnow were gastric lavaged. Of those fish, 603 had empty stomachs, 57 had stomach contents, 12 had fish parts, and of those 12 with fish parts 1 MWF and 2 shiners. During the 2020 season 805 northern pikeminnow were gastric lavaged with 613 empty stomachs, 188 with stomach contents and 23 with fish parts. Out of the 23 stomachs with fish parts present 10 were unknown, 6 red sided shiner, 4 suckers, 2 sculpin, and 1 chinook. In 2021, we had 105 stomach samples with 98 being non-fish and 7 having fish or fish parts.

<!--- Need to add Nick's gastric lavage table here -->

## Bioenergetics

<!-- Need to add Nick's figures here -->

Over the fall time period a single northern pikeminnow is modeled to eat 61 g of fish. If we extrapolate this out to the potential effect the estimated population of ***xx,xxx***, then ***xxx,xxx*** g of fish are being eaten each fall during the migration of juvenile Chinook salmon having the potential to consume ***xxx** juvenile Chinook as a discrete population.

Over the point of a whole year, a single northern pikeminnow is modeled to eat 283 g of fish and 613 g of other food types.

<!--
* Water Temperature measurements.
    *	Hobo tidbit placed at site. 
    *	Calculated daily average water temperature for 365 days of the year.
*	Water temperature plot for the 365 average.
*	Bioenergetics results. Total mass consumed over a 365 day period. Plot of daily consumption with day of year on x and mass on y.
-->


## Impacts to Adult Returns

*	SAR results. Maybe a plot of multiple scenarios depending on gastric lavage results? And pop estimates if they vary in time.


# Discussion

We estimated the population size of Northern Pikeminnow in the Deadwater Slough to be greater than ***xx,xxx*** during the fall emigration period for DSR Chinook Salmon. That estimate translates to a density of ***xxx*** Northern Pikeminnow per 100 m or ***xxx*** per 100 m^2^ which is ***similar/more/less*** than estimates from elsewhere in the Columbia River ***(citation)*** where substantial Northern Pikeminnow predation impacts on salmonids have led to bounty programs aimed at reducing Northern Pikeminno abundance. The population size of Northern Pikeminnow was not directly estimated during the spring NRR Chinook salmon emigration period however, the relative abundance measured at CPUE was comparable to the fall sampling periods ***(update statement later)***. The population of Northern Pikeminnow in Deadwater Slough was estimated to consume between ***xx,xxx*** and ***xx,xxx*** juvenile Chinook Salmon during the ***x*** sampling periods and result in an estimated reduction of returning adults between ***xxx*** and ***x,xxx***. We suggest that the habitat modifications that created the Deadwater Slough have resulted in favorable conditions for Northern Pikeminnow, including improved conditions for predation upon juvenile Chinook Salmon ***(add detail here)***. Therefore, predation by Northern Pikeminnow in the Deadwater Slough likely has a consequential impact on ESA-listed Chinook Salmon populations in the Upper Salmon River MPG.


## Mark-Recapture Model

<!--
Re-hash out our assumptions? What assumptions were most likely violated e.g., the closed population assumption? If we assumed an open population with varying immigration/emigration rates how might that affect our estimate? In the end, how good do we think our estimate is and is the bottom-line that we belive there still to be a shit-ton of pikeminnow even if our assumptions were violated?
-->


## Gastric Lavage

The majority of fish collected during this study received gastric lavage, including some non-predatory species. To validate the efficacy of this method, we euthanized nine Northern Pikeminnow after gastric lavage was completed and removed the remaining stomach contents via dissection. Our results support previous findings that gastric lavage effectively removes stomach contents (@Lott2020). Additionally, we found that the fish captured in net-traps had a similar proportion of stomach content samples. of those, 1,214 (76.2%) were completely emply, 345 (21.6%) had stomach contents, and 35 (2.2%) contained fish remnants. We were able to identify juvenile Red Shiners, a Largescale Sucker, Sculpin, Mountain Whitefish, and one Chinook Salmon within stomach contents, but most samples were too digested to identify to species.

<!--
Concerns with gastric lavage. We only observed juvenile Chinook salmon (and/or other fishes) in a very small number of stomach contents. However, we don't necessarily believe that to mean that pikeminnow in Deadwater Slough rarely consume juvenile Chinook salmon. Are there other cases where gastric lavage failed to document predation? How soon after consumption do you need to take a sample? So instead, we made some assumptions about the proportion of a pikeminnows diet consisting of Chinook salmon.
-->

## Bioenergetics

What assumptions did we make during the bioenergetics assessment? And how might violations of those assumptions change our estimate of the number of juvenile Chinook salmon consumed and resulting impacts to adult returns?


## Impacts to Adult Returns

Again, what assumptions did we make here and how might violations of those assumptions change our estimate of impacts to adult returns.


## Avian Predation

Although not formally assessed in this study, avian predators including Great Blue Herons *Ardea herodias* and Bald Eagles *Haliaeetus leucocephalus* are another potential source of mortality for juvenile salmon in the Deadwater Slough. The Deadwater Slough is recognized as an important bird watching and nesting area due to the associated riparian and backwater habitats [(Deadwater Slough - Audubon Important Bird Areas)](https://www.audubon.org/important-bird-areas/deadwater-slough#). Several piscivorous bird species have been documented using the Deadwater Slough that include the Common *Mergus merganser* and Hooded *Lophodytes cucullatus* mergansers, the Great Blue Heron, the Double-crested Cormorant *Phalacrocorax auritus*, and the Belted Kingfisher *Megaceryle alcyon* [@eBird2021]. During the intial sampling event in 2019, a two-person crew walked the entire reach and surrounding and upstream areas scanning for passive integrated transponder (PIT) tags. During that informal survey, nine PIT tags were recovered near active bird nests or in an upstream anastomizing reach where herons and eagles are prevalent, suggesting that mortality may have been a result of avian predation. The PIT tag histories in [PTAGIS](https://www.ptagis.org/) indicate these tags were implanted into a combination of juvenile Chinook Salmon (3), Sockeye Salmon (3), and steelhead (3). Avian predation contributes a major component of the total mortality for yearling Chinook Salmon in some locations in the lower Snake River and Columbia River, particularly at hydroelectric dams and within reservoirs [@Evans2012; -@Evans2016]; however, we did not observe large colonies of piscivorous birds within the study area. Although there is documentation of individual Double-crested Cormorants [@eBird2021] at the Deadwater Slough, the site is not within their breeding range, rather, it is part of a migration corridor. Given the current avian species known to occupy Deadwater Slough, it is unlikely that avian predation on juvenile salmonids is comparable to elsewhere in the Columbia River basin with large piscivorous bird colonies. Nevertheless, we hypothesize that the reservoir-like conditions at the Deadwater Slough may increase the probability of avian predation on juvenile Chinook Salmon from the many piscivorous birds known to use the site. Future estimates of predation would benefit from consideration of the contribution of piscivorous avian predators.


## Management Implications

We estimated that consumption of juvenile Chinook Salmon by northern pikeminnow in the Deadwater Slough potentially reduces annual adult returns by ***xxx - x,xxx*** to upriver populations. Presumably, that reduction in adult returns impacts both the ESA-listed natural populations in the Upper Salmon River MPG plus the two hatchery populations in the Upper Salmon, Pahsimeroi and Sawtooth hatcheries, which provide for recreational fishing opportunities. Fisheries managers desire increased adult returns to both aide in the recovery of natural populations as well as to provide additional harvest in recreational fisheries to boost local economies. A reduction in predation mortality at Deadwater Slough on juvenile Chinook Salmon has potential to benefit multiple upriver natural and hatchery populations, in contrast to typical tributary habitat rehabilition actions which typically benefit a single population. Moreover, the deepened, slack water conditions that favor northern pikeminnow at Deadwater Slough are indirectly the result of manmade activities i.e., the failure of a manmade mining reservoir dam. Given these reasons, it seems that Deadwater Slough could be a candidate for management or restoration actions to benefit local Chinook Salmon populations.

We see two potential management actions: 1) removing the Dump Creek delta to restore flow and 2) a local northern pikeminnow bounty program to encourage harvest of northern pikeminnow in Deadwater Slough. 

<!--
Is there anything in the literature that discusses habitat preferences for pike minnow? If we speed up velocities and add some cover potentially pike minnow predation success will be lowered. Will these fish just move elsewhere? 
-->

## Conclusions

*	We have also presented a novel modeling framework for estimating predation on native, critically endangered anadromous species which can be applied to other areas of interest. John day? Others?
*	The end. 


# Acknowledgements

<!-- Please feel free to add others that I missed or improve -->

The authors extent much appreciation to the many volunteers who assisted with field efforts including collaborators from Bureau of Reclamation, Idaho Department of Fish and Game, and Lemhi Regional Land Trust, among others. This manuscript benefited from reviews and contributions from colleagues at the Idaho Governor's Office of Species Conservation, Rio Applied Science and Engineering, and from Sean Gibbs and Ben Briscoe at Mount Hood Environmental. Funding for this study was provided by the Bureau of Reclamation, Pacific Northwest Regional Office (contract No. 140R1021F0018). Special thanks to Caitlin Alcott and Inter-Fluve for their administrative support and guidance.


\newpage

# Literature Cited 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

# Tables

<div id="tables"></div>

```{r abund-data-lp}
LP_mod %>%
  select(event_name, species, data) %>%
  distinct() %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  rename(`Sampling Event` = event_name,
         Species = species) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Data summary for single census estimators. M is the number of fish caught in the first sample, marked and returned to the population. n is the number of fish caught in the second sample, and m is the number of marked fish caught in the second sample.") %>%
  kable_styling()

```

\newpage

```{r abund-data-schn}
N_mods %>%
  select(event_name, species, data) %>%
  distinct() %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  rename(`Sampling Event` = event_name,
         Species = species,
         Date = date) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Data summary for multiple census estimators. n is number of fish caught, m is the number of marked fish caught, u is the number of unmarked fish caught, and R is the number of marked fish returned to the population.") %>%
  kable_styling()

```

\newpage

```{r abund-tab}
all_est %>%
  select(-c(species, range:prop_range)) %>%
  rename(`Sampling Event` = event_name,
         Estimator = model) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Temporary caption.") %>%
  kable_styling()

```

\newpage

# Figures

<div id="figures"></div>

```{r map, out.width = "85%", fig.cap = "Map of the Deadwater Slough study area. The high-resolution orthoimage portion directly surrounding the Deadwater Slough was generated from aerial images taken by a drone. The red polygon indicates the reach characterized by unnaturally slow water velocities and a deepened channel. The location of the Dump Creek delta is indicated."}
knitr::include_graphics("../figures/deadwater_map_low_res.png")

```

\newpage

```{r abund-fig, fig.cap = "Estimates of abundance of northern pikeminnow using different estimators."}
all_est %>%
  mutate(across(c(N, Lci, Uci),
                 ~ . / 1000)) %>%
  ggplot(aes(x = model,
             y = N,
             color = model)) +
  geom_errorbar(aes(ymin = Lci,
                    ymax = Uci),
                width = 0.1) +
  geom_point(size = 4) +
  facet_wrap(~ event_name) +
  scale_color_brewer(palette = "Set1") +
  coord_cartesian(ylim = c(0, 100)) +
  labs(x = "Estimator",
       y = "Pikeminnow Abundance (x 1,000)") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1))

```

\newpage

```{r cpue-fig, fig.cap = "Total catch per unit effort across entire sampling event."}
cpue_df %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  group_by(species, event_name) %>%
  summarise(across(c(total_effort, n_fish),
                   sum),
            .groups = "drop") %>%
  mutate(across(total_effort,
                ~ . / 60)) %>%
  mutate(cpue = n_fish / total_effort) %>%
  ggplot(aes(x = event_name,
             y = cpue,
             fill = event_name)) +
  geom_col() +
  scale_fill_brewer(palette = "Set1",
                    name = "Event") +
  labs(x = "Event",
       y = "CPUE (Pikeminnow caught per hour)") +
  theme(legend.position = "none")

```

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

\newpage

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
