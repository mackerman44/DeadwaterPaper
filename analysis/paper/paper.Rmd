---
title: "Northern Pikeminnow Predation on Juvenile Chinook Salmon in Deadwater Slough, Salmon River, Idaho and Potential Impacts to Local Populations"
author:
  - Michael W. Ackerman:
      email: mike.ackerman@mthoodenvironmental.com
      institute: [mhe_mccall, biomark]
      correspondence: true
  - Nicholas J. Porter:
      email: Nicholas.Porter@merck.com
      institute: [biomark]
      correspondence: false
  - Kevin E. See:
      email: Kevin.See@dfw.wa.gov
      institute: [biomark, wdfw]
      correspondence: false
  - Michael S. Hall:
      email: Mike.Hall1@merck.com
      institute: [biomark]
      correspondence: false
  - Tara E. Blackman:
      email: tara.blackman@mthoodenvironmental.com
      institute: [mhe_sandy]
      correspondence: false
  - Richard A. Carmichael:
      email: Richard.Carmichael@merck.com
      institute: [biomark]
      correspondence: false
institute:
  - mhe_mccall: Mount Hood Environmental, PO Box 4282, McCall, Idaho, 83638, USA
  - biomark: Biomark, Inc., 705 South 8th Street, Boise, Idaho, 83702, USA
  - wdfw: Washington Department of Fish and Wildife, Fish Program, Science Division, 1111 Washington Street NE, Olympia, Washington, 98501, USA
  - mhe_sandy: Mount Hood Environmental, 39085 Pioneer Boulevard \#100 Mezzanine, Sandy, Oregon, 97055, USA 
date: "`r format(Sys.time(), '%d %B, %Y')`"
always_allow_html: true
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      number_sections: FALSE
      toc: no
      always_allow_html: true
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
    bookdown::html_document2:
      fig_caption: yes
      number_sections: FALSE
      toc: no
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua      
fontsize: 12pt
mainfont: Times New Roman
bibliography: 
- references.bib      # Kevin's library
- AckermanLibrary.bib # Mike's library
csl: "../templates/american-fisheries-society.csl" # Insert path for the bib-style
abstract: |
keywords: |
  Northern Pikeminnow; Chinook Salmon; predation; mark-recapture; bioenergetics
highlights: |
  These are the highlights. 
---

Keywords: `r rmarkdown::metadata$keywords`

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)

```

```{r load-libraries}
library(tidyverse)
library(magrittr)
library(janitor)
library(here)
library(lubridate)
library(FSA)
library(english)
library(lubridate)
library(tidytable)
library(kableExtra)
library(lemon)
library(gridExtra)

# format NA values in tables
options(knitr.kable.NA = '-')

# set default theme for figures
#theme_set(theme_bw())
theme_set(theme_classic())

# when knitting to Word, use this
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')

if(doc.type == 'docx') {
  options(knitr.table.format = "pandoc")
}

```

\newpage

## Abstract

Predation of emigrating juvenile salmonids by piscivorous fishes is perhaps an under-appreciated source of mortality hindering population recovery in the Columbia River basin. Reservoirs and tailraces associated with dams on the Snake and Columbia rivers have created favorable conditions for fishes known to consume juvenile salmonids, including the Northern Pikeminnow *Ptychocheilus oregonsis*. Indeed, Northern Pikeminnow have been estimated to consume 8% of the approximately 200 million juvenile salmonids emigration through those rivers, annually. Less is known about the interaction between upstream, river-dwelling Northern Pikeminnow and their impacts on salmonid recovery above these reservoir systems. In this study, we examine predation by Northern Pikeminnow on juvenile salmonids, focusing on Chinook Salmon *Oncorhynchus tshawytscha*, in a slow-water reach of the Salmon River, Idaho known as Deadwater Slough. The reach contains historically important overwinter rearing and spring emigration habitat for Chinook Salmon and other ESA-listed species, and was formed by the failure of a small mining dam in a reservoir in the late 19th century. We estimate the abundance of Northern Pikeminnow in Deadwater Slough during peak emigrations of Chinook salmon, and further, use a bioenergetics approach to estimate the consumption potential of the Northern Pikeminnow population to assess potential impacts to Chinook Salmon emigrants. Finally, we evaulate potential impacts to adult returns of local populations. ***We found that... (insert concluding findings here.*** It is likely that predation of juvenile Chinook Salmon in Deadwater Slough has a consequential impact on ESA-listed Chinook Salmon populations in the Upper Salmon River MPG hindering local recovery efforts.

\newpage

# Introduction

The Snake and Columbia rivers drain a network of inland tributaries that provide essential spawning and rearing habitat for anadromous Pacific salmon *Oncorhynchus* spp. and steelhead *O. mykiss*. These fishes were historically abundant throughout the basin and consequently have tremendous ecological, cultural, and economic value. Over the last century, salmonid stocks throughout the Snake and Columbia rivers have undergone significant declines related to habitat modification in the freshwater environment (e.g., removal of beavers, river channel simplification, water withdrawals, hydrosystem development) and poor marine conditions, both affecting their survival and recruitment at multiple life stages. Consequently, action agencies have made considerable investments in the rehabilitation of tributary ecosystems and evaulation of factors attributed to the species decline [@Roni2018].

One potentially important, but perhaps under-appreciated source of salmonid mortality is predation on emigrating juveniles by piscivorous fishes. In the lower mainstem Snake and Columbia rivers it is estimated that predation on out-migrating salmonids during peak emigration has a significant negative impact on the overall population and success of population recovery [@Fresh2003; @Winther2020]. Dams and reservoirs in the Columbia River are the primary locations associated with high rates of piscine predation on salmonids [@Petersen1994; @Ward1995]. There are generally two mechanisms that explain these high predation zones. First, migration (movement) rates of juvenile salmon are reduced during reservoir passage [@Venditti2000], thereby increasing the time migrating smolts are vulnerable to predation. Second, reservoirs and downstream tailraces associated with dams on the Snake and Columbia rivers create favorable slow-water habitat for predatory fishes known to consume juvenile salmonids, such as the Northern Pikeminnow *Ptychocheilus oregonsis*. Northern Pikeminnow tolerate and thrive in relatively warm, slow water habitats [@Wydoski2003] and consequently have benefited from dams on the Columbia River, becoming abundant predators of salmonid outmigrants [@Knutsen1999]. Indeed, Northern Pikeminnow are estimated to consume 8% (16.4 million) of the approximately 200 million juvenile salmonids emigrating through the lower Snake and Columbia Rivers, annually [@Beamesderfer1996].

```{r deadwater-attr}
# set some deadwater attributes
ddw_rkms = 1.871
ddw_m2 = 119431
ddw_avg_width_m = 68
ddw_acres = ddw_m2 / 4047
ddw_hectares = ddw_m2 / 10000

```

Most predation studies have focused on reservoirs [@Murphy2021] and mainstem reaches [@Zimmerman1999; @Tabor1993; @Ward1995; @Shively1996] of the Columbia River basin whereas considerably less is known about the interaction between upstream, river-dwelling piscivorous fishes and their impacts on salmonid recovery above the reservoir systems [@Rubenson2020]. Upstream habitats containing slower water velocities and other attributes that support piscivorous predators may overlap with essential habitat for some salmonid species and life stages. One such example is Deadwater Slough, an approximately `r round(ddw_rkms, 1)` km long reach of unnaturally slow and deep water in the Salmon River, Idaho. The Deadwater Slough is located in a river reach containing historically important overwinter rearing and spring emigration habitat for juvenile Chinook Salmon *O. tshawytscha* and is inhabited by piscivorous predators, including Northern Pikeminnow and Smallmouth Bass *Micropterus dolomieu*. Further, the slough is part of the migratory pathway of the endangered Snake River Sockeye Salmon *O. nerka* population [@Axel2015] and several populations of threatened Snake River steelhead.

Quantifying mortality associated with piscine predation in upstream habitats of the Salmon River is of particular interest for spring/summer-run Chinook Salmon (hereafter Chinook Salmon) in the Upper Salmon major population group (MPG). The Salmon River was historically the most productive tributary for Chinook Salmon in the Columbia River basin [@Nemeth1999], but those populations have become depleted in recent decades. Currently, the Upper Salmon MPG supports eight independent, extant populations, including Salmon River (above Redfish Lake Creek), Valley Creek, Yankee Fork Salmon River, East Fork Salmon River, Salmon River (mainstem below Redfish Lake Creek), Pahsimeroi River, Lemhi River, and North Fork Salmon River [@NOAA2017]. The Upper Salmon MPG are stream-type Chinook Salmon and exhibit two distinct migration tactics; downstream rearing (DSR) and natal reach rearing (NRR) [@Copeland2014a]. The DSR migrants leave their natal area as subyearlings between June and November and typically overwinter in downstream, mainstem habitats until the following spring when they emigrate to the ocean as smolts. Alternatively, NRR migrants remain in their natal areas for approximately one year after emergence until emigration to the ocean as smolts. Diversity of migration tactics provides a mechanism for coping with adverse conditions in freshwater rearing and migration environments and buffers against catastrophic events, thereby increasing population resiliency. Because the Deadwater Slough supports rearing for DSR migrants and is part of the migration corridor for NRR migrants, and juveniles from all Upper Salmon populations must rear in or migrate through it, it represents a significant habitat for the Upper Salmon MPG.

Recent studies have examined the downstream movement, distribution, and (apparent) survival of juvenile salmonid emigrants through the Salmon River, including the Deadwater Slough reach. Sockeye Salmon migrating through the mainstem Salmon River during spring were estimated to have substantially reduced survival in the Deadwater Slough reach compared to adjacent reaches [@Axel2015]. Similarly, emigrating DSR Chinook Salmon had a 10% reduction in transition probability through the Deadwater Slough compared to surrounding reaches during the fall and early winter months [@Ackerman2018; @Porter2019]. Low survival in these cases was attributed to low-velocity water delaying movement rates, thereby increasing predation risk.

In this study, we estimated the abundance of Northern Pikeminnow in the Deadwater Slough and evaluated potential impacts to juvenile salmon emigrants, focusing on DSR and NRR Chinook Salmon. We hypothesize that high densities of piscivorous predators in the Deadwater Slough may explain the reduced survival (or apparent survival) observed for juvenile Chinook Salmon and Sockeye Salmon. To test this, our objectives were three-fold:

1. Estimate the abundance (or relative abundance) of potential predators in the Deadwater Slough during the peaks of fall (DSR) and spring (NRR) juvenile emigrations.
2. Document predation on juvenile Chinook Salmon during the DSR and NRR emigration periods using gastric lavage.
3. Use a bioenergetics approach to estimate consumption potential (grams) of the Northern Pikeminnow population at Deadwater Slough to assess their potential impacts to DSR and NRR Chinook Salmon emigrants.

We also consider how consumption of juvenile Chinook Salmon emigrants at Deadwater Slough by Northern Pikeminnow may impact adult returns to the Upper Salmon MPG.


# Methods

## Study Site

The Deadwater Slough is an approximately `r round(ddw_rkms, 1)` km section of the mainstem Salmon River located approximately 6 river km downstream from the town of North Fork, Idaho (Figure \@ref(fig:map)). The downstream end of the slough is located at the confluence of Dump Creek and the Salmon River. Around 1897, the failure of a small mining diversion reservoir in the Dump Creek drainage resulted in an erosion event that deposited substantial amounts of sediment at the confluence of the Salmon River [@Emerson1973] forming an alluvial fan. The fan created a slow, deep section in the river, spanning approximately `r round(ddw_acres)` acres (`r round(ddw_hectares)` hectares), averaging `r round(ddw_avg_width_m)` m width, and resembling a small, narrow pond or reservoir.


## Northern Pikeminnow Population Size

We estimated the population size of piscine predators in the Deadwater Slough using a mark-recapture survey and a catch per unit effort (CPUE) approach. Predators were sampled near the peaks of the juvenile DSR and NRR emigrations. Our initial intent was to sample during the emigration of the 2018 brood year (fall 2019 and spring 2020). However, due to logistical concerns during the onset of the Covid-19 pandemic, the spring 2020 effort was delayed until fall 2020. Although this provided the benefit of an additional abundance estimate during the DSR emigration, estimates during the NRR emigration were still lacking, and so an additional effort was added in spring 2021. Fall efforts included sampling across a two-week span, but due to budget constraints the spring 2021 effort was limited to a single week. Fall efforts were constrained within a two-week window to minimize predator emigration/immigration and to constrain the population to meet assumptions of the mark-recapture models.

Multiple capture methods were employed during the initial fall 2019 effort to reduce selectivity and bias for species and size classes. Methods included raft electrofishing, fyke netting, snorkeling, and angling. Ineffective methods were then abandoned in subsequent years. <!-- For example, fish were able to elude the electrical field of the raft electrofisher due to 1) the lack of flow in Deadwater Slough and 2) our inability to "chase" fish downstream as they evaded the electricity. Snorkeling was ineffective due to the high turbidity of the mainstem Salmon River and Deadwater Slough area. Significant amounts of debris in the water column also created concerns that fyke nets could become entangled. Additionally, there were concerns that raft electrofishers and fyke nets could incidentally capture ESA-listed adult steelhead that are present in the mainstem Salmon River during fall and spring. -->After evaluating all methods, angling proved to be the most effective method for capturing piscine predators while also minimizing potential impacts to ESA-listed adult steelhead present in the Salmon River during our sampling efforts.<!--, but recognizing that angling can have both species and size selectivity (bias).--> Therefore, the following analyses will focus on fish captured by angling, unless otherwise noted. During the fall 2019 effort it additionally became clear that Northern Pikeminnow were by far the most prevalent piscine predator in Deadwater Slough and so is our focus.

Our study relied heavily on volunteer anglers who were permitted to fish anywhere within Deadwater Slough. During a sampling occassion (day), anglers would boat or hike their catch (periodically or upon filling a livewell) to a processing station at the boat ramp approximately 500 m downstream from the top of the slough. For each fish, we recorded the date of capture, species, total length (TL; mm), and whether the fish was previously marked. Unmarked fish were given a physical mark (e.g., hole punch of lower caudal, upper caudal, left pelvic, right pelvic) unique to each day and released. Fish that died prior to release were still counted as captured (or recaptured), but not included in the number of marked fish available for recapture after that date. Released individuals were distributed throughout Deadwater Slough to facilitate mixing back into the population. Finally, we recorded the angling start and end time for each crew (person or combinations of persons) to facilitate calculations of CPUE.


```{r capture-data, eval = T}
raw_df = readxl::read_excel(here("analysis/data/raw_data/Deadwater_predation_mark_recapture_11.09.21.xlsx")) %>%
  clean_names() %>%
  mutate(across(date,
                ymd)) %>%
  mutate(across(c(start_time, end_time),
                ~ ymd_hms(paste(year(date), month(date), day(date), hour(.), minute(.), second(.))))) %>%
  # break days into "sampling events"
  mutate(event_name = if_else(month(date) > 8,
                              paste("Fall", year(date), sep = "_"),
                              paste("Spring", year(date), sep = "_")))

# capture/mark/recpature data frame; focus on pikeminnow, to be used for mark-recap models
cmr_df = raw_df %>%
  filter(count > 0) %>%                                     # filter out effort-only records
  filter(species == "Northern Pikeminnow") %>%              # focus on NPM
  filter(method == "Angling") %>%
  select(event_name, 
         date,
         method, 
         species, 
         count, 
         length, 
         fish_status, 
         capture_type) %>%
  # if fish_status = Live & capture_type = Mark, set as mark_release as TRUE
  # if capture_type = Recapture, set recap to TRUE
  mutate(mark_release = if_else(fish_status == "Live" &     
                                capture_type == "Mark",
                                T, F),
         recap = if_else(capture_type == "Recapture",
                         T, F))

```

```{r effort, eval = T}
# What size (mm) is considered a large pikeminnow?
large_size = 380

# catch per unit effort
cpue_df = raw_df %>%
  select(event_name,
         site,
         date,
         crew,
         crew_count,
         method,
         equipment,
         start_time:total_effort,
         total_day_effort) %>%
  distinct() %>%
  filter(method == "Angling") %>%
  mutate(across(total_effort,
                ~ . * crew_count)) %>%
  rename(total_effort_min = total_effort) %>%
  group_by(event_name,
           date) %>%
  summarise(across(c(total_effort_min,
                     crew_count),
                   sum),
            .groups = "drop") %>%
    left_join(cmr_df %>%
              group_by(event_name, species, date) %>%
              summarise(n_fish = n(),
                        n_large_fish = sum(length >= large_size,
                                           na.rm = T),
                        .groups = "drop")) %>%
  mutate(catch_per_hr = n_fish / (total_effort_min / 60),
         catch_per_angler_day = n_fish / crew_count,
         catch_lg_per_angler_day = n_large_fish / crew_count)

```

```{r lincoln-petersen-estimator, eval = T}
# using Lincoln-Petersen model, combining first 4 and last four days
# define mark and recapture periods
cap_periods = tibble(event_name = "Fall_2019",
                     cap_period = "Mark",
                     int = interval(start = ymd('20191112'),
                                    end = ymd('20191114'))) %>%
  bind_rows(tibble(event_name = "Fall_2019",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20191119'),
                                  end = ymd('20191121')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Mark",
                   int = interval(start = ymd('20201020'),
                                  end = ymd('20201023')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20201027'),
                                  end = ymd('20201030'))))

# add cap_period column, fill w/ NA
cmr_df$cap_period = NA_character_
# fill cap_period w/ Mark or Recapture
for(i in 1:nrow(cap_periods)) {
  my_int = cap_periods$int[i]
  index = which(cmr_df$date %within% my_int)
  cmr_df$cap_period[index] = cap_periods$cap_period[i]
}

# Lincoln-Peterson Model
LP_mod = cmr_df %>%
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species) %>%
  summarise(M = sum(cap_period == "Mark" & fish_status == "Live", na.rm = T),
            n = sum(cap_period == "Recapture"),
            m = sum(cap_period == "Recapture" & capture_type == "Recapture", na.rm = T),
            .groups = "drop") %>%
  nest(data = -c(event_name, species)) %>%
  crossing(model = c("Petersen",
                     "Chapman")) %>%
    mutate(mr_model = map2(data,
                       model,
                      .f = function(x, y) {
                        with(x,
                             FSA::mrClosed(M = M,
                                          n = n,
                                          m = m,
                                          method = y))
                        }),
         N_summ = map(mr_model,
                      .f = summary,
                      incl.SE = T),
         CI = map(mr_model,
                  .f = confint)) %>%
    mutate(N = map_dbl(N_summ,
                     .f = function(x) x[1]),
         SE = map_dbl(N_summ,
                      .f = function(x) x[2]),
         Lci = map_dbl(CI,
                         .f = function(x) x[1]),
         Uci = map_dbl(CI,
                         .f = function(x) x[2])) %>%
    select(-N_summ, -CI)

```

```{r schnabel-estimator, eval = T}
# using Schnabel and Schumacher-Eschmeyer estimators
N_mods = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species, date) %>%
  summarise(n = n(),
            m = sum(capture_type == "Recapture", na.rm = T),
            u = sum(capture_type == "Mark" | is.na(capture_type)),
            R = sum(fish_status == "Live", na.rm = T),
            .groups = "drop") %>%
  group_by(event_name, species) %>%
  mutate(M = lag(R - m),
         M = replace_na(M, 0),
         M = cumsum(M)) %>%
  nest() %>%
  crossing(model = c("Schnabel",
                     "SchumacherEschmeyer")) %>%
  mutate(mr_model = map2(data,
                         model,
                         .f = function(x, y) {
                           with(x,
                                mrClosed(n = n,
                                         m = m,
                                         R = R,
                                         method = y,
                                         chapman.mod = TRUE))
                         }),
         N = map_dbl(mr_model,
                     .f = summary),
         CI = map(mr_model,
                  .f = confint,
                  conf.level = 0.95),
         Lci = map_dbl(CI,
                       .f = function(x) x[1]), 
         Uci = map_dbl(CI,
                       .f = function(x) x[2])) %>%
  ungroup() %>%
  select(-CI)

```

```{r assump-violation}
# assume that marked fish aren't available for recapture until 2 days after capture
# using Schnabel estimator
N_mods_viol = N_mods %>%
  filter(model == "Schnabel") %>%
  select(event_name:model) %>%
  mutate(data = map(data,
                    .f = function(x) {
                      x %>%
                        mutate(R_lag = lag(R),
                               R_lag = replace_na(R_lag,
                                                  0))
                    })) %>%
  mutate(mr_model = map2(data,
                         model,
                         .f = function(x, y) {
                           with(x,
                                mrClosed(n = n,
                                         m = m,
                                         R = R_lag,
                                         method = y,
                                         chapman.mod = TRUE))
                         }),
         N = map_dbl(mr_model,
                     .f = summary),
         CI = map(mr_model,
                  .f = confint),
         Lci = map_dbl(CI,
                       .f = function(x) x[1]),
         Uci = map_dbl(CI,
                       .f = function(x) x[2])) %>%
  ungroup() %>%
  select(-CI) %>%
  mutate(model = "Schnabel - Delayed Mixing")
```


```{r abund-est}
all_est = LP_mod %>%
  select(event_name, species, model, N:Uci) %>%
  bind_rows(N_mods %>%
             select(event_name, species, model, N:Uci)) %>%
  bind_rows(N_mods_viol %>%
             select(event_name, species, model, N:Uci)) %>%
  mutate(range = Uci - Lci,
         prop_range = range / N) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  mutate(model = fct_recode(model,
                            "Schumacher-Eschmeyer" = "SchumacherEschmeyer"),
         model = fct_relevel(model,
                             "Petersen",
                             after = 0)) %>%
  arrange(event_name, model) %>%
  filter(! model %in% c("Petersen",
                        "Schumacher-Eschmeyer"))

```

```{r spring-abund}
total_cpue = cpue_df %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  group_by(species,
           event_name) %>%
  summarise(across(c(total_effort_min,
                     n_fish,
                     n_large_fish,
                     angler_days = crew_count),
                   sum),
            .groups = "drop") %>%
  mutate(catch_per_hr = n_fish / (total_effort_min / 60),
         catch_per_angler_day = n_fish / angler_days,
         catch_lg_per_angler_day = n_large_fish / angler_days)
  
spring_abund = all_est %>%
  filter(model == "Schnabel") %>%
  # filter(model == "Chapman") %>%
  select(-range, -prop_range) %>%
  inner_join(total_cpue,
             by = c("event_name", "species")) %>%
  select(species,
         model,
         model_event = event_name,
         N_F = N,
         Lci_F = Lci,
         Uci_F = Uci,
         cpue_F = catch_per_hr) %>%
  group_by(species, model) %>%
  summarise(across(c(N_F:cpue_F),
                   mean),
            .groups = "drop") %>%
    full_join(total_cpue %>%
              filter(str_detect(event_name, "Spring")) %>%
              select(species,
                     cpue_S = catch_per_hr),
            by = "species") %>%
  # calculate spring abundance estimate
  mutate(N_S = N_F * (cpue_S / cpue_F),
         Lci_S = Lci_F * (cpue_S / cpue_F),
         Uci_S = Uci_F * (cpue_S / cpue_F))

```

Four different mark-recapture estimators were employed to explore variation in abundance estimates among them. Estimators fell into two broad categories: single census and multiple census. For the single census estimators, we treated the first week as the first (mark) sample, and the following (second) week as the second (recapture) sample, pooling data within each of those weeks. Alternatively, the multiple census estimators treat each day as a sample and use information about the total marked fish from all previous samples to infer the total abundance. 

For the single census estimators, we first used the Lincoln-Peterson estimator:

$$
\hat{N} = \frac{(M)(n)}{(m)}
$$
where $M$ is the total number of fish marked and returned to the population during the first sample (week), $n$ is the total number of fish caught in the second sample (week), and $m$ is the number of marked fish caught during the second week. Because the Lincoln-Peterson estimator can be biased with small samples, we also employed the Chapman-modified Lincoln-Peterson estimator:

$$
\hat{N} = \frac{(M + 1)(n + 1)}{(m + 1)} - 1
$$
For a multiple census estimator, we first utilized the Schnabel method:

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M_i}{\left(\sum\limits_{i = 1}^k m_i \right) + 1}
$$

where $M$, $n$, and $m$ are indexed by each sample (day), $i$. With small numbers of recaptures, it may not be appropriate to calculate the standard error of the Schnabel estimator but the 95% confidence intervals can be calculated using a Poisson approximation [@Krebs1999]. The Schnabel estimator is essentially a weighted average of a series of Lincoln-Peterson estimators (with a Champman modification). Lastly, we explored one additional multiple-census estimator, the Schumacher-Eschmeyer, which is based on minimizing the weighted sum of squares between the proportion of marked individuals in the sample and the unknown proportion of marked individuals in the population. The Schumacher-Eschmeyer estimator is as follows:

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M^2_i}{\sum\limits_{i = 1}^k m_i M_i}
$$

The mark-recapture estimators allowed us to estimate the abundance of Northern Pikeminnow during the fall 2019 and 2020 sample efforts (the estimate is of the initial population size). However, to estimate the abundance of Northern Pikeminnow during spring 2021, which was not a mark-recapture design, we used the ratio of total CPUE in the fall efforts to the total CPUE in the spring efforts, then multiplied that ratio by the average abundance from the fall efforts. This approach assumes equal capture probabilities between fall and spring efforts.

All mark-recapture abundance estimators assumed: (1) the population is closed (no immigration, emigration, births or deaths during the sampling period), (2) all fish have equal chance of being caught in the second (and subsequent) sample(s), (3) marking a fish does not affect its chances of recapture, (4) no loss of marks, and (5) marks are not missed or mistaken.

```{r psd}
s_size = 250        # stock size
q_size = large_size # quality size

psd_df = cmr_df %>%
  select(event_name,
         species,
         count,
         length,
         recap) %>%
  filter(recap != T)

fq = psd_df %>%
  filter(length >= q_size) %>%
  nrow()

fs = psd_df %>%
  filter(length >= s_size) %>%
  nrow()

psd = 100 * (fq/fs)

```

Northern Pikeminnow in Deadwater Slough were not only abundant, but anglers reported that many were large-bodied. For that reason, we calculated the proportional stock density (PSD) for Northern Pikeminnow in Deadwater Slough, which is a measure of species size structure. PSD is a ratio, typically expressed as a percentage, between the number of "quality-sized" (larger) individuals and "stock-sized" individuals: 

$$
PSD_{i} = 100 * \frac{FQ_{i}}{FS_{i}}
$$

where $FQ_{i}$ is the number of fish $\ge$ quality-length for species $i$, and $FS_{i}$ is the number of fish $\ge$ stock-length for species $i$. Quality and stock size definitions vary by species. We calculated the PSD for Northern Pikeminnow in Deadwater Slough using `r prettyNum(q_size, digits = 0)` mm TL for quality-size and `r prettyNum(s_size, digits = 0)` mm TL for stock-size [@Winther2020].


## Stomach Contents

Gastric lavage [@Foster1977] was used to examine the stomach contents of Northern Pikeminnow for the presence of juvenile Chinook Salmon and other fishes (e.g., juvenile steelhead, juvenile Sockeye Salmon, Redside Shiner *Richardsonius balteatus*, etc.). Immediately following lavage, stomach contents of individuals were preserved with 99% isopropyl alcohol in whirl-paks for later analysis in a controlled environment. For each sample, wet weight (grams) was recorded for the total combined stomach content, including all non-fish items (e.g., macroinvertebrates, organic matter), as well as that portion consisting of fish parts or matter. Fish and fish remnants were identified to the lowest taxonomic unit using diagnostic bones, or were categorized as unknown [@Hansel1988; @Frost2000]. A subset of Northern Pikeminnow captures (~ 5%) were euthanized for dissection after gastric lavage to validate the efficacy of the methodology.


```{r gastric-data}
gastric_df = raw_df %>%
  select(event_name, 
         date, 
         species,
         method,
         length,
         lavage_id,
         stomach_contents,
         stomach_contents_weight,
         fish_content_weight,
         comments) %>%
  #mutate(bin_50 = lencat(length, w = 50)) %>%
  filter(species == "Northern Pikeminnow",
         method == "Angling") %>%
  mutate(non_fish_wt = stomach_contents_weight - fish_content_weight) %>%
  mutate(lavaged = case_when(
    is.na(lavage_id) & is.na(stomach_contents) ~ FALSE,
    stomach_contents == "Did Not Lavage" ~ FALSE,
    stomach_contents == "Lost sample CG27-001" ~ FALSE,
    TRUE ~ TRUE
  )) %>%
  mutate(had_contents = case_when(
    lavaged == FALSE ~ FALSE,
    is.na(stomach_contents) ~ FALSE,
    stomach_contents == "Empty" ~ FALSE,
    TRUE ~ TRUE
  )) %>%
  mutate(had_fish_contents = case_when(
    fish_content_weight > 0 ~ TRUE,
    stomach_contents == "MacroInvert-other/Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish-Unk (fish bone/cartilage)" ~ TRUE,
    stomach_contents == "MacroInvert-other/Mountain Whitefish" ~ TRUE,
    stomach_contents == "MacroInvert-other/Algae/Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish -Shiner" ~ TRUE,
    stomach_contents == "Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish Unk" ~ TRUE,
    stomach_contents == "Detritus/Fish -Shiner" ~ TRUE,
    stomach_contents == "MacroInvert-other/Fish-Unk" ~ TRUE,
    stomach_contents == "MacroInvert-other/Detritus/Fish -Shiner" ~ TRUE,
    stomach_contents == "Fish-Unk" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Detritus/Fish-Unk/Other"  ~ TRUE,
    stomach_contents == "Aquatic Veg/Fish-Sucker"  ~ TRUE,
    stomach_contents == "MacroInvert-Worm/Fish-RedsideShiner"  ~ TRUE,
    stomach_contents == "Aquatic Veg/Detritus/Fish-RedsideShiner"  ~ TRUE,
    stomach_contents == "MacroInvert-Other/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish-Sucker/Other" ~ TRUE,
    stomach_contents == "Fish-Unk/Other" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Aquatic Veg/Detritus/Fish-Sucker" ~ TRUE,
    stomach_contents == "Fish-RedsideShiner" ~ TRUE,
    stomach_contents == "Fish-Chinook/Other" ~ TRUE,
    stomach_contents == "Detritus/Fish-RedsideShiner/Other" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Aquatic Veg/Detritus/Fish-RedsideShiner" ~ TRUE,
    stomach_contents == "Detritus/Fish-Sucker/Other" ~ TRUE,
    stomach_contents == "Invertebrates;FishParts"  ~ TRUE,
    stomach_contents == "Invertebrates;Detritus;FishParts;IntestinalWorms"  ~ TRUE,
    stomach_contents == "FishParts"  ~ TRUE,
    stomach_contents == "FishParts;IntestinalWorms"  ~ TRUE,
    TRUE ~ FALSE
  )) %>%
  mutate(had_chinook = case_when(
    stomach_contents == "Fish-Chinook/Other" ~ TRUE,
    TRUE ~ FALSE
  )) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " ")))

gastric_tbl = gastric_df %>%
  group_by(event_name) %>%
  summarise(captured = n(),
            lavaged = sum(lavaged),
            stmch_contents = sum(had_contents),
            fish_contents = sum(had_fish_contents)) %>%
  adorn_totals("row")

stmch_df = gastric_df %>%
  select(event_name,
         species,
         date,
         length,
         stomach_contents_weight,
         fish_content_weight,
         non_fish_wt) %>%
  filter(stomach_contents_weight > 0) %>%
  mutate(p_fish = fish_content_weight / stomach_contents_weight)

```


## Fish Consumption Potential

```{r shoup-temp-data, eval = F}
shoup_temp_df = read_tsv(here("analysis/data/raw_data/USGS_13307000_Salmon_River_Nr_Shoup.txt"),
                   comment = "#") %>%
  rename(discharge_cfs = `47768_00060`,
         discharge_cfs_cd = `47768_00060_cd`,
         gage_ht_ft = `47769_00065`,
         gage_ht_ft_cd = `47769_00065_cd`,
         water_temp_c = `47773_00010`,
         water_temp_c_cd = `47773_00010_cd`) %>%
  select(datetime, water_temp_c) %>%
  mutate(month = month(datetime),
         day = day(datetime)) %>%
  group_by(month, 
           day) %>%
  summarize(mean_water_temp = mean(water_temp_c, na.rm = T))

```

```{r read-bio-outputs, message=FALSE, warning=FALSE, include=FALSE}
fmt_bio_out = function(x) {
  x = x %>%
    clean_names() %>%
    mutate(date = as.Date(date, "%m/%d")) %>%
    mutate(cum_cons_fish_g = cumsum(cons_fish_g)) %>% 
    mutate(month = month(date))
  return(x)
  
}

# fall, fish 10% - 90%
fall_f10 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I90_F10.csv")) %>% fmt_bio_out()
fall_f20 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I80_F20.csv")) %>% fmt_bio_out()
fall_f30 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I70_F30.csv")) %>% fmt_bio_out()
fall_f40 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I60_F40.csv")) %>% fmt_bio_out()
fall_f50 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I50_F50.csv")) %>% fmt_bio_out()
fall_f60 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I40_F60.csv")) %>% fmt_bio_out()
fall_f70 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I30_F70.csv")) %>% fmt_bio_out()
fall_f80 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I20_F80.csv")) %>% fmt_bio_out()
fall_f90 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I10_F90.csv")) %>% fmt_bio_out()

# spring, fish 10% - 90%
spring_f10 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I90_F10.csv")) %>% fmt_bio_out()
spring_f20 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I80_F20.csv")) %>% fmt_bio_out()
spring_f30 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I70_F30.csv")) %>% fmt_bio_out()
spring_f40 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I60_F40.csv")) %>% fmt_bio_out()
spring_f50 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I50_F50.csv")) %>% fmt_bio_out()
spring_f60 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I40_F60.csv")) %>% fmt_bio_out()
spring_f70 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I30_F70.csv")) %>% fmt_bio_out()
spring_f80 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I20_F80.csv")) %>% fmt_bio_out()
spring_f90 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I10_F90.csv")) %>% fmt_bio_out()

# average size of fall and spring pikeminnow
avg_fall_NPM   = 352.9
avg_spring_NPM = 393.7

# average size of DSR and NRR juveniles
avg_DSR_g = 10.3
avg_NRR_g = 10.9

# compile fall results
fall_results = fall_f10 %>%
  select(date, temperature_c, cum_cons_fish_g) %>%
  rename(f10_g = cum_cons_fish_g) %>%
  mutate(f20_g = fall_f20$cum_cons_fish_g,
         f30_g = fall_f30$cum_cons_fish_g,
         f40_g = fall_f40$cum_cons_fish_g,
         f50_g = fall_f50$cum_cons_fish_g,
         f60_g = fall_f60$cum_cons_fish_g,
         f70_g = fall_f70$cum_cons_fish_g,
         f80_g = fall_f80$cum_cons_fish_g,
         f90_g = fall_f90$cum_cons_fish_g) %>%
  mutate(season = "Fall") #%>%
  # mutate( across(contains('_g'),
  #                .fns = list(n = ~./avg_DSR_g),
  #                .names = "{col}_{fn}") )

# compile spring results
spring_results = spring_f10 %>%
  select(date, temperature_c, cum_cons_fish_g) %>%
  rename(f10_g = cum_cons_fish_g) %>%
  mutate(f20_g = spring_f20$cum_cons_fish_g,
         f30_g = spring_f30$cum_cons_fish_g,
         f40_g = spring_f40$cum_cons_fish_g,
         f50_g = spring_f50$cum_cons_fish_g,
         f60_g = spring_f60$cum_cons_fish_g,
         f70_g = spring_f70$cum_cons_fish_g,
         f80_g = spring_f80$cum_cons_fish_g,
         f90_g = spring_f90$cum_cons_fish_g) %>%
  mutate(season = "Spring") # %>%
  # mutate( across(contains('_g'),
  #                .fns = list(n = ~./avg_NRR_g),
  #                .names = "{col}_{fn}") )

bio_results = rbind(fall_results, spring_results)
bio_g_summ = bio_results %>%
  select(season, f10_g:f90_g) %>%
  pivot_longer(f10_g:f90_g) %>%
  group_by(season, name) %>%
  summarize(cumm_g = max(value))

rm(fall_results,
   fall_f10, 
   fall_f20, 
   fall_f30, 
   fall_f40, 
   fall_f50, 
   fall_f60, 
   fall_f70, 
   fall_f80, 
   fall_f90,
   spring_results,
   spring_f10, 
   spring_f20, 
   spring_f30, 
   spring_f40, 
   spring_f50, 
   spring_f60, 
   spring_f70, 
   spring_f80, 
   spring_f90)

```

To estimate the total consumption potential (i.e., the number or amount of juvenile Chinook Salmon consumed during the peaks of DSR [fall] and NRR [spring] emigrations) of Northern Pikeminnow in Deadwater Slough, we used the Fish Bioenergetics v4.0 application developed by @Deslauriers2017 and applied in the R statistical software [@RCoreTeam2021]. The daily rate of consumption in grams for an individual Northern Pikeminnow was estimated based on the following inputs: predator and prey energy densities, predator start and end weights, and water temperatures. Predator energy density for Northern Pikeminnow was fixed at 6,703 Joules(J)/g [@Deslauriers2017]. Prey energy densities were fixed at 21,500 J/g for juvenile Chinook Salmon [@Moss2016]. The predator start weight was calculated using a weight-length formula [@Parker1995] and the average length of Northern Pikeminnow caught in Deadwater Slough during our study. The average length of Northern Pikeminnow caught during the fall and spring efforts were `r avg_fall_NPM` and `r avg_spring_NPM` mm, respectively, which calculated to average starting weights of 504.4 and 670.5 g. We assumed no growth in individual Northern Pikeminnow, and so predator start and end weights are equal (i.e., we assumed the population biomass was stable). Mean daily water temperatures were summarized from 15-minute interval temperature readings available March 3, 2013 to June 14, 2021 from a gage station approximately 22 river kilometers downstream of Deadwater Slough near Shoup, Idaho [@USGS2016].

The largest uncertainty among model parameters was the proportion of the Northern Pikeminnow diet consisting of fish versus non-fish prey items (e.g., invertebrates). Therefore, we conducted nine model runs with varying proportions of fish in the diet ranging from 10-90%, in 10% increments. Energy densities for invertebrates was fixed at 3,000 J/g. Because we were unable to differentiate juvenile Chinook Salmon from other fish prey consumed during model runs, we assume all fish prey have the same energy densities as juvenile Chinook Salmon i.e., juvenile Chinook Salmon were used as surrogates for all fish prey items. Separate models were also run for a 77-day fall period from September 15 - November 30 and a 92-day period in the spring from March 1 - May 31 to coincide with peak emigrations of DSR and NRR juveniles from the Lemhi River, the largest Chinook Salmon population in the Upper Salmon MPG. This resulted in 18 separate model runs (9 diet scenarios and 2 seasons). Each model run provided an estimate of the total amount (grams) of fish consumed by an individual Northern Pikeminnow during the fall or spring time periods. To estimate the total biomass of fish potentially consumed by all Northern Pikeminnow in Deadwater Slough, we multiplied the grams of fish consumed by an individual Northern Pikeminnow by the estimated predator population size during each period (fall and spring).


## Potential Impacts to Chinook Salmon Populations

Multiplying the grams of fish consumed by an individual Northern Pikeminnow by the Northern Pikeminnow population size provides an estimate of total fish consumption potential for the population. However, the bioenergetics model runs do not differentiate juvenile Chinook Salmon from other fish prey items. Therefore, to understand potential impacts to local Chinook Salmon populations, we need to parse out the portion of total fish consumed that is juvenile Chinook Salmon. Unfortunately, estimates of the proportion of the Northern Pikeminnow fish prey that are juvenile Chinook Salmon are sparse, as well as information on the prevalence of juvenile Chinook Salmon relative to other fish prey items. Therefore, we instead consider hypothetical scenarios where Chinook Salmon are 1%, 10%, 30%, and 50% of fish prey consumed, by weight, which provide estimates of the total biomass (grams) of juvenile Chinook Salmon consumed by Northern Pikeminnow during the DSR and NRR emigration periods.      

The estimate of total juvenile Chinook Salmon biomass consumed was converted to the total number of fish consumed each period by dividing by the average weight of DSR (`r avg_DSR_g` g) and NRR (`r avg_NRR_g` g) emigrants in the Upper Salmon MPG. The average weights of DSR and NRR emigrants were taken from fish caught at seven rotary screw traps located throughout the Upper Salmon MPG upstream of Deadwater Slough during the fall and spring time periods.

<!-- Sawtooth Hatchery, East Fork Salmon, Pahsimeroi, Upper Lemhi, Hayden Creek, Lower Lemhi, North Fork Salmon -->

<!--
## Juvenile Chinook Salmon Abundance

Juvenile Chinook Salmon abundances were estimated at 5 rotary screw traps in the upper Salmon River basin: Sawtooth, Pahsimeroi, Hayden Creek, Upper Lemhi, and Lower Lemhi. Abundances were calculated by Idaho Department of Fish and Game at each trap which made up the production estimate for juvenile Chinook Salmon in the Upper Salmon Basin (Table X) (McClure et al. 2020).
-->

```{r adult-impacts}
# pull in SAR numbers
sar = read_csv(here("analysis/data/raw_data", 
                    "WSSCh_sar_4See.csv")) %>%
  summarise(across(c(medsar, sdsar),
                   median)) %>%
  summarise(across(c(medsar, sdsar),
               ~ . / 100))

# summarize potential Chinook eaten for each time period by one pikeminnow
impact_df = bio_results %>%
  group_by(season) %>%
  summarize(across(ends_with("_g"), max)) %>%
  pivot_longer(cols = ends_with("_g"),
               names_to = "perc_diet",
               values_to = "g_fish_cons") %>%
  mutate(across(perc_diet,
                str_extract,
                "[:digit:]+"),
         across(perc_diet,
                as.integer)) %>%
  crossing(p_chnk = c(.01, .10, .30, .50, .70, .90, 1)) %>%
  mutate(g_chnk = g_fish_cons * p_chnk) %>%
  mutate(n_chnk = ifelse(season == "Fall",
                         g_chnk / avg_DSR_g,
                         g_chnk / avg_NRR_g)) %>%
  left_join(spring_abund %>%
            select(N_F:Uci_F,
                   N_S:Uci_S) %>%
            pivot_longer(everything()) %>%
            mutate(season = if_else(str_detect(name, "_F$"),
                                    "Fall",
                                    "Spring")) %>%
            mutate(across(name,
                          str_remove,
                          "_F$"),
                    across(name,
                           str_remove,
                           "_S$")) %>%
            pivot_wider(names_from = name,
                        values_from = value)) %>%
  mutate(juv_N = N * n_chnk,
         juv_Lci = Lci * n_chnk,
         juv_Uci = Uci * n_chnk) %>%
  bind_cols(sar) %>%
  mutate(adult_N = juv_N * medsar,
         adult_Lci = juv_Lci * qnorm(0.025, medsar, sdsar),
         adult_Uci = juv_Uci * qnorm(0.975, medsar, sdsar))
 
# sum fall and spring impacts
total_impacts = impact_df %>%
  group_by(perc_diet, p_chnk) %>%
  summarise(across(c(ends_with("_N"),
                     ends_with("_Lci"),
                     ends_with("_Uci")),
                   sum),
            .groups = "drop")

```


# Results

## Northern Pikeminnow Population Size

Using hook-and-line angling, we caught `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2019", "n_fish"])`, `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2020", "n_fish"])`, and `r prettyNum(total_cpue[total_cpue$event_name == "Spring 2021", "n_fish"])` Northern Pikeminnow during the fall 2019, fall 2020, and spring 2021 efforts, respectively, for a total of `r prettyNum(sum(total_cpue$n_fish), big.mark = ",")` fish. The CPUE, measured as number of Northern Pikeminnow caught per angler hour, was `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2019", "catch_per_hr"], digits = 3)` for fall 2019, `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2020", "catch_per_hr"], digits = 3)` for fall 2020, and `r prettyNum(total_cpue[total_cpue$event_name == "Spring 2021", "catch_per_hr"], digits = 2)` for spring 2021 (Figure \@ref(fig:cpue-fig)). During the mark-recapture efforts, there were `r as.character(english(sum(N_mods[[3]][[1]]$m)))` recaptures in fall 2019 which included `r as.character(english(LP_mod[[3]][[1]]$m))` unique individuals. There were an additional `r as.character(english(sum(N_mods[[3]][[3]]$m)))` recaptures in fall 2020 consisting of `r as.character(english(LP_mod[[3]][[3]]$m))` unique individuals. Summaries of parameters for both the single census and multiple census mark-recapture estimators are provided in Table \@ref(tab:abund-data-lp) and Table \@ref(tab:abund-data-schn), respectively. 

Mark-recapture abundance estimates for Northern Pikeminnow in Deadwater Slough during fall 2019 ranged from `r prettyNum(min(all_est$N[all_est$event_name == "Fall 2019"]), big.mark = ",")` to `r prettyNum(max(all_est$N[all_est$event_name == "Fall 2019"]), big.mark = ",")` and for fall 2020 ranged from `r prettyNum(min(all_est$N[all_est$event_name == "Fall 2020"]), big.mark = ",")` to `r prettyNum(max(all_est$N[all_est$event_name == "Fall 2020"]), big.mark = ",")` (Table \@ref(tab:abund-tab)). In both cases, the multiple census estimators were larger than the single census estimators. Confidence intervals for the fall 2020 effort were more varied, likely due to fewer recaptures during that year. 

All mark-recapture estimators yielded estimates with overlapping confidence intervals. However, because our sampling design most closely matched a multiple census estimator (i.e., we released marked fish each day and recaptures from all previous days were recorded for each day) and required a small sample size modification, we used the Schnabel estimates of abundance for further analyses and results. Accordingly, the mean of Northern Pikeminnow abundance for the two fall sampling events was `r prettyNum(mean(all_est$N[all_est$model == "Schnabel"]), big.mark = ",")` (95% CI: `r paste(prettyNum(round(c(spring_abund$Lci_F, spring_abund$Uci_F)), big.mark = ","), collapse = " - ")`). By multiplying the ratio (`r round(total_cpue$catch_per_hr[total_cpue$event_name == "Spring 2021"] / mean(total_cpue$catch_per_hr[total_cpue$event_name %like% "Fall"]), 2)`) between the spring CPUE (`r round(total_cpue$catch_per_hr[total_cpue$event_name == "Spring 2021"], 2)`) and mean of the fall CPUEs (`r round(mean(total_cpue$catch_per_hr[total_cpue$event_name %like% "Fall"]), 2)`), we estimated there to be `r prettyNum(round(spring_abund$N_S), big.mark = ",")` (95% CI: `r paste(prettyNum(round(c(spring_abund$Lci_S, spring_abund$Uci_S)), big.mark = ","), collapse = " - ")`) Northern Pikeminnow in Deadwater Slough during spring 2021.

<!--However, because our sampling design most closely matched a multiple census estimator (i.e., we released marked fish each day and recaptures from all previous days were recorded for each day), we fell those estimators most appropriate. Additionally, because the Schnabel estimator includes a small sample size modification, as in our case (i.e., few recaptures), we feel it is most appropriate. The Schnabel estimator has the added benefit of more precise confidence intervals and is more straightforward than the Schumacher-Eschmeyer estimate as it is essentially the weighted average among multiple Chapman-modified Lincoln-Peterson estimates. Therefore, further analyses and results will be based on the Schnabel estimates of abundance.-->

The PSD for Northern Pikeminnow in Deadwater Slough across all three efforts was `r prettyNum(psd, digits = 1)`% i.e., `r prettyNum(psd, digits = 1)`% of captured fish were over the quality size classification defined by @Winther2020. For comparison, @Winther2020 reported a PSD for Northern Pikeminnow captured below Bonneville Dam of 41% and 18% in Bonneville Reservoir, suggesting that a larger fraction of Northern Pikeminnow in Deadwater Slough are of a quality size relative to populations reported elsewhere in the Columbia River. In fact, the state record Northern Pikeminnow, which measured `r max(cmr_df$length, na.rm = T)` mm (`r round(max(cmr_df$length, na.rm = T) / 25.4, 1)` in) TL, was caught in Deadwater Slough during the fall 2020 effort.


## Stomach Contents

We examined the stomach contents of Northern Pikeminnow from Deadwater Slough using gastric lavage. To validate the efficacy of the method, we euthanized 75 Northern Pikeminnow after gastric lavage was completed and removed the remaining food items via dissection. We found that gastric lavage successfully removed food items in all dissected individuals, indicating the method was effective. Of the `r prettyNum(gastric_tbl$lavaged[gastric_tbl$event_name == "Total"], big.mark = ",")` Northern Pikeminnow sampled using gastric lavage, we found contents in some form in `r prettyNum(gastric_tbl$stmch_contents[gastric_tbl$event_name == "Total"], big.mark = ",")` (`r prettyNum((gastric_tbl$stmch_contents[gastric_tbl$event_name == "Total"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Total"]) * 100, digits = 3)`%) stomachs and confirmed fish or fish parts in `r prettyNum(gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"], big.mark = ",")` (`r prettyNum((gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"] / gastric_tbl$stmch_contents[gastric_tbl$event_name == "Total"]) * 100, digits = 3)`%) of those. Northern Pikeminnow captured during the spring 2021 effort had a higher proportion of diets with fish contents (`r round(100 * gastric_tbl$fish_contents[gastric_tbl$event_name == "Spring_2021"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Spring_2021"], 1)`%) than fish captured in the fall 2019 (`r round(100 * gastric_tbl$fish_contents[gastric_tbl$event_name == "Fall_2019"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Fall_2019"], 1)`%) and fall 2020 (`r round(100 * gastric_tbl$fish_contents[gastric_tbl$event_name == "Fall_2020"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Fall_2020"], 1)`%) (Table \@ref(tab:gastric-tab)). For those individuals with stomach contents, the average wet weight of total contents was `r prettyNum(mean(stmch_df$stomach_contents_weight), digits = 2)` g (median = `r prettyNum(median(stmch_df$stomach_contents_weight), digits = 3)` g; range = `r round(min(stmch_df$stomach_contents_weight), 2)`-`r round(max(stmch_df$stomach_contents_weight), 2)` g). Overall, fish or fish remnants were `r prettyNum(mean(stmch_df$p_fish) * 100, digits = 3)`% of the overall stomach contents examined.


## Fish Consumption Potential

We estimated an individual, average-size (`r avg_fall_NPM` mm) Northern Pikeminnow to consume `r median(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"])` g (range: `r min(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"])` - `r max(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"])` g) of fish during the DSR emigration to maintain their body size, depending on the proportion of diet consisting of fish versus invertebrates (Figure \@ref(fig:bio-p)). Similarly, we estimated an average-size (`r avg_spring_NPM` mm) Northern Pikeminnow to consume `r median(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` g (range: `r min(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` - `r max(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` g) of fish during the NRR emigration (Figure \@ref(fig:bio-p)). Given a mean Northern Pikeminnow population size of `r prettyNum(unique(impact_df$N[impact_df$season == "Fall"]), big.mark = ",")` from fall estimates and `r prettyNum(unique(impact_df$N[impact_df$season == "Spring"]), big.mark = ",")` for spring 2021 and using the median value from diet scenarios (i.e., 50% of their diet consists of fish), we'd estimate that the Northern Pikeminnow population can consume `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Fall" & impact_df$perc_diet == 50]) * unique(impact_df$N[impact_df$season == "Fall" & impact_df$perc_diet == 50]), big.mark = ",")` g (range: `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Fall" & impact_df$perc_diet == 10]) * unique(impact_df$N[impact_df$season == "Fall" & impact_df$perc_diet == 10]), big.mark = ",")` - `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Fall" & impact_df$perc_diet == 90]) * unique(impact_df$N[impact_df$season == "Fall" & impact_df$perc_diet == 90]), big.mark = ",")` g) fish during the DSR emigration and an additional `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Spring" & impact_df$perc_diet == 50]) * unique(impact_df$N[impact_df$season == "Spring" & impact_df$perc_diet == 50]), big.mark = ",")` g (range: `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Spring" & impact_df$perc_diet == 10]) * unique(impact_df$N[impact_df$season == "Spring" & impact_df$perc_diet == 10]), big.mark = ",")` - `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Spring" & impact_df$perc_diet == 90]) * unique(impact_df$N[impact_df$season == "Spring" & impact_df$perc_diet == 90]), big.mark = ",")` g) during the NRR emigration in Deadwater Slough. In total, the Northern Pikeminnow population can consume `r prettyNum(unique(impact_df$g_fish_cons[impact_df$season == "Fall" & impact_df$perc_diet == 50]) * unique(impact_df$N[impact_df$season == "Fall" & impact_df$perc_diet == 50]) + unique(impact_df$g_fish_cons[impact_df$season == "Spring" & impact_df$perc_diet == 50]) * unique(impact_df$N[impact_df$season == "Spring" & impact_df$perc_diet == 50]), big.mark = ",")` g of fish during the DSR and NRR emigrations to maintain their population size if we assume 50% of their diet consists of fish.


## Potential Impacts to Chinook Salmon Populations

1. Start with total g of fish consumed by Northern Pikemnnow population, summing DSR and NRR time periods.
2. Parse out portion of fish total g consumed that is juvenile Chinook Salmon (1%, 10%, 30%, 50%).
3. Divide by average weight of juvenile Chinook Salmon (10.6 g), the average of DSR (10.3 g) and NRR (10.9 g) emigrants.
4. Estimate of total juvenile Chinook Salmon consumed.
5. Multiply by SAR to estimate "adult equivalents".

<!--
## Juvenile Chinook Salmon Abundance
For context, throughout the migration periods of DSR and NRR life histories it is estimated that 113,976 individuals are produced and therefore available within the upper Salmon River basin (Table x).

The abundance of juvenile Chinook Salmon for the upper Salmon River basin was estimated at 6 rotary screw traps [@McClure2020]. Overall, in 2020, there were an estimated 59,289 DSR, 22,264 NRR, and 10,159 parr estimated among all these traps in the upper Salmon River basin (Table X.)
-->


# Discussion

```{r john-day}
john_day_res_abund = 85316
john_day_rkms = 123
john_day_dens = john_day_res_abund / john_day_rkms

low_columbia_fish_km = 2814

```

The mean population size of Northern Pikeminnow in the Deadwater Slough during the fall season was estimated to be `r prettyNum(unique(round(impact_df$N[impact_df$season == "Fall"])), big.mark = ",")` and during the spring 2021 to be `r prettyNum(unique(round(impact_df$N[impact_df$season == "Spring"])), big.mark = ",")`. Those estimates translate to linear densities of `r prettyNum(round(unique(impact_df$N[impact_df$season == "Fall"]) / ddw_rkms), big.mark = ",")` and `r prettyNum(round(unique(impact_df$N[impact_df$season == "Spring"]) / ddw_rkms), big.mark = ",")` 
<!-- need units  -->
which is `r round(unique(impact_df$N[impact_df$season == "Fall"]) / ddw_rkms / john_day_dens)` and `r round(unique(impact_df$N[impact_df$season == "Spring"]) / ddw_rkms / john_day_dens)` times greater, respectively, than densities reported by @Beamesderfer1991 for the John Day Reservoir and approximately `r as.character(english(round(unique(impact_df$N[impact_df$season == "Fall"]) / ddw_rkms / low_columbia_fish_km)))` and `r as.character(english(round(unique(impact_df$N[impact_df$season == "Spring"]) / ddw_rkms / low_columbia_fish_km)))` times greater than projections for the lower Columbia River [@Beamesderfer1996]. Although estimated densities for Deadwater Slough are high given the relative size (volume) of the Salmon River at the slough relative to the Columbia River, high CPUE combined with low recapture rates (one in every `r round(nrow(cmr_df) / sum(cmr_df$capture_type == "Recapture", na.rm = T))` captured fish were recaptures) suggest this area may support exceptionally high predator densities. Further, @Beamesderfer1991 acknowledge that their methods were unsuitable for sampling offshore, noting that water velocity, depth, irregular bottom contours, and barge traffic made sampling offshore ineffective. Conversely, at Deadwater Slough the maximum depth was approximately 10-15 m with a relatively homogenous bottom contour, making angling an effective method throughout the entire reach. Our estimates of Northern Pikeminnow areal density are also higher than those reported elsewhere in the Columbia River basin. We estimate the density of Northern Pikeminnow in Deadwater Slough, as fish per hectare, to be `r prettyNum(round(unique(impact_df$N[impact_df$season == "Fall"]) / ddw_hectares), big.mark = ",")` for fall and `r prettyNum(round(unique(impact_df$N[impact_df$season == "Spring"]) / ddw_hectares), big.mark = ",")` for spring. For comparison, the only other available estimates of areal density, that the authors are aware of, are 4.4 fish per hectare for John Day Reservoir [@Beamesderfer1991] and 15 fish per hectare in Lake Washington [@Bartoo1977]. Given the dearth of current data available in the Columbia River basin, it is unclear how Northern Pikeminnow abundance estimates in this study compare to elsewhere in the Columbia River Basin. @Widener2021 has identified a need for more current information on piscine predator populations in the Columbia River.


## Mark-Recapture Models

All mark-recapture abundance estimators suggest a large number of Northern Pikeminnow occupying Deadwater Slough. Several assumptions in our estimators may have influenced the magnitude of our results. First, all models assumed a closed population, however, it is possible that immigration and emigration occurred. Nevertheless, our estimators still provide unbiased estimates of abundance assuming the immigration and emigration rates are equal between marked and unmarked fish. Given the size of the sampling area, and the limited length of the sampling period (two weeks), that assumption is likely met. The assumption of a closed population can also affect results if mortality occurs for some marked fish released back to the population. During our field processing, we did not observe mortalities or injury post release; however, the potential for mortality amongst marked and released fish cannot be discounted. Next, our estimates assumed that the second (and subsequent) sample(s) are random samples of the population. Angling methods may have a size selection bias, thereby limiting our abundance estimates to a size threshold susceptible to angling, and possibly biasing them low. We also consider the validity of our assumption of equal catchability of individual fish between sampling events to have introduced potential bias in our results. Unequal catchability for individual fish is difficult to assess, especially if being caught once influences the likelihood of recapture. During our study, we recaptured two individual fish during multiple surveys indicating that marked fish were still susceptible to angling.<!--We are also comfortable with the assumptions of no loss of marks or no mistaken or missed marks given that marks were physical (hole punches in fins) and that each fish was examined on a measuring board to collect lengths.--> 

We further recognize that marked and released fish may not have mixed thoroughly back into the population prior to recapture events. Although we attempted to release marked fish evenly throughout Deadwater Slough, we anecdotally observed anglers congregating in particular areas of the slough to socialize or exploit the "good" fishing locales. If marked fish were not recently released or mixed back into those areas that would result in marked fish being less susceptible to capture. Violations of the assumption of equal catchability between marked and unmarked fish may lead to an overestimate of abundance of Northern Pikeminnow in our study if marked fish have lower catchability. This bias will be proportional to the difference in catchability of marked and unmarked fish, so if marked fish are only 70% as likely to be caught as unmarked fish (due to behavior or spatial distribution) the true abundance is closer to 70% of our abundance estimate. We calculated this for the Schnabel estimator by assuming that only 70% of the fish marked each sample were returned to the populuation and available for recapture. 

<!--
All mark-recapture abundance estimators suggest a large number of Northern Pikeminnow occupying Deadwater Slough. Estimators assumed: (1) the population is closed (no immigration, emigration, births, or deaths during the sampling period), (2) all fish have equal chance of being caught in the second (and subsequent) samples(s), (3) marking a fish does not affect its chances of recapture, (4) no loss of marks, and (5) marks are not missed or mistaken. If the population is actually open (potential immigration and/or emigration during the survey period), our estimators should still provide unbiased estimates of abundance as long as the immigration and emigration rates are equal between marked and unmarked fish. Given the size of the sampling area, and the limited length of the sampling period (two weeks), we are comfortable with the assumption of no immigration or emigration. Assumption (3) indicates whether the second (and subsequent) surveys are random samples of the population. Angling methods may provide a size selection bias, but that only affects the interpretation of the abundance estimates (i.e., our estimates are the abundance of Northern Pikeminnow susceptible to angling above some size threshold). Unequal catchability between individual fish is very difficult to assess, especially if that heterogeneity arises from being caught once; however, we did recapture two individual fish more than once suggesting that marked fish were still susceptible to angling. We are also comfortable with assumptions 4 and 5 (no loss of marks and no mistaken or missed marks) given that marks were physical (hole punches in fins) and that each fish was examined on a measuring board to collect lengths.

We do consider two potential violations of assumption, both which reduces the probability that a marked fish is susceptible to capture in the second (and subsequent) samples. First, the assumption of a closed population could be violated if some marked fish that are released back to the population die. We don't believe this case to be likely, as fish that were dead or nearly so after processing were not released back to the population (nor recorded as such), and those that were released were hand-released only if they were able to swim away on their own volition; however, the potential for marked and released fish to have died at a higher rate than unmarked fish should be acknowledged. The second, and more likely, reason is that marked and released fish did not mix thoroughly back into the population (at least not at a fast enough rate), reducing their probability of capture in subsequent captures, thus violating assumption (2). We attempted to release marked fish throughout Deadwater Slough to facilitate mixing back into the population; however, anecdotally volunteer anglers would congregate to particular areas of the slough either to socialize with other anglers, because the fishing was good, etc. and if marked and released fish were not readily available in those areas that would make marked fish less susceptible to capture. This violation would, in effect, reduce the number of marked fish available for recapture or reduce the marking fraction in some areas of the slough. Violations of assumption (2) would lead to an overestimate of abundance of Northern Pikeminnow which is a real possibility in our study.
-->

The spring abundance estimate was smaller than fall abundance estimates. Our approach assumed equal capture probabilities between the fall and spring sample efforts. Yet, we suspect that the capture probability in the spring could be lower as higher spring flows reduce Northern Pikeminnow densities biasing our spring abundance estimate low. Therefore, we believe our spring abundance estimate to be conservative.
<!-- how do higher spring flows reduce pikeminnow densities? If pikeminnow densities are lower, then the total abundance SHOULD be lower. Makes more sense to me to say that higher flows directly lower capture probabilities. -->


## Stomach Contents

We performed gastric lavage on nearly all Northern Pikeminnow collected during this study. In addition to juvenile Chinook Salmon, species included Redside Shiner, Largescale Sucker *Catostomus macrocheilus*, sculpin *Cottus* spp., and Mountain Whitefish *Prosopium williamsoni*; although decomposition from digestion rendered many fish contents unidentifiable. While this approach provided useful information on prey species, we have concerns about using angling and gastric lavage to quantify diet composition in Northern Pikeminnow. First, previous studies have indicated that diets of angled fish differ from those collected by other methods (e.g., electrofishing) [@Hodgson1988], and further, angled fish are more likely to have empty stomachs [@Jurajda2016], perhaps because they are hungry and actively searching for food. Second, unlike other predators such as Smallmouth Bass and Walleye that are commonly sampled using gastric lavage [@Kamler2001], Northern Pikeminnow are cyprinids and therefore lack a true stomach. Previous research indicates that performing gastric lavage on cyprinid species can be ineffective at quantifying diet composition [@Hartleb1995], or alternately, requires a modification in methodology to flush food items out the vent of the fish [@Wasowicz1994]. Our intent, rather, was to simply document predation on juvenile Chinook Salmon in Deadwater Slough, and given the potential ineffectiveness of gastric lavage using angling and for Northern Pikeminnow, we consider our diet composition estimates to be conservative estimates i.e., we believe that a larger proportion of the Northern Pikeminnow diet is fish and juvenile Chinook Salmon than our gastric results suggest. 


## Bioenergetics
<!--
OUR APPROACH:
1. g of fish consumed during DSR and NRR peak emigrations
2. Combine results from #1 for total g consumed by an individual NPM
3. Parse out the percentage of fish prey that is juvenile Chinook salmon
  - start w/ conservative scenarios of 10% and 25%
4. Divide total g consumed by 10.6 g, the average juvenile Chinook Salmon from Upper Salmon MPG, to estimate the # of juvenile Chinook Salmon consumed
5. Multiply results from #4 by a "stable" NPM population size estimate
6. Multiply results from #5 by SAR from McCann et al. 2019 for Upper Salmon MPG Chinook
-->

An average-size Northern Pikeminnow from Deadwater Slough is estimated to consume `r median(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"])` g (range: `r min(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"])` - `r max(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"])` g) and `r median(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` g (range: `r min(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` - `r max(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` g) of fish during fall and spring, respectively, to maintain its body weight. This equates to `r median(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"]) + median(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` g of fish consumed during the DSR and NRR peak emigrations, assuming the median value among diet scenarios (i.e., if 50% of their diet consists of fish). Consumption ranged from `r min(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"]) + min(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` for a diet comprised of 10% fish to `r max(bio_g_summ$cumm_g[bio_g_summ$season == "Fall"]) + max(bio_g_summ$cumm_g[bio_g_summ$season == "Spring"])` for a diet comprised of 90% fish.

Our approach assumed that all available prey consumed by Northern Pikeminnow have energy densities equal to juvenile Chinook Salmon. Other salmonid including juvenile steelhead and Sockeye Salmon are likely also available prey in Deadwater Slough, especially during the spring migration. Additionally, hatchery smolt releases (Chinook Salmon, steelhead, and Sockeye Salmon) are also prevalent in the mainstem Salmon River during the spring migration. Other studies have used a similar approach where the energy densities of different salmonids were generalized using an estimate from a single species [@Petersen1999].<!-- The following needs to be updated after we finalize some results --> However, our study is focused on potential impacts to natural-origin DSR and NRR Chinook Salmon, in which case, let's consider a thought exercise where DSR and NRR Chinook Salmon represent only 10% and 25% of total fish prey consumed by Northern Pikemnnow during these periods. Under these scenarios, the average Northern Pikeminnow would consume 8.95 g (range 4.52  10.05 g) if 10% of prey were natural-origin Chinook Salmon and 22.38 g (range 11.31  25.12) if 25%. 

Our estimated consumption of Chinook Salmon juveniles by Northern Pikeminnow was calculated using a static predator population. If we assume an average juvenile Upper Salmon MPG Chinook Salmon of 10.6 g, this equates to 0.84 juvenile Chinook Salmon (range 0.43  0.94) under the 10% scenario and 2.11 juvenile Chinook Salmon (range 1.07  2.37) under the 25% scenario. Lets now consider a stable Northern Pikeminnow population size of 10,000 (roughly the mean of fall and spring abundance estimates, divided by two to account for half of marked individuals not being available for recapture). In this case, the Northern Pikeminnow population in Deadwater Slough would be estimated to consume 8,400 (range 4,300  9,400) or 21,100 (range 10,700  23,700) under the 10% and 25% scenarios, respectively.


## Impacts to Adult Returns

<!-- Also update this after finalizing results -->
Our primary objective was to assess the impact of predation on juvenile Chinook Salmon in the Upper Salmon MPG. However, there is also interest in estimating the number of additional adult Chinook Salmon that might be expected to return to Lower Granite Dam if predation in the Deadwater Slough was reduced or eliminated. Our approach here was to multiply the total estimated juvenile Chinook Salmon consumed by an estimate of Granite-to-Granite smolt-to-adult survival rate (SAR) from @McCann2019 for Upper Salmon River MPG Chinook Salmon. Assuming an SAR of `r round(sar$medsar, 5)` (SE: `r prettyNum(round(sar$sdsar, 5))`) we'll consider the "adult equivalents" to our estimates of juveniles consumed. Under this scenario, the consumed juveniles would be equivalent to 51.6 adults (range 26.4  57.7) and 129.6 adults (range 65.7  145.6). However, we believe these 10% and 25% scenarios to be conservative, especially during the fall DSR emigration period. During spring, natural-origin steelhead and Sockeye Salmon are also actively emigrating from the Upper Salmon River and hatchery-origin releases of all three species (Chinook Salmon, steelhead, and Sockeye Salmon) are present in the river, and so 10% or 25% may be reasonable. However, during fall, DSR Chinook Salmon are likely the dominant prey species available to Chinook Salmon in Deadwater Slough as 1) no (or at least minimal) hatchery releases are present in the river and 2) fall emigrations of steelhead and Sockeye Salmon are less prominent than in Chinook Salmon. Note that this thought exercise only includes the Northern Pikeminnow population in Deadwater Slough even though they are present throughout the upper Salmon River, although likely at lower densities than in Deadwater Slough, and also ignores potential impacts to ESA-listed steelhead and Sockeye Salmon that are also a portion of the Northern Pikeminnow diet.
<!--
Additional thoughts here:
*	SAR results. Those results are GRA - GRA SARs, estimated from multiple years of PIT tag data. Seem pretty good to me.
* Maybe a plot of multiple scenarios
-->


## Avian Predation

Although not formally assessed in this study, avian predators including Great Blue Herons *Ardea herodias* and Bald Eagles *Haliaeetus leucocephalus* are another potential source of mortality for juvenile Chinook Salmon and other ESA-listed salmonids in the Deadwater Slough. The Deadwater Slough is recognized as an important bird watching and nesting area due to the associated upstream braided channels and riparian and backwater habitats [(Deadwater Slough - Audubon Important Bird Areas)](https://www.audubon.org/important-bird-areas/deadwater-slough#). Several piscivorous bird species have been documented using Deadwater Slough including the Common *Mergus merganser* and Hooded *Lophodytes cucullatus* mergansers, the Great Blue Heron, the Double-crested Cormorant *Phalacrocorax auritus*, and the Belted Kingfisher *Megaceryle alcyon* [@eBird2021]. During the initial sampling effort in fall 2019, a two-person crew walked the entire reach including surrounding and upstream areas scanning for passive integrated transponder (PIT) tags that are implanted into thousands of natural- and hatchery-origin salmonids in the Upper Salmon River, annually. During that informal survey, 10 PIT tags were recovered near active bird nests and in an upstream anastomizing reach where herons and eagles are prevalent, suggesting that mortality may have been a result of avian predation. The PIT tag histories in [PTAGIS](https://www.ptagis.org/) indicate these tags were implanted into a combination of juvenile Chinook Salmon (3), Sockeye Salmon (4), and steelhead (3). Two of the Chinook Salmon and one steelhead were natural-origin, the remaining were of hatchery-origin. Avian predation contributes a major component of the total mortality for yearling Chinook Salmon in some locations in the lower Snake and Columbia rivers, particularly at hydroelectric dams and within reservoirs [@Evans2012; -@Evans2016]; however, we did not observe large colonies of piscivorous birds within the study area. Although we did observe Belted Kingfishers, mergansers, and Great Blue Herons at Deadwater Slough during field efforts; Great Blue Herons were especially prevalent in the anastomizing reach immediately upriver of the slackwater reach. Additionally, there is documentation of individual Double-crested Cormorants [@eBird2021] at the Deadwater Slough; however, the site is not within their breeding range, rather, it is part of a migration corridor. Given the current avian species known to occupy Deadwater Slough, it is unlikely that avian predation on juvenile salmonids is comparable to elsewhere in the Columbia River basin with large piscivorous bird colonies. Nevertheless, we hypothesize that the reservoir-like conditions and associated habitat features at the Deadwater Slough may increase the probability of avian predation on juvenile Chinook Salmon and other ESA-listed salmonids from the many piscivorous birds known to use the site. Future studies of predation would benefit from estimates from piscivorous avian predators.


## Management Implications

<!-- Again, some of the following numbers need to be updated after results are formalized -->
Recovery of Chinook Salmon in the Upper Salmon MPG is desired to support local fisheries and economies. At least five of the eight populations must meet criteria set forth by @McElhany2000 and @ICTRT2007 for the MPG to be considered viable and for recovery of the Snake River Evolutionary Significant Unit. Spawner abundance is perhaps the most important metric considered in determining a population's viability. We estimated that consumption of juvenile Chinook Salmon by Northern Pikeminnow in the Deadwater Slough potentially reduces natural-origin returns to upriver populations by 26.4 to 145.6 adults, annually. This is between 4.7% and 26.1% of the total mean adult escapement<!--of 558--> reported for the Upper Salmon River MPG in 2017 - 2019 [@Kinzer2020]. These estimates only take into account predation on juvenile Chinook Salmon by Northern Pikeminnow, but presumably, juvenile steelhead and Sockeye Salmon are also prey items in Deadwater Slough, including hatchery releases. Therefore, adult returns of steelhead and Sockeye Salmon are affected as well, including for hatchery populations which provide recreational fishing opportunities. Consequently, reducing predation mortality at Deadwater Slough could potentially benefit multiple upriver natural and hatchery populations, including multiple ESA-listed species. Because the Deadwater Slough is part of the migratory pathway for multiple species and populations of emigrating salmonids, the impact of that benefit could be higher than tributary rehabilitation actions which typically benefit a single population. Moreover, the deepened, slack water conditions that favor Northern Pikeminnow at Deadwater Slough are a result of the failure of a manmade mining reservoir dam. Taken together, the Deadwater Slough is a favorable candidate for management or restoration actions to benefit local Chinook Salmon populations.

We envision two potential management actions at reducing predation at Deadwater Slough: 1) removing the Dump Creek alluvial fan and 2) a local Northern Pikeminnow bounty program to encourage harvest in Deadwater Slough aimed at reducing the predator population size. Both actions have evident pros and cons. Removing the Dump Creek alluvial fan has the benefit of restoring the Salmon River to a more natural flow (e.g., increased water velocity, decreased depth) and bathymetry (e.g., heterogeneous substrate) that likely existed in the reach prior to the failure of the mining reservoir dam in Dump Creek. Restoring flow would presumably reduce Northern Pikeminnow densities to levels similar to upstream and downstream reaches where recent studies identified higher survival and transition probabilities than those at Deadwater Slough (@Axel2015; @Ackerman2018; @Porter2019). However, we do not know the feasibility of removing or alleviating the Dump Creek alluvial fan, and if it could be removed or altered, future disturbance events could potentially move additional loose sediment in the Dump Creek drainage, thereby creating a new alluvial fan. Additionally, restoring the flow would likely diminish the value of the reach as an important bird watching and nesting area. 

Northern Pikeminnow bounty programs have proven successful at reducing population sizes and impacts on emigrating salmonids elsewhere (*citation*). A local bounty program in the Salmon River has the potential to boost the local economy (to an unknown degree) which has been negatively impacted by low returns of Chinook Salmon, steelhead, and Sockeye Salmon in recent decades. Many local businesses rely on license and gear sales for local sport fisheries, but low salmon and steelhead returns have eliminated or reduced the duration of fisheries in some years, and a local Northern Pikeminnow bounty program could allow the local economy to recoup some of those lost revenues. On the downside, bounty programs require continual effort and harvest to suppress the population size and so would require years of continued funding and local buy-in to remain effective. If funding or effort was alleviated, Northern Pikeminnow would likely recover to a higher population size without additional alterations to the habitat. 
<!--
What about adding cover? It could potentially provide refugia for juvenile salmonids, but could make recreational angling more difficult

Is there anything in the literature that discusses habitat preferences for pike minnow? If we speed up velocities and add some cover potentially pike minnow predation success will be lowered. Will these fish just move elsewhere? 
-->


## Conclusions

The failure of a mining reservoir dam in the late 19th century created an alluvial fan at the confluence of the Salmon River and Dump Creek which has backed up the Salmon River and created an almost 2-kilometer section of unnaturally slow and deep river, resulting in favorable conditions for Northern Pikeminnow. We estimate that greater than 10,000 Northern Pikeminnow occupy Deadwater Slough with densities greater than reported elsewhere. Additionally, the slow water velocity and lack of cover have created conditions that favor predation on juvenile salmonids emigrating through Deadwater Slough including Chinook Salmon i.e., juvenile Chinook Salmon have slower movement rates and little refugia to avoid predation. We estimate that predation from Northern Pikeminnow in Deadwater Slough may reduce adult returns by as much as 146 or 26% of recent returns to the Upper Salmon River MPG. Therefore, predation in Deadwater Slough likely has a consequential impact on ESA-listed Chinook Salmon populations in the Upper Salmon MPG.   


# Acknowledgements

The authors extend much appreciation to the many volunteers that assisted with field efforts including collaborators from the Bureau of Reclamation, Idaho Governors Office of Species Conservation, Idaho Department of Fish and Game, and the Lemhi Regional Land Trust, among others. Special thanks to Jared Barker, Brian Hamilton, Tulley Mackey, and Chelsea Welke for their help in the field. We further appreciate the administrative support and guidance from Caitlin Alcott and Inter-Fluve. This manuscript benefitted from a review by Sean Gibbs. Funding for this study was provided by the Bureau of Reclamation, Pacific Northwest Regional Office (contract No. 140R1021F0018) with assistance from the Idaho Governors Office of Species Conservation.


\newpage

# Literature Cited 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

# Tables

<div id="tables"></div>

```{r abund-data-lp}
LP_mod %>%
  select(event_name, species, data) %>%
  distinct() %>%
  select(-species) %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  rename(`Effort` = event_name) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Summary of Northern Pikeminnow angling survey data for single-census mark-recapture estimators. M is the total number of fish caught in the first sample (week), marked and returned to the population; n is the total number of fish caught in the second sample (week), and m is the number of previously marked fish caught in the second week.") %>%
  kable_styling()

```

\newpage

```{r abund-data-schn}
N_mods %>%
  select(event_name, species, data) %>%
  distinct() %>%
  select(-species) %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  select(event_name, date, M, n, m, u, R) %>%
  rename(`Effort` = event_name,
         Date = date) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Summary of Northern Pikeminnow angling survey data for multiple-census mark-recapture estimators. M is the total number of fish caught in previous samples (days), marked and returned to the population; n is the total number of fish caught in the current sample (day); m is the number of marked fish caught in that sample; u is the number of unmarked Northern Pikeminnow caught, and R is the number of marked fish returned to the population. Dates of sampling are also provided.") %>%
  kable_styling()

```

\newpage

```{r abund-tab}
all_est %>%
  mutate(across(c(N, SE, Lci, Uci),
                ~ prettyNum(round(.), big.mark = ","))) %>%
  rowwise() %>%
  mutate(CI = paste(Lci, Uci,
                    sep = " - ")) %>%
  select(-c(species, range:prop_range),
         -Lci, -Uci) %>%
  rename(`Effort` = event_name,
         Estimator = model,
         `95% Confidence Interval` = CI) %>%
         # `L CI` = Lci,
         # `U CI` = Uci) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Point estimates, standard errors, and 95% confidence intervals for each of the mark-recapture estimators and for the fall sampling efforts. Standard errors are not available for the multiple-census estimators.") %>%
  kable_styling()

```

```{r spring-N, eval = F}
spring_abund %>%
  rowwise() %>%
  mutate(`Avg. Fall N (CI)` = paste0(prettyNum(round(N_F), big.mark = ","),
                                     " (",
                                     paste0(prettyNum(round(c(Lci_F, Uci_F)), big.mark = ","),
                                            collapse = ", "),
                                     ")"),
         `Spring N (CI)` = paste0(prettyNum(round(N_S), big.mark = ","),
                                     " (",
                                     paste0(prettyNum(round(c(Lci_S, Uci_S)), big.mark = ","),
                                            collapse = ", "),
                                     ")")) %>%
  ungroup() %>%
  select(Species = species,
         `Avg Fall CPUE` = cpue_F,
         `Spring CPUE` = cpue_S,
         ends_with("(CI)")) %>%
  kable(booktabs = T,
        caption = "Average CPUE and abundance in the fall (95% confidence interval), and CPUE and estimates of spring abundance (95% confidence interval) for Northern Pikeminnow in Deadwater Slough.") %>%
  kable_styling()

```

\newpage

```{r gastric-tab}
gastric_tbl %>%
  rename(Effort = event_name,
         Captured = captured,
         Lavaged = lavaged,
         'Stomach Contents' = stmch_contents,
         'Fish Contents' = fish_contents) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Summary of gastric lavage results including the total number of fish captured and gastric lavaged. For Northern Pikeminnow that were gastric lavaged, we show the number containing stomach contents, and of those, the number containing fish contents.") %>%
  kable_styling()

```

\newpage

```{r adult-imp, eval = F}
impact_df %>%
  select(season,
         perc_diet,
         juv_chnk,
         smolt_N,
         smolt_Lci,
         smolt_Uci,
         medsar,
         sdsar,
         adult_N,
         adult_Lci,
         adult_Uci) %>%
  mutate(juv_chnk = round(juv_chnk, 2),
         smolt_N = round(smolt_N, 0),
         smolt_Lci = round(smolt_Lci, 0),
         smolt_Uci = round(smolt_Uci, 0),
         medsar = round(medsar, 5),
         sdsar = round(sdsar, 5),
         adult_N = round(adult_N, 0),
         adult_Lci = round(adult_Lci, 0),
         adult_Uci = round(adult_Uci, 0)) %>%
  rename(Season = season,
         `p Fish` = perc_diet,
         `Fish Per NPM` = juv_chnk,
         `Fish N` = smolt_N,
         `Fish L CI` = smolt_Lci,
         `Fish U CI` = smolt_Uci,
         `Median SAR` = medsar,
         `SD SAR` = sdsar,
         `Adult N` = adult_N,
         `Adult L CI` = adult_Lci,
         `Adult U CI` = adult_Uci) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Estimates of the number of fish consumed for each season and diet scenario. The diet scenario indicates the proportion of the Northern Pikeminnow diet consisting of fish. The 'Fish Per NPM' column indicates the number of fish an individual Northern Pikeminnow to consume during the fall or spring seasons assuming an average weight of 10.3 (DSR) and 10.9 (NRR) grams for juvenile Chinook Salmon and is taken from each of the 18 bioenergetics model runs. The number of fish consumed (and 95% confidence intervals) are calculated using Northern Pikeminnow abundance estimates of 28,144 (95% CI: 14,378 - 59,978) for fall and 14,897 (95% CI: 7,610 - 31,747) for spring. The number of 'adult equivalents' is also estimated using a Lower Granite Dam smolt-to-adult rate (SAR) for Chinook Salmon from McCann et al. 2019.") %>%
  kable_styling(font_size = 8)

```

\newpage

# Figures

<div id="figures"></div>

```{r map, out.width = "85%", fig.cap = "Map of the Deadwater Slough study area. The high-resolution orthoimage portion surrounding the Deadwater Slough was generated from aerial images taken by an unmanned aircraft system (drone). The red polygon indicates the reach characterized by unnaturally slow water velocities and a deepened channel. The location of the Dump Creek delta is indicated."}
knitr::include_graphics("../figures/deadwater_map_low_res.png")

```

\newpage

```{r cpue-fig, fig.cap = "The number of Northern Pikeminnow caught per angler effort for each sample effort."}
total_cpue %>%
  ggplot(aes(x = event_name,
             y = catch_per_hr)) +
  geom_col(fill = "gray30") +
  labs(y = "Catch Per Angler Hour") +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(size = 11,
                                   color = "black"),
        axis.title.y = element_text(vjust = 3),
        axis.text.y = element_text(size = 11,
                                   color = "black"))

```

\newpage

```{r abund-fig, fig.cap = "Estimates of abundance of Northern Pikeminnow using different mark-recapture estimators and for the fall sampling events. Single census estimators are shown as circles; multiple census estimators are shown as triangles. Note the y-axis is truncated at 100 and the upper confidence interval for the Schumacker-Eschmeyer estimator in 2020 extends beyond that."}

pos = position_dodge(width=0.3)
pm_est_labels <- c("Chapman","Schnabel","Schnabel \n Delayed-mixing")
all_est %>%
  
  mutate(across(c(N, Lci, Uci),
                ~ . / 1000)) %>%
  mutate(census = case_when(grepl("Chapman", model) ~ "single",
                            grepl("Petersen", model) ~ "single",
                            grepl("Schnabel", model) ~ "multiple",
                            grepl("Schumacher-Eschmeyer", model) ~ "multiple")) %>%


  ggplot(aes(x = model,
             y = N,
             #color = model
             )) +
  geom_errorbar(aes(ymin = Lci,ymax = Uci, group=event_name), position = pos, width=0) + 
  geom_point(aes(shape = event_name), position = pos, size = 4) +
    #facet_wrap(~ event_name) +
  coord_cartesian(ylim = c(0, 100)) +
  scale_shape_manual(values = c(21, 19), name="Event") +
  #scale_color_manual(values = c("grey35", "darkred"), name="Census type") +
  scale_x_discrete(labels=c(pm_est_labels))+
  labs(x = "Estimator",
       y = "Abundance (x 1,000)") +
  #scale_size(guide = "none")+
  theme(legend.position = c(.15, .85),legend.background = element_blank(),
        legend.key.size = unit(.5, "cm"),legend.box = 'horizontal',
        #axis.title.x = element_blank(),
        axis.text.x = element_text(size = 11, color = "black"),
        axis.text.y = element_text(size = 11, color = "black"),
        strip.text.x = element_text(size = 11,color = "black"))
  #scale_color_brewer(palette = "Dark2")

```

\newpage

```{r stmch-cont-p, eval = F, fig.cap = "A stomach contents plot."}
stmch_cont_per_sz_p = gastric_df %>%
  filter(method %in% "Angling") %>%
  ggplot() +
  aes(x = fish_or_parts) +
  geom_bar(fill = "#DB740E") +
  labs(x = "Stomach Contents",
       y = "Frequency") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1)) +
  facet_wrap(vars(npm_50),
             nrow = 2L)

stmch_cont_per_sz_p

```

```{r length-freq-p, fig.cap = "Length frequency histogram of Northern Pikeminnow caught using hook-and-line angling during the study."}
length_freq_p = gastric_df %>%
  ggplot(aes(length)) +
  geom_histogram(breaks = seq(150, 650, by = 50),
                 col = "black",
                 fill = "gray30",
                 alpha = .2) +
  labs(x = "Total Length (mm)",
       y = "Number of Northern Pikeminnow") +
  xlim(c(100, 700)) +
  ylim(c(0, 800)) +
  scale_x_continuous(breaks = seq(0, 650, by = 50)) +
  scale_y_continuous(breaks = seq(0, 550, by = 50)) +
  theme(axis.text.x = element_text(size = 11,
                                   color = "black"),
        axis.text.y = element_text(size = 11,
                                   color = "black")) 


length_freq_p

```

\newpage

```{r bio-p, fig.cap = "The cumulative amount of fish (g) consumed by an individual Northern Pikeminnow during the peak DSR (fall) and NRR (spring) Chinook Salmon emigrations (top panel) and corresponding daily mean water temperatures (bottom panel). The black line is the median among diet scenarios (i.e., where 50% of the Northern Pikeminnow diet consists of fish) and the gray area shows the range among model scenarios (i.e., 10 - 90% of Northern Pikeminnow diet consists of fish). Daily mean water temperatures were summarized from six years of data available from the Shoup gage station. "}
# spring_results$season = "Spring"
# fall_results$season = "Fall"
# bio_results = rbind(spring_results, fall_results)
bio_results$ymd = (ymd(bio_results$date))

pFish = bio_results %>%
  ggplot(aes(ymd, f50_g)) +
  geom_line(size = 1.1) +
  geom_ribbon(data = bio_results,
              aes(ymd,ymin = f10_g,
                  ymax = f90_g),
              color = "grey55",
              alpha = 0.4) +  theme_bw() +
  labs(y = "Fish consumed (g)",
       x = "", title = "") +
  facet_rep_wrap(~season,scales = "free_x",
                 repeat.tick.labels = F) +
  theme(strip.background = element_rect(color = "white",
                                        fill = "white"),
        strip.text.x = element_text(size = 12),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 11,
                                   color = "black"),
        axis.title.y = element_text(vjust = 1,
                                    size = 12),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        plot.margin = unit(c(-.1, .3, -.3, .2), "cm"))

pTemp = bio_results %>%
  ggplot(aes(ymd, temperature_c)) +
  geom_line(color = "navyblue",
            size = 1.15) +
  theme_bw() +
  labs(y = expression("Water temp"*~degree*C),
       x = "Month",
       title = "") +
  facet_rep_wrap(~season,
                 scales = "free_x",
                 repeat.tick.labels = F) +
  theme(strip.background = element_rect(color = "white",
                                        fill = "white"),
        strip.text.x = element_blank(),
        axis.text.x = element_text(size = 11,
                                   color = "black"),
        axis.text.y = element_text(size = 11,
                                   color = "black"),
        axis.title.y = element_text(vjust = 0.1,
                                    size = 12),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        plot.margin = unit(c(-.2, .3, .1, .1), "cm"))

p_list = list(pFish, pTemp)
n_col = floor(sqrt(length(p_list)))

bio_p = do.call("grid.arrange",
                c(p_list, ncol = n_col))

```

\newpage

```{r adult-imp-p, fig.cap = "The estimated number of DSR (fall) and NRR (spring) emigrants consumed by Northern Pikeminnow in Deadwater Slough (top panel) across a range of diet scenarios where 10-90% of the diet consists of juvenile Chinook salmon. The bottom panel provides the adult equivalents assuming a Lower Granite Dam smolt-to-adult rate (SAR) from McCann et al. 2019."}
#impact_p = impact_df %>%
#  select(season,
#         perc_diet,
#         p_chnk,
#         N = juv_N,
#         Lci = juv_Lci,
#         Uci = juv_Uci) %>%
#  group_by(perc_diet, p_chnk) %>%
#  summarise(across(c("N", "Lci", "Uci"),sum),
#            .groups = "drop") %>%
#  mutate(Stage = "Juveniles") %>%
#  bind_rows(impact_df %>%
#              select(season,
#                     perc_diet,
#                     p_chnk,
#                     N = adult_N,
#                     Lci = adult_Lci,
#                     Uci = adult_Uci) %>%
#              group_by(perc_diet, p_chnk) %>%
#              summarise(across(c("N", "Lci", "Uci"),
#                   sum),
#             .groups = "drop") %>%
#             mutate(Stage = "Adult Equivalents")) %>%
#  mutate(p_chnk = p_chnk * 100) %>%
#  rename(perc_chnk = p_chnk) %>%
#  filter(perc_chnk %in% c(10, 30, 50)) %>%
#  ggplot(aes(x = perc_diet,y = N)) +
#  geom_errorbar(aes(ymin = Lci,
#                    ymax = Uci),
#                width = 0.1) +
#  geom_point(size = 3) +
#  facet_grid(vars(Stage),
#             vars(perc_chnk),
#             scales = "free_y") +
#  scale_color_viridis_d(name = "Percent\nFish in Diet") +
#  scale_y_continuous(labels = scales::comma) +
#  scale_x_continuous(breaks = seq(0, 100, by = 10)) +
#  theme(#axis.text.x = element_blank(),
        #legend.position = "bottom",
        #axis.title.x = element_blank(),
        #axis.ticks.x = element_blank(),
#        axis.text.y = element_text(size = 11,
#                                   color = "black"),
#        strip.text.x = element_text(size = 11,
#                                    color = "black"),
#        strip.text.y = element_text(size = 11,
#                                    color = "black")) +
#  labs(y = "Number Chinook Consumed")

#impact_p

impact_p = impact_df %>%
  select(season,
         perc_diet,
         p_chnk,
         N = juv_N,
         Lci = juv_Lci,
         Uci = juv_Uci) %>%
  group_by(perc_diet, p_chnk) %>%
  summarise(across(c("N", "Lci", "Uci"),sum),
            .groups = "drop") %>%
  mutate(Stage = "Juveniles") %>%
  mutate(p_chnk = p_chnk * 100) %>%
  rename(perc_chnk = p_chnk) %>%
  filter(perc_chnk %in% c(10, 30, 50)) %>%
  ggplot(aes(x = perc_diet,y = N, group=as.factor(perc_chnk), color=as.factor(perc_chnk))) +
  geom_point(size = 2) + geom_line(size = 1.05)+
  scale_y_continuous(labels = scales::comma) +
  scale_x_continuous(breaks = seq(0, 100, by = 10)) +
  scale_color_manual(name="Proportion Chinook", values=c("lightsteelblue","steelblue3","navyblue"))+
  theme(axis.text.y = element_text(size = 11,
                                   color = "black"),
        axis.text.x = element_text(size = 11,
                                    color = "black"),
        strip.text.y = element_text(size = 11,
                                    color = "black"),
        legend.position = c(.15, .85),legend.background = element_blank(),
        legend.key.size = unit(.5, "cm"),legend.box = 'horizontal') +
  labs(y = "Estimated Chinook Consumed", x="Percent Fish in Pikeminnow Diet")

impact_p

# impact_df %>%
#   mutate(stage = "Juv. Emigrant") %>%
#   select(stage,
#          season,
#          perc_diet,
#          starts_with("smolt")) %>%
#   rename_with(.fn = ~ str_remove(., "smolt_"),
#               .cols = starts_with("smolt")) %>%
#   bind_rows(impact_df %>%
#               mutate(stage = "Adult Equivalent") %>%
#               select(stage,
#                      season,
#                      perc_diet,
#                      starts_with("adult")) %>%
#               rename_with(.fn = ~ str_remove(., "adult_"),
#                           .cols = starts_with("adult"))) %>%
# ggplot(aes(x = perc_diet,
#            y = N,
#            color = as.factor(perc_diet))) +
# geom_errorbar(aes(ymin = Lci,
#                   ymax = Uci),
#               width = 0.1) +
# geom_point(size = 4) +
# facet_grid(fct_rev(stage) ~ season,
#            scales = "free_y") +
# scale_color_viridis_d(name = "Percent\nFish in Diet") +
# theme(axis.text.x = element_blank(),
#       legend.position = "bottom",
#       axis.title.x = element_blank(),
#       axis.ticks.x = element_blank(),
#       axis.text.y = element_text(size = 11,
#                                  color = "black"),
#       strip.text.x = element_text(size = 11,
#                                   color = "black"),
#       strip.text.y = element_text(size = 11,
#                                   color = "black")) +
# labs(y = "Number Chinook Consumed")

```

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()

```

\newpage

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())

```
