---
title: "Northern Pikeminnow Predation on Juvenile Chinook Salmon and Potential Impacts to Local Populations"
author:
  - Richard A. Carmichael:
      email: Richard.Carmichael@merck.com
      institute: [biomark]
      correspondence: true
  - Nicholas J. Porter:
      email: Nicholas.Porter@merck.com
      institute: [biomark]
      correspondence: false
  - Kevin E. See:
      email: Kevin.See@dfw.wa.gov
      institute: [biomark, wdfw]
      correspondence: false
  - Michael S. Hall:
      email: Mike.Hall1@merck.com
      institute: [biomark]
      correspondence: false
  - Tara E. Blackman:
      email: tara.blackman@mthoodenvironmental.com
      institute: [mhe]
      correspondence: false
  - Michael W. Ackerman:
      email: mike.ackerman@mthoodenvironmental.com
      institute: [biomark, mhe]
      correspondence: false
institute:
  - biomark: Biomark, Inc., 705 South 8th Street, Boise, Idaho, 83702, USA
  - wdfw: Washington Department of Fish and Wildife, Under A Bridge, Seattle, Washington, 00000, USA
  - mhe: Mount Hood Environmental, PO Box 4282, McCall, Idaho, 83638, USA
date: "`r format(Sys.time(), '%d %B, %Y')`"
always_allow_html: true
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      number_sections: FALSE
      toc: no
      always_allow_html: true
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
    bookdown::html_document2:
      fig_caption: yes
      number_sections: FALSE
      toc: no
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua      
fontsize: 12pt
mainfont: Times New Roman
bibliography: 
- references.bib      # Kevin's library
- AckermanLibrary.bib # Mike's library
csl: "../templates/american-fisheries-society.csl" # Insert path for the bib-style
abstract: |
  Abstract text here. 
keywords: |
  northern pikeminnow; Chinook salmon; predation; mark-recapture; bioenergetics
highlights: |
  These are the highlights. 
---

Keywords: `r rmarkdown::metadata$keywords`

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)

```

```{r load-libraries}
library(tidyverse)
library(magrittr)
library(lubridate)
library(tidytable)
library(janitor)
library(purrr)
library(here)
library(FSA)
library(knitr)
library(kableExtra)
library(stringi)

# format NA values in tables
options(knitr.kable.NA = '-')

# set default theme for figures
theme_set(theme_bw())

# when knitting to Word, use this
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')

if(doc.type == 'docx') {
  options(knitr.table.format = "pandoc")
}

```

\newpage

# Introduction

The Upper Salmon River major population group (MPG) supports eight independent, extant spring/summer Chinook Salmon *Oncorhynchus tshawytscha* populations including Salmon River (above Redfish Lake Creek), Valley Creek, Yankee Fork Salmon River, East Fork Salmon River, Salmon River (mainstem below Redfish Lake Creek), Pahsimeroi River, Lemhi River, and North Fork Salmon River [@NOAA2017]; all of which have become depleted in recent decades. Declines in survival of local juvenile Chinook Salmon have been associated with hydrosystem passage [@Schaller2014], ocean conditions and regional climate [@Welch2021; @Gosselin2021], and changes to the freshwater habitat including removal of beavers, river channel simplification, water withdrawals, and the proliferation of non-native species (e.g., non-native coastal rainbow trout *O. mykiss irideus* and brook trout *Salvelinus fontinalis*) among others [@IdahoOSCTeam2019]. Moreoever, the abundance of returning adults are further impacted by ocean and downriver harvests, poor ocean conditions, and changes to the spawning migration corridor. Each of these factors have contributed, to varying and unknown extents, to reduced adult escapement, the primary metric used to assess population viability. In response to the decline in Chinook Salmon abundance from the myriad human activities and associated habitat degradation, action agencies have attempted to improve juvenile survival and adult spawning conditions by investing in the rehabilitation of tributary ecosystems.

One potentially important, but perhaps under-appreciated source of mortality for Chinook Salmon is predation on emigrating juveniles by piscivorous fishes, including both native and non-native species. Dams and reservoirs in the Columbia River basin are the primary locations associated with high rates of predation on salmonids [@Petersen1994; @Ward1995]. There are generally two mechanisms that explain these high predation zones. First, migration rates of juvenile Chinook Salmon are reduced during reservoir passage [@Venditti2000], thereby increasing the time migrating smolts are vulnerable to predation. Second, reservoirs and downstream tailraces created by dams on the Columbia and Snake rivers have created favorable slow-water habitat for several species of piscivorous fish known to consume juvenile Chinook Salmon including both non-native (e.g., Smallmouth Bass *Micropterus dolomieu*, Walleye *Sander vitreus*) and native (e.g., Northern Pikeminnow *Ptychocheilus oregonensis*) species. In the Lower Granite Reservoir on the Snake River, juvenile Chinook Salmon are common prey items of non-native Smallmouth Bass during some seasons [@Erhardt2018]. And non-native Walleye are considered a potentially important source for juvenile Chinook Salmon mortality in the Snake River[@Widener2021], particularly as their abundance has significantly increased surrounding Snake River dam facilities between 2008 and 2020 related to their preference for slow water habitats.

In addition to non-native species, Northern Pikeminnow are a native, piscivorous fish preferring warm, slow water habitats. Consequently, they too have benefited from dams on the Columbia River and become abundant predators on salmonid outmigrants [@Knutsen1999]. Indeed, Northern Pikeminnow are estimated to consume 8% (16.4 million) of the estimated 200 million juvenile salmonids emigrating through the lower Snake and Columbia rivers, annually [@Beamesderfer1996]. Predation by piscivorous fishes, including Northern Pikeminnow, may have been a factor in the below-average survival of wild Chinook Salmon in 2020 [@Widener2021]. However, there is a dearth of current data on piscivorous predator populations in the Columbia River.

Habitats containing slower water velocities and other attributes that support piscivorous predators are not limited to dams and reservoirs. One such area is the Deadwater Slough in the Salmon River, Idaho which is an unnaturally slow and deep reach of the mainstem river approximately 1.5 kilometers in length and occupying 29.5 acres (Figure \@ref(fig:map)). The slough contains "reservoir-like" conditions which typically favor piscivorous fish predators like Northern Pikeminnow or Smallmouth Bass [@Watkins2015], and further, lacks hydrological and structural features and fish cover (e.g., large wood or substrate, woody debris, bank undercuts) that can provide essential refuge from predation for juvenile fishes. As a result, predation of juvenile Chinook Salmon and other local ESA-listed salmonids (Sockeye Salmon *O. nerka*, redband steelhead *O. mykiss gairdneri*) has been cited as a concern for populations in the Upper Salmon River

Spring/summer Chinook Salmon in the Upper Salmon MPG are stream-type and exhibit two distinct migration tactics; downstream rearing (DSR) and natal reach rearing (NRR) [@Copeland2014]. The DSR migrants leave the natal spawning area as subyearlings between June and november and typically overwinter in downstream, mainstem habitats until the following spring when they emigrate to the ocean as smolts. Alternatively, NRR migrants remain in their natal spawning areas for approximately one year after emergence until emigration to the ocean as smolts. Diversity of migratory tactics provides a mechanism for coping with adverse conditions in freshwater rearing and migration environments and buffers against catastrophic events, thereby increasing population resiliency.

The Deadwater Slough is in a reach of the Salmon River believed to be a historically important overwinter rearing area for DSR emigrants. Moreover, the slough is part of the migratory pathway for not only juvenile Chinook Salmon (both DSR and NRR emigrants), but also for the endangered Snake River Sockeye Salmon population and several population of threatened Snake River steelhead. As such, the main Salmon River has been the target of recent radio telemetry studies to examine the downstream movement, distribution, and (apparent survival) of juvenile salmonid emigrants. @Axel2015 demonstrated decreased rates of emigration and survival for Sockeye Salmon from Redfish Lake during the spring emigration. Further, recent telemetry studies of Chinook salmon emigration during fall and early winter months indicated a decreased transition probability in the reach spanning Deadwater Slough (approximately 10% less than surrounding reaches).

We hypothesize that increased densities of piscivorous predators in the Deadwater Slough may explain the reduced survival (or apparent survival) observed for juvenile Chinook Salmon [@Ackerman2018] and Sockeye Salmon [@Axel2015]. In this study, we estimated the abundance of a piscivorous fish predator population in the Deadwater Slough and their potential impacts to juvenile salmon emigrants, focusing on DSR and NRR Chinook Salmon. Our objectives for the study were three-fold:

1. Estimate the abundance (or relative abundance) of potential predators in the Deadwater Slough during the peaks of fall (DSR) and spring (NRR) juvenile emigrations.
2. Document predation on juvenile Chinook Salmon during the emigration periods using gastric lavage.
3. Use a bioenergetics approach to estimate the total consumption of juvenile DSR and NRR Chinook salmon during defined emigration periods.

We follow with a discussion of the various assumptions that went into the mark-recapture and bioenergetics models and how violations of some assumptions may affect overall results and inferences from the study. We also consider how consumption of juvenile Chinook Salmon by predators at Deadwater Slough might impact adult returns, hindering recovery of populations in the Upper Salmon River MPG.


# Methods

## Study Site

The Deadwater Slough is located approximately 6 kms downstream from the town of North Fork, Idaho (Figure \@ref(fig:map)). The downstream end of the slough is located at the confluence of Dump Creek and the Salmon River. Around 1897, the failure of a small mining diversion reservoir in the Dump Creek drainage resulted in an erosion event that deposited substantial amounts of sediment at the confluence of the Salmon River, forming an alluvial fan and creating an unnaturally slow and deep section of the river resembling a small reservoir. 


## Abundance of Piscivorous Fishes

Our goal was to estimate the abundance of potentially piscivorous predators in the Deadwater Slough using a mark-recapture approach both during the fall and spring near the peaks of the juvenile Chinook Salmon DSR and NRR emigrations, respectively. The initial intent was to sample during fall 2019 and spring 2020 to estimate predator abundances during the emigration of the 2018 brood year. However, due to logistical concerns during the onset of the Covid-19 pandemic, the spring 2020 sampling event was delayed until fall 2020. Although this provided the benefit of an additional abundance estimates during the DSR emigration, estimates during the NRR emigration were still lacking, and so an additional sampling event was added for spring 2021. The study design was such that both the fall 2019 and fall 2020 sampling efforts included both a "mark week" and "recapture week" intended for mark-recapture models. However, due to budget constraints the spring 2021 effort only included a single "mark week"; instead, we calculated the catch-per-unit-effort (CPUE; fish per hour) for the spring 2021 effort for comparison to the fall efforts. In the end, sampling dates were as follows: fall 2019 (mark = November 12-14; recapture = November 19-21), fall 2020 (mark = October 20-23; recapture = October 27-30); spring 2021 (mark = May 18-21). The recapture events were held just one week following the mark events to reduce opportunity for immigration/emigration of predators between events i.e., to avoid violation of a closed population for mark-recapture models.

We attempted multiple capture methods during the first year including raft electrofishing, fyke netting, snorkeling, and angling to reduce selectivity, both for species and size classes. Unfortunately, some of the methods proved ineffective. For example, fish were able to elude the electrical field of the raft electrofisher due to 1) the lack of flow in Deadwater Slough and 2) we lacked the appropriate motor to effectively “chase” fish given the lack of flow. Snorkeling was ineffective due to the high turbidity of the mainstem Salmon River and Deadwater Slough. And due to debris floating in the water column, there were concerns with fyke nets being pulled from their anchored locations and becoming entangled. Additionally, there were concerns with raft electrofishers and fyke nets incidentally capturing adult steelhead that are present in the mainstem Salmon River during fall and spring. In the end, angling proved to be the most effective method for capturing piscivorous predators while minimizing potential impacts to steelhead but recognizing that angling can have both species and size selectivity (bias). From here on, our focus was on fish captured by angling, unless otherwise noted.

Our study relied heavily on volunteer anglers who were allowed to fish anywhere within Deadwater Slough; periodically or upon filling a livewell anglers would boat or hike their catch to a processing station located at the boat ramp approximately 500 m downstream from the top of the slough. For each fish, processors would record the date of capture, species, total length (TL; mm), and whether the fish was previously marked. If not previously marked, each fish was provided a physical mark (e.g., hole punch of lower caudal, upper caudal, left pelvic, right pelvic) and marks were unique for each marking day. We also recorded whether marked individuals were released back to be captured again. For release, processors attempted to distribute released individuals throughout Deadwater Slough to facilitate mixing back into the population. We also recorded the crew (person or combination of persons) that captured each fish and the start and end times for each crew were recorded to estimate total effort.    

```{r cmr-effort-data}
raw_df = readxl::read_excel(here("analysis/data/raw_data/Deadwater_predation_mark_recapture_11.09.21.xlsx")) %>%
  clean_names() %>%
  mutate(across(date,
                ymd)) %>%
  mutate(across(c(start_time, end_time),
                ~ ymd_hms(paste(year(date), month(date), day(date), hour(.), minute(.), second(.))))) %>%
  # split into sampling periods
  mutate(event_name = if_else(month(date) > 8,
                              paste("Fall", year(date), sep = "_"),
                              paste("Spring", year(date), sep = "_")))

# focus on pikeminnow
cmr_df = raw_df %>%
  filter(count > 0) %>%
  # pull out only Northern Pikeminnow
  filter(species == "Northern Pikeminnow") %>%
  mutate(mark_release = if_else(fish_status == "Live" &
                                  capture_type == "Mark",
                                T, F),
         recap = if_else(capture_type == "Recapture",
                         T, F))

effort_df = raw_df %>%
  select(event_name,
         site,
         date,
         crew,
         crew_count,
         method,
         equipment,
         start_time:total_effort,
         total_day_effort) %>%
  distinct() %>%
  mutate(across(total_effort,
                ~ . * crew_count)) %>%
  group_by(event_name,
           date) %>%
  summarise(across(c(total_effort,
                     crew_count),
                   sum),
            .groups = "drop")

cpue_df = effort_df %>%
  # add how many pikeminnow were caught
  left_join(cmr_df %>%
              group_by(event_name, species, date) %>%
              summarise(n_fish = n(),
                        n_large_fish = sum(length>=228,
                                           na.rm = T),
                        .groups = "drop")) %>%
  # calculate CPUE a few different ways
  mutate(cpue = n_fish / total_effort,
         cpue_per_day = n_fish / crew_count,
         cpue_large_per_day = n_large_fish / crew_count)

```

```{r lincoln-petersen-estimator}
# using Lincoln-Petersen model, combining first 4 and last four days
# define mark and recapture periods
cap_periods = tibble(event_name = "Fall_2019",
                     cap_period = "Mark",
                     int = interval(start = ymd('20191112'),
                                    end = ymd('20191114'))) %>%
  bind_rows(tibble(event_name = "Fall_2019",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20191119'),
                                  end = ymd('20191121')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Mark",
                   int = interval(start = ymd('20201020'),
                                  end = ymd('20201023')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20201027'),
                                  end = ymd('20201030'))))

cmr_df$cap_period = NA_character_
for(i in 1:nrow(cap_periods)) {
  my_int = cap_periods$int[i]
  index = which(cmr_df$date %within% my_int)
  cmr_df$cap_period[index] = cap_periods$cap_period[i]
}


LP_mod = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species) %>%
  summarise(M = sum(cap_period == "Mark" & fish_status == "Live", na.rm = T),
            n = sum(cap_period == "Recapture"),
            m = sum(cap_period == "Recapture" & capture_type == "Recapture", na.rm = T),
            .groups = "drop") %>%
  nest(data = -c(event_name, species)) %>%
  crossing(model = c("Petersen",
                     "Chapman")) %>%
  mutate(mr_model = map2(data,
                       model,
                      .f = function(x, y) {
                        with(x,
                             mrClosed(M = M,
                                      n = n,
                                      m = m,
                                      method = y))
                      }),
         N_summ = map(mr_model,
                      .f = summary,
                      incl.SE = T),
         CI = map(mr_model,
                  .f = confint)) %>%
  mutate(N = map_dbl(N_summ,
                     .f = function(x) x[1]),
         SE = map_dbl(N_summ,
                      .f = function(x) x[2]),
         Lci = map_dbl(CI,
                         .f = function(x) x[1]),
         Uci = map_dbl(CI,
                         .f = function(x) x[2])) %>%
  select(-N_summ, -CI)

```

```{r schnabel-estimator, eval = T}
# using Schnabel and Schumacher-Eschmeyer estimators
N_mods = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species, date) %>%
  summarise(n = n(),
            m = sum(capture_type == "Recapture", na.rm = T),
            u = sum(capture_type == "Mark" | is.na(capture_type)),
            R = sum(fish_status == "Live", na.rm = T),
            .groups = "drop") %>%
  group_by(event_name, species) %>%
  mutate(M = lag(R - m),
         M = replace_na(M, 0),
         M = cumsum(M)) %>%
  nest() %>%
  crossing(model = c("Schnabel",
                     "SchumacherEschmeyer")) %>%
  mutate(mr_model = map2(data,
                         model,
                         .f = function(x, y) {
                           with(x,
                                mrClosed(n = n,
                                         m = m,
                                         R = R,
                                         method = y,
                                         chapman.mod = TRUE))
                         }),
         N = map_dbl(mr_model,
                     .f = summary),
         CI = map(mr_model,
                  .f = confint),
         Lci = map_dbl(CI,
                       .f = function(x) x[1]), 
         Uci = map_dbl(CI,
                       .f = function(x) x[2])) %>%
  ungroup() %>%
  select(-CI)

```

```{r abund-est}
all_est = LP_mod %>%
  select(event_name, species, model, N:Uci) %>%
  bind_rows(N_mods %>%
             select(event_name, species, model, N:Uci)) %>%
  mutate(range = Uci - Lci,
         prop_range = range / N) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  mutate(model = fct_recode(model,
                            "Schumacher-Eschmeyer" = "SchumacherEschmeyer")) %>%
  arrange(event_name, model)

```

```{r spring-abund}
total_cpue = cpue_df %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  group_by(species, event_name) %>%
  summarise(across(c(total_effort, 
                     n_fish,
                     n_large_fish,
                     angler_days = crew_count),
                   sum),
            .groups = "drop") %>%
  mutate(across(total_effort,
                ~ . / 60)) %>%
  mutate(cpue = n_fish / total_effort,
         cpue_per_day = n_fish / angler_days,
         cpue_large_per_day = n_large_fish / angler_days)


spring_abund = all_est %>%
  select(-range, -prop_range) %>%
  inner_join(total_cpue,
             by = c("event_name", "species")) %>%
  select(species, model, 
         model_event = event_name,
         N_F = N, 
         Lci_F = Lci,
         Uci_F = Uci,
         cpue_F = cpue) %>%
  full_join(total_cpue %>%
              filter(str_detect(event_name, "Spring")) %>%
              select(species,
                     cpue_S = cpue),
            by = "species") %>%
  mutate(N_S = N_F * (cpue_S / cpue_F),
         Lci_S = Lci_F * (cpue_S / cpue_F),
         Uci_S = Uci_F * (cpue_S / cpue_F))


```


We used several mark-recapture abundance estimators that each rely on meeting several assumptions:

1. The population in closed (no immigration, emigration, births or deaths during the sampling period)
1. Marking a fish does not affect its chances of being caught
1. No loss of marks
1. No marks are missed or mistaken
1. All fish have the same chance of being caught in the second (and subsequent) sample(s)

The estimators fell into two broad categories: single census and multiple census. For the single census estimators, we treated the first week of sampling as the mark event, and the following (second) week as the recapture event, pooling data within each of those two weeks. Alternatively, the multiple census estimators treat each day as a survey, and use information about the total marked fish from all previous surveys to infer the total abundance.

The Lincoln-Peterson estimator, a single-census estimator, is below, where $M$ is the number of fish marked and returned to the population, the $n$ is the number of fish caught in the second/recapture event, and $m$ is the number of marked fish in the second sample.

$$
\hat{N} = \frac{(M)(n)}{(m)}
$$

The Lincoln-Petersen estimator can be biased with small samples, so we also investigated the Chapman-modified Lincoln-Petersen estimator:

$$
\hat{N} = \frac{(M + 1)(n + 1)}{(m + 1)} - 1
$$

For a multiple census estimator we first considered the Schnabel estimator where the $M$, $n$ and $m$ are indexed by the sampling occassion, $i$. In our case, the sampling occassions are defined as each day of sampling. The Schnabel estimator does not have an associated standard error; however, the 90% confidence intervals can be calculated. The Schnabel estimator is essentially a weighted average of a series of Lincoln-Peterson estimators (with a Chapman modfication). The Schnabel estimator is shown here:

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M_i}{\left(\sum\limits_{i = 1}^k m_i \right) + 1}
$$

Finally, we explored one additional estimator for multiple census surveys, called the Schumacher-Eschmeyer estimator, which is based on minimizing the weighted sum of squares between the proportion of marked individuals in the sample and the unknown proportion of marked individuals in the population. The Schumacher-Eschmeyer estimator is as follows:

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M^2_i}{\sum\limits_{i = 1}^k m_i M_i}
$$

<!-- Here, let's attempt to use the ratio of CPUEs between the fall and spring to estimate abundance in the spring. We'll assume equal capture probability in both periods. We recognize that capture probability is probably smaller in the spring (higher flows, more turbidity, perhaps cooler?), so we think our estimate is a conservative one (i.e., the truth is probably higher). Then we'll re-do the bioenergetics model to explore how many NFF smolts might be consumed in the spring -->

The mark-recapture estimators allowed us to estimate the abundance of Northern Pikeminnow during the fall 2019 and fall 2020 sampling periods. However, due to logistical constraints, we were only able to sample during a single week in spring 2021 and released fish were released unmarked. Instead, to estimate the abundance of Northern Pikeminnow in the spring, we used the ratio of total CPUE in the fall sampling events to the total CPUE in the spring sampling event, and multiplied that ratio by the abundance of Northern Pikeminnow in the fall. This assumes the same capture probability in the fall as in the spring. If that assumption is not true and capture probability did differ, we believe that the capture probability to be lower in the spring due to higher flows, which would lead to our spring abundance estimate to be biased low. Therefore, we consider this a conservative estimate of the number of Northern Pikeminnow present in the Deadwater Slough during the spring emigration of NRR Chinook Salmon. 

Lastly, we calculated the proportional stock density (PSD) for Northern Pikeminnow captured during field efforts, which is a measure of species size structure. PSD is a ratio, typically expressed as a percentage, between the number of "quality-sized" individuals or larger individuals and "stock-sized" individuals. Stock and quality size definitions vary by species. PSD is expressed as:

$$
PSD_{i} = 100 * \frac{FQ_{i}}{FS_{i}}
$$

where $FQ_{i}$ is the number of fish $\ge$ quality-length for species $i$, and $FS_{i}$ is the number of fish $\ge$ stock-length for species $i$. We calculated the PSD for Northern Pikeminnow in our study using 300 mm TL for stock-size and 400 mm TL for quality-size.


## Predation On Juvenile Chinook Salmon

Gastric lavage [@Foster1977] was used to examine the stomach contents of Northern Pikeminnow for the presence of juvenile Chinook Salmon, other fishes (e.g., juvenile steelhead, juvenile Sockeye Salmon, Redside Shiner, etc.), and non-targets (e.g., macroinvertebrates, organic matter, etc.). Stomach contents were preserved with 99% isopropyl alcohol in whirl-paks and analyzed in a laboratory. For each sample, wet weight (grams) was recorded for the combined stomach content and for the fish content. Fish and fish remnants were identified to the lowest taxonomic unit, when possible, or were categorized as unknown. A subset of Northern Pikeminnow captures were euthanized for dissection after gastric lavage to validate the efficacy of the methodology.

```{r gastric-data}
gastric_df = raw_df %>%
  filter(species == "Northern Pikeminnow") %>%
  mutate(fish_or_parts = case_when(stri_detect_fixed(stomach_contents, "Fish") ~ "Fish or Fish Parts",
                                   stri_detect_fixed(stomach_contents, "Empty") ~"Empty",
                                   stri_detect_fixed(comments, "Whole scuplin") ~ "Fish or Fish Parts",
                                   stri_detect_fixed(stomach_contents, "Whitefish") ~ "Fish or Fish Parts",
                                   TRUE ~ "Other")) %>%
  drop_na(length) %>%
  mutate(non_fish_wt = stomach_contents_weight - fish_content_weight) %>%
  dplyr::select(date, method, length, lavage_id, stomach_contents, comments, fish_or_parts, stomach_contents_weight, non_fish_wt, fish_content_weight) %>%
  filter(!stomach_contents %in% c("Lost sample CG27-001", "Did Not Lavage")) %>%
  drop_na(stomach_contents)

# hungry_fish_df = gastric_df %>%
#   filter(fish_or_parts == "Fish or Fish Parts") %>%
#   mutate(fish = case_when(stri_detect_fixed(stomach_contents, "Shiner") ~ "Redside Shiner",
#                           stri_detect_fixed(stomach_contents, "Whitefish") ~ "Mountain Whitefish",
#                           stri_detect_fixed(stomach_contents, "scuplin") ~ "Sculpin",
#                           stri_detect_fixed(stomach_contents, "Chinook") ~ "Chinook",
#                           stri_detect_fixed(comments, "whitefish") ~ "Mountin Whitefish",
#                           stri_detect_fixed(comments, "scuplin") ~ "Sculpin",
#                           stri_detect_fixed(comments, "chinook") ~ "Chinook",
#                           TRUE ~ "Other"))
  
```

```{r gastric-summ}
gastric_df$npm_50 = lencat(gastric_df$length, w = 50)

psd_df = gastric_df %>%
  group_by(npm_50) %>%
  summarize(n = n())

gastric_df2 = gastric_df %>%
  drop_na(stomach_contents_weight) %>%
  group_by(fish_or_parts)

stmch_ctgry_summ = gastric_df2 %>%
  count()

stmch_wt_summ = gastric_df2 %>%
  summarise(sum(stomach_contents_weight))

non_fish_wt_summ = gastric_df2 %>%
  summarise(sum(non_fish_wt))

fish_wt_summ = gastric_df2 %>%
  summarise(sum(fish_content_weight))

```


## Bioenergetics

```{r shoup-temp-data}
shoup_temp_df = read_tsv(here("analysis/data/raw_data/USGS_13307000_Salmon_River_Nr_Shoup.txt"),
                   comment = "#") %>%
  rename(discharge_cfs = `47768_00060`,
         discharge_cfs_cd = `47768_00060_cd`,
         gage_ht_ft = `47769_00065`,
         gage_ht_ft_cd = `47769_00065_cd`,
         water_temp_c = `47773_00010`,
         water_temp_c_cd = `47773_00010_cd`)

```

```{r read-bio-outputs}
# full year, no growth
full_yr_no_growth = read_csv(here("analysis/data/raw_data/2020 Bioenergetics 1 year.csv")) %>%
  clean_names() %>%
  mutate(date = as.Date(date, format = "%m/%d/%y")) %>%
  mutate(cum_cons_fish_g = cumsum(cons_fish_g)) %>%
  mutate(month = month(date))

# full year, 10% growth
full_yr_10p_growth = read_csv(here("analysis/data/raw_data/2020 Bioenergetics 1 year 10% growth.csv")) %>%
  clean_names() %>%
  mutate(date = as.Date(date, format = "%m/%d/%y")) %>%
  mutate(cum_cons_fish_g = cumsum(cons_fish_g)) %>%
  mutate(month = month(date))

# an alternative model
alternative_mod = read_csv(here("analysis/data/raw_data/Bioenergetics 32 fish 68 inverts.csv")) %>%
  clean_names() %>%
  mutate(date = as.Date(date, format = "%m/%d/%y")) %>%
  mutate(cum_cons_fish_g = cumsum(cons_fish_g)) %>%
  mutate(month = month(date))

# Fall emigration period (9/1 - 11/17), no growth
fall_only_no_growth = read_csv(here("analysis/data/raw_data/78_day_bioenergetics.csv")) %>%
  clean_names() %>%
  mutate(date = as.Date(date, format = "%m/%d/%y")) %>%
  mutate(cum_cons_fish_g = cumsum(cons_fish_g)) %>%
  mutate(month = month(date))

```

To estimate the consumption of juvenile Chinook Salmon outmigrants by Northern Pikeminnow in the Deadwater Slough, we used the Fish Bioenergetics v4.0 applicatioon developed by @Deslauriers2017. The daily rate of consumption in grams for an individual Northern Pikeminnow was based on predator and prey energy densities, predator start and end weights, and water temperatures. Predator energy density for Northern Pikeminnow was fixed at 6,703 Joules(J)/g [@Deslauriers2017]. Prey energy densities were fixed at 21,500 J/g for juvenile Chinook salmon based on estimate from @Moss2016. To calculate the average predator start weight, we converted the average length of Northern Pikeminnow captured during our study to a weight using a weight-length formula for Northern Pikeminnow [@Parker1995] from the FSA package [@Ogle2021]. Continuous water temperature data from 2019 were used in two alternative models, on using the baseline start and end weights and the second with a 10% increase in average end weight of Northern Pikeminnow.

We ran three bioenergetic models for this study. For the first model, we chose a 78-day period from September 1 through November 17 when DSR emigrants are known to enter the mainstem Salmon River from natal tributaries (e.g., Lemhi River) and begin their downstream migration. During this time, water temperatures exceed the range (0-7$^\circ$C) that would illicit concealment behavior or torpor from juvenile Chinook Salmon. This model assumed no growth for Northern Pikeminnow. The second model was run for one-year and assumed no growth for Northern Pikeminnow. The assumption of no growth for pikeminnow was included to show what may be occurring if the population of Northern Pikeminnow is stable. If growth of the population is occurring, the alternative model shows how an increase of 10% body weight changes the estimates of consumption over a full year period. To estimate the number of possible Chinook Salmon that could be consumed, we assumed a weight of 12 g per individual Chinook Salmon. This weight was an average from juvenile Chinook Salmon emigrating past six rotary screw traps operating in the Upper Salmon above Deadwater Slough including traps in the Lemhi, Pahsimeroi, and North Fork Salmon rivers and one trap operating near the Sawtooth hatchery.

<!--
A few things that need to be clarified in this section:
* Why were the dates Sept 1 - Nov 17 chosen? They make sense, but we should include our rationale
* Where did the temperature data come from? Hobo? Stream gauge? The methods say temperature data from 2019 was used, but the results seem to use 2020? 
* Why does it look like we only ran it for dates in 2020? Is that the only year we had temperature data for? Would the results look different if we used temperature data from a different year?
* The lengths of pikeminnow: did we only use pikeminnow we caught in the fall to get average length? Is there a difference in lengths between 2019 and 2020? 
* There needs to be more explanation of the inverts vs. fish. What proportion went to each and why? Did it change through time? Based on literature at all? 
* Where is the data that was used to get a weight of 12 g for Chinook emigrant? Was that for Chinook presmolts, or a combination of smolts and presmolts? If the latter, can we filter it to look at the average weight for presmolts only? And maybe smolts only for a different analysis? 
* Could we run a similar model for the spring emigration period? Figure out the dates, look at lengths of pikeminnow from the spring, convert to average weight, use average size of Chinook smolts (not presmolts) from all the Upper Salmon traps? Kevin can work on converting the spring catch into some kind of estimate of pikeminnow at Deadwater in the spring
-->


# Results

## Abundance of Piscivorous Fishes

Abundance estimates for Northern Pikeminnow in the Deadwater Slough during the fall 2019 and 2020 sampling events ranges from `r prettyNum(min(all_est$N), big.mark = ",")` to `r prettyNum(max(all_est$N), big.mark = ",")`. The multiple census estimators were consistently larger than the single census estimators, although the size of the 95% confidence intervals were more varied (Figure \@ref(fig:abund-fig)). <!-- Need to fill in these fall results more -->

<!-- Add spring abundance results here -->

The PSD for Northern Pikeminnow in our study and across all three years was 42.3%. In other words, 42.3% of captured fish were over the quality size classification of 400 mm TL, demonstrating that a high percentage of Northern Pikeminnow within Deadwater Slough are above average size classes defined for the species <!-- Is this useful? And if useful, does it make sense to calculate PSD separately for the fall and spring periods? I'd expect PSD to vary between seasons. -->

<!-- Include some results for density e.g., pikeminnow per 100 linear meters or pikeminnow per acre. -->


## Predation On Juvenile Chinook Salmon

During 2019, 660 Northern Pikeminnow were gastric lavaged. Of those fish, we observed 603 individuals with empty stomachs, and 57 individuals with stomach contents. Twelve of the samples contained fish remnants including a single Mountain Whitefish and two Redside Shiners. During the 2020 season, 805 Northern Pikeminnow were gastric lavaged comprised of 613 individuals with empty stomachs and 188 individuals with stomach contents. Twenty-three individuals had fish remnants in their stomach contents including ten with unidentifiable remnants, six Redside Shiners, four suckers, two sculpin, and one juvenile Chinook Salmon. In 2021, we collected stomach contents from 105 Northern Pikeminnow with 98 containing non-fish prey items and observed seven containing fish remnants. 

<!--- Need to add Nick's gastric lavage table here -->


## Bioenergetics

Over the fall time period a single Northern Pikeminnow is modeled to eat 61 g of fish. For the estimated population of ***xx,xxx***, then ***xxx,xxx*** g of fish are being eaten each fall during the migration of juvenile Chinook Salmon. Therefore, Northern Pikeminnow in the Deadwater Slough can potentially consume ***xx,xxx*** juvenile Chinook Salmon as a discrete population.

Over an entire year, we estimate that a single Northern Pikeminnow will eat 283 g of fish and 613 g of other food types.

<!--
* Water Temperature measurements.
    *	Hobo tidbit placed at site. 
    *	Calculated daily average water temperature for 365 days of the year.
*	Water temperature plot for the 365 average.
*	Bioenergetics results. Total mass consumed over a 365 day period. Plot of daily consumption with day of year on x and mass on y.
-->


# Discussion

We estimated the population size of Northern Pikeminnow in the Deadwater Slough to be greater than ***xx,xxx*** during the fall emigration period for DSR Chinook Salmon. That estimate translates to a density of ***xxx*** Northern Pikeminnow per 100 m or ***xxx*** per 100 m^2^ which is ***similar/more/less*** than estimates from elsewhere in the Columbia River ***(citation)*** where substantial Northern Pikeminnow predation impacts on salmonids have led to bounty programs aimed at reducing Northern Pikeminno abundance. The population size of Northern Pikeminnow was not directly estimated during the spring NRR Chinook salmon emigration period however, the relative abundance measured at CPUE was comparable to the fall sampling periods ***(update statement later)***. The population of Northern Pikeminnow in Deadwater Slough was estimated to consume between ***xx,xxx*** and ***xx,xxx*** juvenile Chinook Salmon during the ***x*** sampling periods and result in an estimated reduction of returning adults between ***xxx*** and ***x,xxx***. We suggest that the habitat modifications that created the Deadwater Slough have resulted in favorable conditions for Northern Pikeminnow, including improved conditions for predation upon juvenile Chinook Salmon ***(add detail here)***. Therefore, predation by Northern Pikeminnow in the Deadwater Slough likely has a consequential impact on ESA-listed Chinook Salmon populations in the Upper Salmon River MPG.


## Mark-Recapture Model

<!--
Re-hash out our assumptions? What assumptions were most likely violated e.g., the closed population assumption? If we assumed an open population with varying immigration/emigration rates how might that affect our estimate? In the end, how good do we think our estimate is and is the bottom-line that we belive there still to be a shit-ton of pikeminnow even if our assumptions were violated?
-->


## Gastric Lavage

The majority of fish collected during this study received gastric lavage, including some non-predatory species. To validate the efficacy of this method, we euthanized nine Northern Pikeminnow after gastric lavage was completed and removed the remaining stomach contents via dissection. Our results support previous findings that gastric lavage effectively removes stomach contents (@Lott2020). Additionally, we found that the fish captured in net-traps had a similar proportion of stomach content samples. of those, 1,214 (76.2%) were completely empty, 345 (21.6%) had stomach contents, and 35 (2.2%) contained fish remnants. We were successfully able to identify Redside Shiners, a Largescale Sucker, sculpin, Mountain Whitefish, and one juvenile Chinook Salmon in the stomach contents. However, decomposition from digestion rendered most stomach contents unidentifiable.

<!--
Concerns with gastric lavage. We only observed juvenile Chinook salmon (and/or other fishes) in a very small number of stomach contents. However, we don't necessarily believe that to mean that pikeminnow in Deadwater Slough rarely consume juvenile Chinook salmon. Are there other cases where gastric lavage failed to document predation? How soon after consumption do you need to take a sample? So instead, we made some assumptions about the proportion of a pikeminnows diet consisting of Chinook salmon.
-->


## Bioenergetics

What assumptions did we make during the bioenergetics assessment? And how might violations of those assumptions change our estimate of the number of juvenile Chinook salmon consumed and resulting impacts to adult returns?


## Impacts to Adult Returns

```{r}
# pull in SAR numbers
sar = read_csv(here("analysis/data/raw_data", 
                    "WSSCh_sar_4See.csv")) %>%
  summarise(across(c(medsar, sdsar),
                   median)) %>%
  summarise(across(c(medsar, sdsar),
               ~ . / 100))

adult_impact = fall_only_no_growth %>%
  filter(cum_cons_fish_g == max(cum_cons_fish_g)) %>%
  select(cum_cons_fish_g) %>%
  mutate(n_chnk_smolts = cum_cons_fish_g / 12) %>%
  bind_cols(all_est %>%
              select(event_name, 
                     model,
                     N,
                     Lci,
                     Uci)) %>%
  mutate(across(c(smolt_N = N, 
                  smolt_Lci = Lci, 
                  smolt_Uci = Uci),
                ~ . * n_chnk_smolts)) %>%
  bind_cols(sar) %>%
  mutate(adult_N = smolt_N * medsar,
         adult_Lci = smolt_Lci * qnorm(0.025, medsar, sdsar),
         adult_Uci = smolt_Uci * qnorm(0.975, medsar, sdsar))

```

To estimate the number of possible Chinook salmon that could be consumed, we divided the cumulative fish consumption in grams for an individual pikeminnow by the average weight of a Chinook emigrant to come up with a presmolt equivalency and then multiplied this by our abundance estimate of northern pikeminnow in Deadwater Slough, resulting in an estimate of the equivalent total number of Chinook salmon presmolts consumed. Finally, we estimated the number of additional adult Chinook salmon that might be expected to return to Lower Granite Dam if predation in the Deadwater Slough reach was reduced or eliminated. We multiplied the total estimated consumed juvenile Chinook salmon by an estimate of Granite-to-Granite SARs [@McCann2019].

<!-- 
After making some assumptions (e.g., on SARs) attempt to estimate how results from objective #3 could translate into impacts on adult returns (via a thought experiment or simulation approach)

Currently only using one bioenergetics model run. Could incorporate more bioenergetics models, but if so then maybe consider focusing on a single abundance estimator (e.g. Schnabel) to avoid too many combinations in the results 
-->

Again, what assumptions did we make here and how might violations of those assumptions change our estimate of impacts to adult returns.

*	SAR results. Maybe a plot of multiple scenarios depending on gastric lavage results? And pop estimates if they vary in time.


## Avian Predation

Although not formally assessed in this study, avian predators including Great Blue Herons *Ardea herodias* and Bald Eagles *Haliaeetus leucocephalus* are another potential source of mortality for juvenile salmon in the Deadwater Slough. The Deadwater Slough is recognized as an important bird watching and nesting area due to the associated riparian and backwater habitats [(Deadwater Slough - Audubon Important Bird Areas)](https://www.audubon.org/important-bird-areas/deadwater-slough#). Several piscivorous bird species have been documented using the Deadwater Slough that include the Common *Mergus merganser* and Hooded *Lophodytes cucullatus* mergansers, the Great Blue Heron, the Double-crested Cormorant *Phalacrocorax auritus*, and the Belted Kingfisher *Megaceryle alcyon* [@eBird2021]. During the initial sampling event in 2019, a two-person crew walked the entire reach and surrounding and upstream areas scanning for passive integrated transponder (PIT) tags. During that informal survey, nine PIT tags were recovered near active bird nests or in an upstream anastomizing reach where herons and eagles are prevalent, suggesting that mortality may have been a result of avian predation. The PIT tag histories in [PTAGIS](https://www.ptagis.org/) indicate these tags were implanted into a combination of juvenile Chinook Salmon (3), Sockeye Salmon (3), and steelhead (3). Avian predation contributes a major component of the total mortality for yearling Chinook Salmon in some locations in the lower Snake River and Columbia River, particularly at hydroelectric dams and within reservoirs [@Evans2012; -@Evans2016]; however, we did not observe large colonies of piscivorous birds within the study area. Although there is documentation of individual Double-crested Cormorants [@eBird2021] at the Deadwater Slough, the site is not within their breeding range, rather, it is part of a migration corridor. Given the current avian species known to occupy Deadwater Slough, it is unlikely that avian predation on juvenile salmonids is comparable to elsewhere in the Columbia River basin with large piscivorous bird colonies. Nevertheless, we hypothesize that the reservoir-like conditions at the Deadwater Slough may increase the probability of avian predation on juvenile Chinook Salmon from the many piscivorous birds known to use the site. Future estimates of predation would benefit from consideration of the contribution of piscivorous avian predators.


## Management Implications

At least five of the eight populations in the Upper Salmon MPG must meet criteria set forth by @McElhany2000 and @ICTRT2007 for the MPG to be considered viable and for the recovery of the Snake River Evolutionary Significant Unit. Populations with the ESU have substantial cultural value, support downriver mainstem Snake and Columbia River commercial and subsistence fisheries, and support local fisheries and economies in years with sufficient abundance.

We estimated that consumption of juvenile Chinook Salmon by Northern Pikeminnow in the Deadwater Slough potentially reduces annual adult returns by ***xxx - x,xxx*** (perhaps express as percent, too) to upriver populations. Presumably, that reduction in adult returns impacts both the ESA-listed natural populations in the Upper Salmon River MPG and two hatchery populations in the Upper Salmon, Pahsimeroi and Sawtooth hatcheries, which provide for recrational fishing opportunities. Consequently, reducing juvenile Chinook Salmon predation mortalities at Deadwater Slough can potentially benefit multiple upriver natural and hatchery populations upriver. Because the Deadwater Slough is part of the migratory pathway for emigrating salmonids, including for multiple species and populations, the impact of that benefit would likely be higher than tributary habitat rehabilitation actions, which typically benefit a single population. Moreover, the deepened, slack water conditions that favor northern pikeminnow at Deadwater Slough are indirectly the result of manmade activities i.e., the failure of a manmade mining reservoir dam. Given these reasons, it seems that Deadwater Slough could be a candidate for management or restoration actions to benefit local Chinook Salmon populations.

We see two potential management actions: 1) removing the Dump Creek delta to restore flow and 2) a local northern pikeminnow bounty program to encourage harvest of northern pikeminnow in Deadwater Slough. 

<!--
Is there anything in the literature that discusses habitat preferences for pike minnow? If we speed up velocities and add some cover potentially pike minnow predation success will be lowered. Will these fish just move elsewhere? 
-->

## Conclusions

*	We have also presented a novel modeling framework for estimating predation on native, critically endangered anadromous species which can be applied to other areas of interest. John day? Others?
*	The end. 


# Acknowledgements

<!-- Please feel free to add others that I missed or improve -->

The authors extent much appreciation to the many volunteers who assisted with field efforts including collaborators from Bureau of Reclamation, Idaho Department of Fish and Game, and Lemhi Regional Land Trust, among others. This manuscript benefited from reviews and contributions from colleagues at the Idaho Governor's Office of Species Conservation, Rio Applied Science and Engineering, and from Sean Gibbs and Ben Briscoe at Mount Hood Environmental. Funding for this study was provided by the Bureau of Reclamation, Pacific Northwest Regional Office (contract No. 140R1021F0018). Special thanks to Caitlin Alcott and Inter-Fluve for their administrative support and guidance.


\newpage

# Literature Cited 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

# Tables

<div id="tables"></div>

```{r abund-data-lp}
LP_mod %>%
  select(event_name, species, data) %>%
  distinct() %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  rename(`Sampling Event` = event_name,
         Species = species) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Data summary for single census estimators. M is the number of fish caught in the first sample, marked and returned to the population. n is the number of fish caught in the second sample, and m is the number of marked fish caught in the second sample.") %>%
  kable_styling()

```

\newpage

```{r abund-data-schn}
N_mods %>%
  select(event_name, species, data) %>%
  distinct() %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  rename(`Sampling Event` = event_name,
         Species = species,
         Date = date) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Data summary for multiple census estimators. n is number of fish caught, m is the number of marked fish caught, u is the number of unmarked fish caught, and R is the number of marked fish returned to the population.") %>%
  kable_styling()

```

\newpage

```{r abund-tab}
all_est %>%
  select(-c(species, range:prop_range)) %>%
  rename(`Sampling Event` = event_name,
         Estimator = model) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Temporary caption.") %>%
  kable_styling()

```

\newpage

# Figures

<div id="figures"></div>

```{r map, out.width = "85%", fig.cap = "Map of the Deadwater Slough study area. The high-resolution orthoimage portion directly surrounding the Deadwater Slough was generated from aerial images taken by a drone. The red polygon indicates the reach characterized by unnaturally slow water velocities and a deepened channel. The location of the Dump Creek delta is indicated."}
knitr::include_graphics("../figures/deadwater_map_low_res.png")

```

\newpage

```{r abund-fig, fig.cap = "Estimates of abundance of northern pikeminnow using different estimators."}
all_est %>%
  mutate(across(c(N, Lci, Uci),
                 ~ . / 1000)) %>%
  ggplot(aes(x = model,
             y = N,
             color = model)) +
  geom_errorbar(aes(ymin = Lci,
                    ymax = Uci),
                width = 0.1) +
  geom_point(size = 4) +
  facet_wrap(~ event_name) +
  scale_color_brewer(palette = "Set1") +
  coord_cartesian(ylim = c(0, 100)) +
  labs(x = "Estimator",
       y = "Pikeminnow Abundance (x 1,000)") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45,
                                   hjust = 1))

```

\newpage

```{r cpue-fig, fig.cap = "Total catch per unit effort across entire sampling event."}
total_cpue %>%
  ggplot(aes(x = event_name,
             y = cpue_large_per_day,
             fill = event_name)) +
  geom_col() +
  scale_fill_brewer(palette = "Set1",
                    name = "Event") +
  labs(x = "Event",
       y = "CPUE (Large Pikeminnow caught per angler day)") +
  theme(legend.position = "none")

```

\newpage

```{r fall-bio-fig, fig.cap = "First bioenergetics plot."}
fall_bio_p = fall_only_no_growth %>%
  ggplot() +
  aes(x = date,
      y = cum_cons_fish_g,
      colour = temperature_c) +
  geom_line(size = 2.5) +
  scale_color_distiller(palette = "Spectral",
                        direction = -1) +
  scale_x_date(breaks = "2 week") +
  scale_y_continuous(name = "Scumulative fish eaten (g)",
                     breaks = seq(0, 200, by = 10),
                     sec.axis = sec_axis(~. / 12, 
                                         name = "Potential number of Chinook Salmon smolts",
                                         breaks = seq(0, 20, by = 1))) +
  theme_classic() +
  theme(legend.position = "top") +
  labs(color = "Temperature (C)")

fall_bio_p

```

\newpage

```{r full-yr-ng-fig, fig.cap = "Next bioenergetics plot."}
full_yr_ng_p = full_yr_no_growth %>%
  ggplot() +
  aes(x = date,
      y = cum_cons_fish_g,
      colour = temperature_c) +
  geom_line(size = 2.5) +
  scale_color_distiller(palette = "Spectral",
                        direction = -1) +
  #scale_x_date(breaks = "2 week") +
  scale_y_continuous(name = "Cumulative fish eaten (g)",
                     breaks = seq(0, 600, by = 50),
                     sec.axis = sec_axis(~. / 12,
                                         name = "Potential number of Chinook Salmon smolts",
                                         breaks = seq(0, 30, by = 2))) +
  theme_classic() +
  theme(legend.position = "top") +
  labs(color = "Temperature (C)",
       x = "Month")

full_yr_ng_p

```

```{r full-yr-10p-fig, eval = F, fig.cap = "Another bioenergetics plot."}
full_yr_10p_p = full_yr_10p_growth %>%
  ggplot() +
  aes(x = date,
      y = cum_cons_fish_g,
      colour = temperature_c) +
  geom_line(size = 2.5) +
  scale_color_distiller(palette = "Spectral",
                        direction = -1) +
  #scale_x_date(breaks = "2 week") +
  scale_y_continuous(name = "Cumulative fish eaten (g)",
                     breaks = seq(0, 600, by = 50),
                     sec.axis = sec_axis(~. / 12,
                                         name = "Potential number of Chinook Salmon smolts",
                                         breaks = seq(0, 40, by = 2))) +
  theme_classic() +
  theme(legend.position = "top") +
  labs(color = "Temperature (C)",
       x = "Month")

full_yr_10p_p

```

```{r alt-mod-fig, eval = F, fig.cap = "Another bioenergetics plot, again."}
alt_mod_p = alternative_mod %>%
  ggplot() +
  aes(x = date,
      y = cum_cons_fish_g,
      colour = temperature_c) +
  geom_line(size = 2.5) +
  scale_color_distiller(palette = "Spectral",
                        direction = -1) +
  #scale_x_date(breaks = "2 week") +
  scale_y_continuous(name = "Cumulative fish eaten (g)",
                     breaks = seq(0, 600, by = 50),
                     sec.axis = sec_axis(~. / 12,
                                         name = "Potential number of Chinook Salmon smolts",
                                         breaks = seq(0, 30, by = 2))) +
  theme_classic() +
  theme(legend.position = "top") +
  labs(color = "Temperature (C)",
       x = "Month")

alt_mod_p

```

```{r stmch-cont-p, eval = F, fig.cap = "A stomach contents plot."}
stmch_cont_per_sz_p = gastric_df %>%
  filter(method %in% "Angling") %>%
  ggplot() +
  aes(x = fish_or_parts) +
  geom_bar(fill = "#DB740E") +
  labs(x = "Stomach Contents",
       y = "Frequency") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1)) +
  facet_wrap(vars(npm_50),
             nrow = 2L)

stmch_cont_per_sz_p

```

\newpage

```{r length-freq-p, eval = T, fig.cap = "A length frequency plot."}
length_freq_p = gastric_df %>%
  ggplot(aes(length)) +
  geom_histogram(breaks = seq(150, 650, by = 50),
                 col = "#DB740E",
                 fill = "#DB740E",
                 alpha = .2) +
  labs(x = "TL (mm)",
       y = "Frequency") +
  xlim(c(100, 700)) +
  ylim(c(0, 800)) +
  scale_x_continuous(breaks = seq(0, 650, by = 50)) +
  scale_y_continuous(breaks = seq(0, 550, by = 50)) +
  theme_classic()

length_freq_p

```

\newpage

```{r adult-imp-p, fig.cap = "The adult impacts plot."}
adult_impact %>%
  mutate(stage = "Smolt") %>%
  select(event_name, model,
         stage,
         starts_with("smolt")) %>%
  rename_with(.fn = ~ str_remove(., "smolt_"),
              .cols = starts_with("smolt")) %>%
  bind_rows(adult_impact %>%
              mutate(stage = "Adult Equivalent") %>%
              select(event_name, model,
                     stage,
                     starts_with("adult")) %>%
              rename_with(.fn = ~ str_remove(., "adult_"),
                          .cols = starts_with("adult"))) %>%
  filter(str_detect(model, "Schuma", negate = T)) %>%
  ggplot(aes(x = model,
             y = N,
             color = model)) +
  geom_errorbar(aes(ymin = Lci,
                    ymax = Uci),
                width = 0.5) +
  geom_point(size = 4) +
  facet_grid(stage ~ event_name,
             scales = "free_y") +
  scale_color_brewer(palette = "Set1",
                     name = "Model") +
  theme(axis.text.x = element_blank(),
        legend.position = "bottom") +
  labs(x = "N. Pikeminnow Abundance Model")
```


\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()

```

\newpage

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())

```
