---
title: "Northern Pikeminnow Predation on Juvenile Chinook Salmon in Deadwater Slough, Salmon River, Idaho and Potential Impacts to Local Populations"
author:
  - Michael W. Ackerman:
      email: mike.ackerman@mthoodenvironmental.com
      institute: [mhe_mccall, biomark]
      correspondence: true
  - Nicholas J. Porter:
      email: Nicholas.Porter@merck.com
      institute: [biomark]
      correspondence: false
  - Kevin E. See:
      email: Kevin.See@dfw.wa.gov
      institute: [biomark, wdfw]
      correspondence: false
  - Michael S. Hall:
      email: Mike.Hall1@merck.com
      institute: [biomark]
      correspondence: false
  - Tara E. Blackman:
      email: tara.blackman@mthoodenvironmental.com
      institute: [mhe_sandy]
      correspondence: false
  - Richard A. Carmichael:
      email: Richard.Carmichael@merck.com
      institute: [biomark]
      correspondence: false
institute:
  - mhe_mccall: Mount Hood Environmental, PO Box 4282, McCall, Idaho, 83638, USA
  - biomark: Biomark, Inc., 705 South 8th Street, Boise, Idaho, 83702, USA
  - wdfw: Washington Department of Fish and Wildife, Fish Program, Science Division, 1111 Washington Street NE, Olympia, Washington, 98501, USA
  - mhe_sandy: Mount Hood Environmental, 39085 Pioneer Boulevard \#100 Mezzanine, Sandy, Oregon, 97055, USA 
date: "`r format(Sys.time(), '%d %B, %Y')`"
always_allow_html: true
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      number_sections: FALSE
      toc: no
      always_allow_html: true
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
    bookdown::html_document2:
      fig_caption: yes
      number_sections: FALSE
      toc: no
      fig_width: 6
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua      
fontsize: 12pt
mainfont: Times New Roman
bibliography: 
- references.bib      # Kevin's library
- AckermanLibrary.bib # Mike's library
csl: "../templates/american-fisheries-society.csl" # Insert path for the bib-style
abstract: |
  Abstract text here. 
keywords: |
  Northern Pikeminnow; Chinook Salmon; predation; mark-recapture; bioenergetics
highlights: |
  These are the highlights. 
---

Keywords: `r rmarkdown::metadata$keywords`

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)

```

```{r load-libraries}
library(tidyverse)
library(magrittr)
library(lubridate)
library(tidytable)
library(janitor)
library(purrr)
library(here)
library(FSA)
library(knitr)
library(kableExtra)
library(stringi)
library(english)
library(lemon)
library(gridExtra)

# format NA values in tables
options(knitr.kable.NA = '-')

# set default theme for figures
#theme_set(theme_bw())
theme_set(theme_classic())

# when knitting to Word, use this
doc.type <- knitr::opts_knit$get('rmarkdown.pandoc.to')

if(doc.type == 'docx') {
  options(knitr.table.format = "pandoc")
}

```

\newpage

```{r deadwater-attr}
# set some deadwater attributes
ddw_rkms = 1.871
ddw_m2 = 119431
ddw_avg_width_m = 68
ddw_acres = ddw_m2 / 4047
ddw_hectares = ddw_m2 / 10000

```

# Introduction

The Snake and Columbia rivers drain a network of inland tributaries that provide essential spawning and rearing habitat for anadromous Pacific salmon *Oncorhynchus* spp. and steelhead *O. mykiss*. These fishes were historically abundant throughout the drainage basin and consequently have tremendous ecological, cultural, and economic value. Over the last century, salmonid stocks throughout the Snake and Columbia rivers have undergone significant declines related to habitat modification in the freshwater environment (e.g., removal of beavers, river channel simplification, water withdrawals, hydrosystem development) and poor marine conditions, both affecting their survival and recruitment at multiple life stages. Consequently, action agencies have made considerable investments in the rehabilitation of tributary ecosystems and evaulation of factors attributed to the species decline [@Roni2018].

One potentially important, but perhaps under-appreciated source of salmonid mortality is predation on emigrating juveniles by piscivorous fishes. In the lower mainstem Snake and Columbia rivers it is estimated that predation on out-migrating salmonids during peak emigration has a significant negative impact on the overall population and success of population recovery [@Fresh2003; @Winther2020]. Dams and reservoirs in the Columbia River are the primary locations associated with high rates of piscine predation on salmonids [@Petersen1994; @Ward1995]. There are generally two mechanisms that explain these high predation zones. First, migration (movement) rates of juvenile salmon are reduced during reservoir passage [@Venditti2000], thereby increasing the time migrating smolts are vulnerable to predation. Second, reservoirs and downstream tailraces associated with dams on the Snake and Columbia rivers create favorable slow-water habitat for predatory fishes known to consume juvenile salmonids, such as the Northern Pikeminnow *Ptychocheilus oregonsis*. Northern Pikeminnow tolerate and thrive in relatively warm, slow water habitats [@Wydoski2003] and consequently have benefited from dams on the Columbia River, becoming abundant predators of salmonid outmigrants [@Knutsen1999]. Indeed, Northern Pikeminnow are estimated to consume 8% (16.4 million) of the approximately 200 million juvenile salmonids emigrating through the lower Snake and Columbia Rivers, annually [@Beamesderfer1996].

Most predation studies have focused on reservoirs [@Murphy2021] and mainstem reaches [@Zimmerman1999; @Tabor1993; @Ward1995; @Shively1996] of the Columbia River basin whereas considerably less is known about the interaction between upstream, river-dwelling piscivorous fishes and their impacts on salmonid recovery above the reservoir systems [@Rubenson2020]. Upstream habitats containing slower water velocities and other attributes that support piscivorous predators may overlap with essential habitat for some salmonid species and life stages. One such example is Deadwater Slough, an approximately `r round(ddw_rkms, 1)` kilometer long reach of unnaturally slow and deep water in the Salmon River, Idaho. The Deadwater Slough is located in a river reach containing historically important overwinter rearing and spring emigration habitat for juvenile Chinook Salmon *O. tshawytscha* and is inhabited by piscivorous predators, including Northern Pikeminnow and Smallmouth Bass *Micropterus dolomieu*. Further, the slough is part of the migratory pathway of the endangered Snake River Sockeye Salmon *O. nerka* population [@Axel2015] and several populations of threatened Snake River steelhead.

Quantifying mortality associated with piscine predation in upstream habitats of the Salmon River is of particular interest for spring/summer Chinook Salmon in the Upper Salmon major population group (MPG). The Salmon River was historically the most productive tributary for spring/summer Chinook Salmon in the Columbia River basin [@Nemeth1999], but those populations have become depleted in recent decades. Currently, the Upper Salmon MPG supports eight independent, extant spring/summer Chinook Salmon populations, including Salmon River (above Redfish Lake Creek), Valley Creek, Yankee Fork Salmon River, East Fork Salmon River, Salmon River (mainstem below Redfish Lake Creek), Pahsimeroi River, Lemhi River, and North Fork Salmon River [@NOAA2017]. The Upper Salmon MPG are stream-type Chinook Salmon and exhibit two distinct migration tactics; downstream rearing (DSR) and natal reach rearing (NRR) [@Copeland2014]. Diversity of migration tactics provides a mechanism for coping with adverse conditions in freshwater rearing and migration environments and buffers against catastrophic events, thereby increasing population resiliency. Because the Deadwater Slough supports rearing for DSR migrants and is part of the migration corridor for NRR migrants, and juveniles from all Upper Salmon populations must rear in or migrate through it, it represents a significant habitat for the Upper Salmon MPG.

Recent studies have attempted to examine the downstream movement, distribution, and (apparent) survival of juvenile salmonid emigrants through the Salmon River, including the Deadwater Slough reach. Sockeye Salmon migrating through the mainstem Salmon River during spring were estimated to have substantially reduced survival in the Deadwater Slough reach compared to adjacent reaches [@Axel2015]. Similarly, emigrating DSR Chinook Salmon had a 10% reduction in transition probability through the Deadwater Slough compared to surrounding reaches during the fall and early winter months [@Ackerman2018; @Porter2019]. Low survival in these cases was attributed to low-velocity water delaying movement rates, thereby increasing predation risk.

In this study, we estimated the abundance of Northern Pikeminnow in the Deadwater Slough and evaluated potential impacts to juvenile salmon emigrants, focusing on DSR and NRR Chinook Salmon. We hypothesize that high densities of piscivorous predators in the Deadwater Slough may explain the reduced survival (or apparent survival) observed for juvenile Chinook Salmon and Sockeye Salmon. To test this, our objectives were three-fold:

1. Estimate the abundance (or relative abundance) of potential predators in the Deadwater Slough during the peaks of fall (DSR) and spring (NRR) juvenile emigrations.
2. Document predation on juvenile Chinook Salmon during the emigration periods using gastric lavage.
3. Use a bioenergetics approach to estimate consumption potential (grams) of the Northern Pikeminnow population at Deadwater Slough to assess their potential impacts to DSR and NRR Chinook Salmon emigrants.

We also consider how consumption of juvenile Chinook Salmo emigrants at Deadwater Slough by Northern Pikeminnow may impact adult returns to the Upper Salmon MPG.


# Methods

## Study Site

The Deadwater Slough is an approximately 1.5 km section of the mainstem Salmon River located approximately 6 river km downstream from the town of North Fork, Idaho (Figure \@ref(fig:map)). The downstream end of the slough is located at the confluence of Dump Creek and the Salmon River. Around 1897, the failure of a small mining diversion reservoir in the Dump Creek drainage resulted in an erosion event that deposited substantial amounts of sediment at the confluence of the Salmon River [@Emerson1973], thereby creating a slow, deep section in the river, spanning approximately `r round(ddw_acres)` acres (`r round(ddw_hectares)` hectares), and averaging `r round(ddw_avg_width_m)` m width.


## Northern Pikeminnow Abundance

We estimated the population size of piscine predators in the Deadwater Slough using a mark-recapture survey and a catch per unit effort (CPUE) approach. Predators were sampled near the peaks of the juvenile DSR and NRR emigrations. Our initial intent was to sample during the emigration of the 2018 brood year (fall 2019 and spring 2020). However, due to logistical concerns during the onset of the Covid-19 pandemic, the spring 2020 effort was delayed until fall 2020. Although this provided the benefit of an additional abundance estimate during the DSR emigration, estimates during the NRR emigration were still lacking, and so an additional effort was added in spring 2021. Fall efforts included sampling across a two-week span, but due to budget constraints the spring 2021 effort was limited to a single week. Fall efforts were constrained within a two-week window to minimize predator emigration/immigration and to constrain the population for the mark-recapture models.

<!-- In the end, sampling dates were as follows: fall 2019 (mark = November 12-14; recapture = November 19-21), fall 2020 (mark = October 20-23; recapture = October 27-30); spring 2021 (mark = May 18-21). -->

Multiple capture methods were employed during the initial fall 2019 effort to reduce selectivity and bias for species and size classes. Methods included raft electrofishing, fyke netting, snorkeling, and angling. Ineffective methods were then abandoned in subsequent years. <!-- For example, fish were able to elude the electrical field of the raft electrofisher due to 1) the lack of flow in Deadwater Slough and 2) our inability to "chase" fish downstream as they evaded the electricity. Snorkeling was ineffective due to the high turbidity of the mainstem Salmon River and Deadwater Slough area. Significant amounts of debris in the water column also created concerns that fyke nets could become entangled. Additionally, there were concerns that raft electrofishers and fyke nets could incidentally capture ESA-listed adult steelhead that are present in the mainstem Salmon River during fall and spring. -->After evaluating all methods, angling proved to be the most effective method for capturing piscine predators while also minimizing potential impacts to ESA-listed adult steelhead present in the Salmon River during our sampling efforts.<!--, but recognizing that angling can have both species and size selectivity (bias).--> Therefore, the following analyses will focus on fish captured by angling, unless otherwise noted. During the fall 2019 effort it additionally became clear that Northern Pikeminnow were by far the most prevalent piscine predator in Deadwater Slough and so is the focus of our study.

Our study relied heavily on volunteer anglers who were permitted to fish anywhere within Deadwater Slough. During a sampling occassion (day), anglers would boat or hike their catch (periodically or upon filling a livewell) to a processing station at the boat ramp approximately 500 m downstream from the top of the slough. For each fish, we recorded the date of capture, species, total length (TL; mm), and whether the fish was previously marked. Unmarked fish were given a physical mark (e.g., hole punch of lower caudal, upper caudal, left pelvic, right pelvic) unique to each day and released. Fish that died prior to release were still counted as captured (or recaptured), but not included in the number of marked fish available for recapture after that date. Released individuals were distributed throughout Deadwater Slough to facilitate mixing back into the population. Finally, we recorded the angling start and end time for each crew (person or combinations of persons) to facilitate calculations of CPUE.


```{r capture-data, eval = T}
raw_df = readxl::read_excel(here("analysis/data/raw_data/Deadwater_predation_mark_recapture_11.09.21.xlsx")) %>%
  clean_names() %>%
  mutate(across(date,
                ymd)) %>%
  mutate(across(c(start_time, end_time),
                ~ ymd_hms(paste(year(date), month(date), day(date), hour(.), minute(.), second(.))))) %>%
  # break days into "sampling events"
  mutate(event_name = if_else(month(date) > 8,
                              paste("Fall", year(date), sep = "_"),
                              paste("Spring", year(date), sep = "_")))

# focus on pikeminnow, to be used for mark-recap models
cmr_df = raw_df %>%
  filter(count > 0) %>%
  # pull out only Northern Pikeminnow
  filter(species == "Northern Pikeminnow") %>%
  mutate(mark_release = if_else(fish_status == "Live" &
                                  capture_type == "Mark",
                                T, F),
         recap = if_else(capture_type == "Recapture",
                         T, F))

```

```{r effort, eval = T}
effort_df = raw_df %>%
  select(event_name,
         site,
         date,
         crew,
         crew_count,
         method,
         equipment,
         start_time:total_effort,
         total_day_effort) %>%
  distinct() %>%
  filter(method == "Angling") %>%
  mutate(across(total_effort,
                ~ . * crew_count)) %>%
  rename(total_effort_min = total_effort) %>%
  group_by(event_name,
           date) %>%
  summarise(across(c(total_effort_min,
                     crew_count),
                   sum),
            .groups = "drop")

# What size (mm) is considered a large pikeminnow?
large_size = 228

# catch per unit effort
cpue_df = effort_df %>%
  # add back in the number of pikeminnow caught
  left_join(cmr_df %>%
              group_by(event_name, species, date) %>%
              summarise(n_fish = n(),
                        n_large_fish = sum(length >= large_size,
                                           na.rm = T),
                        .groups = "drop")) %>%
  # calculate CPUE a few different ways
  mutate(catch_per_min = n_fish / total_effort_min,
         catch_per_hr  = n_fish / (total_effort_min / 60),
         catch_per_angler_day = n_fish / crew_count,
         catch_lg_per_angler_day = n_large_fish / crew_count)
 
```

```{r lincoln-petersen-estimator, eval = T}
# using Lincoln-Petersen model, combining first 4 and last four days
# define mark and recapture periods
cap_periods = tibble(event_name = "Fall_2019",
                     cap_period = "Mark",
                     int = interval(start = ymd('20191112'),
                                    end = ymd('20191114'))) %>%
  bind_rows(tibble(event_name = "Fall_2019",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20191119'),
                                  end = ymd('20191121')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Mark",
                   int = interval(start = ymd('20201020'),
                                  end = ymd('20201023')))) %>%
  bind_rows(tibble(event_name = "Fall_2020",
                   cap_period = "Recapture",
                   int = interval(start = ymd('20201027'),
                                  end = ymd('20201030'))))

# add cap_period column, fill w/ NA
cmr_df$cap_period = NA_character_
# fill cap_period w/ Mark or Recapture
for(i in 1:nrow(cap_periods)) {
  my_int = cap_periods$int[i]
  index = which(cmr_df$date %within% my_int)
  cmr_df$cap_period[index] = cap_periods$cap_period[i]
}

# Lincoln-Peterson Model
LP_mod = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species) %>%
  summarise(M = sum(cap_period == "Mark" & fish_status == "Live", na.rm = T),
            n = sum(cap_period == "Recapture"),
            m = sum(cap_period == "Recapture" & capture_type == "Recapture", na.rm = T),
            .groups = "drop") %>%
  nest(data = -c(event_name, species)) %>%
  crossing(model = c("Petersen",
                     "Chapman")) %>%
  mutate(mr_model = map2(data,
                       model,
                      .f = function(x, y) {
                        with(x,
                             FSA::mrClosed(M = M,
                                          n = n,
                                          m = m,
                                          method = y))
                        }),
         N_summ = map(mr_model,
                      .f = summary,
                      incl.SE = T),
         CI = map(mr_model,
                  .f = confint)) %>%
  mutate(N = map_dbl(N_summ,
                     .f = function(x) x[1]),
         SE = map_dbl(N_summ,
                      .f = function(x) x[2]),
         Lci = map_dbl(CI,
                         .f = function(x) x[1]),
         Uci = map_dbl(CI,
                         .f = function(x) x[2])) %>%
  select(-N_summ, -CI)

```

```{r schnabel-estimator, eval = T}
# using Schnabel and Schumacher-Eschmeyer estimators
N_mods = cmr_df %>%
  # filter out spring 2021 (no recapture)
  filter(event_name != "Spring_2021") %>%
  group_by(event_name, species, date) %>%
  summarise(n = n(),
            m = sum(capture_type == "Recapture", na.rm = T),
            u = sum(capture_type == "Mark" | is.na(capture_type)),
            R = sum(fish_status == "Live", na.rm = T),
            .groups = "drop") %>%
  group_by(event_name, species) %>%
  mutate(M = lag(R - m),
         M = replace_na(M, 0),
         M = cumsum(M)) %>%
  nest() %>%
  crossing(model = c("Schnabel",
                     "SchumacherEschmeyer")) %>%
  mutate(mr_model = map2(data,
                         model,
                         .f = function(x, y) {
                           with(x,
                                mrClosed(n = n,
                                         m = m,
                                         R = R,
                                         method = y,
                                         chapman.mod = TRUE))
                         }),
         N = map_dbl(mr_model,
                     .f = summary),
         CI = map(mr_model,
                  .f = confint,
                  conf.level = 0.95),
         Lci = map_dbl(CI,
                       .f = function(x) x[1]), 
         Uci = map_dbl(CI,
                       .f = function(x) x[2])) %>%
  ungroup() %>%
  select(-CI)

```

```{r abund-est}
all_est = LP_mod %>%
  select(event_name, species, model, N:Uci) %>%
  bind_rows(N_mods %>%
             select(event_name, species, model, N:Uci)) %>%
  mutate(range = Uci - Lci,
         prop_range = range / N) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  mutate(model = fct_recode(model,
                            "Schumacher-Eschmeyer" = "SchumacherEschmeyer")) %>%
  arrange(event_name, model)

```

```{r spring-abund}
total_cpue = cpue_df %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  group_by(species,
           event_name) %>%
  summarise(across(c(total_effort_min,
                     n_fish,
                     n_large_fish,
                     angler_days = crew_count),
                   sum),
            .groups = "drop") %>%
  mutate(catch_per_min = n_fish / total_effort_min,
         catch_per_hr = n_fish / (total_effort_min / 60),
         catch_per_angler_day = n_fish / angler_days,
         catch_lg_per_angler_day = n_large_fish / angler_days)

spring_abund = all_est %>%
  filter(model == "Schnabel") %>%
  select(-range, -prop_range) %>%
  inner_join(total_cpue,
             by = c("event_name", "species")) %>%
  select(species,
         model,
         model_event = event_name,
         N_F = N,
         Lci_F = Lci,
         Uci_F = Uci,
         cpue_F = catch_per_hr) %>%
  group_by(species, model) %>%
  summarise(across(c(N_F:cpue_F),
                   mean),
            .groups = "drop") %>%
  full_join(total_cpue %>%
              filter(str_detect(event_name, "Spring")) %>%
              select(species,
                     cpue_S = catch_per_hr),
            by = "species") %>%
  mutate(N_S = N_F * (cpue_S / cpue_F),
         Lci_S = Lci_F * (cpue_S / cpue_F),
         Uci_S = Uci_F * (cpue_S / cpue_F))

```

Four different mark-recapture estimators were employed to explore variation in abundance estimates among them. Estimators fell into two broad categories: single census and multiple census. For the single census estimators, we treated the first week as the first (mark) sample, and the following (second) week as the second (recapture) sample, pooling data within each of those weeks. Alternatively, the multiple census estimators treat each day as a sample and use information about the total marked fish from all previous samples to infer the total abundance. 

For the single census estimators, we first used the Lincoln-Peterson estimator:

$$
\hat{N} = \frac{(M)(n)}{(m)}
$$
where $M$ is the total number of fish marked and returned to the population during the first sample (week), $n$ is the total number of fish caught in the second sample (week), and $m$ is the number of marked fish caught during the second week. Because the Lincoln-Peterson estimator can be biased with small samples, we also employed the Chapman-modified Lincoln-Peterson estimator:

$$
\hat{N} = \frac{(M + 1)(n + 1)}{(m + 1)} - 1
$$
For a multiple census estimator, we first utilized the Schnabel method:

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M_i}{\left(\sum\limits_{i = 1}^k m_i \right) + 1}
$$

where $M$, $n$, and $m$ are indexed by each sample, $i$. Here, sample $i$ is defined as each day. The Schnabel estimator does not have an associated standard error; however, the 95% confidence intervals were calculated. Lastly, we explored one additional multiple-census estimator, the Schumacher-Eschmeyer, which is based on minimizing the weighted sum of squares between the proportion of marked individuals in the sample and the unknown proportion of marked individuals in the population. The Schumacher-Eschmeyer estimator is as follows:

$$
\hat{N} = \frac{\sum\limits_{i = 1}^k n_i M^2_i}{\sum\limits_{i = 1}^k m_i M_i}
$$

The mark-recapture estimators allowed us to estimate the abundance of Northern Pikeminnow during the fall 2019 and 2020 sample efforts (the estimate is of the initial population size). However, to estimate the abundance of Northern Pikeminnow during spring 2021, which was not a mark-recapture design, we used the ratio of total CPUE in the fall efforts to the total CPUE in the spring efforts, then multiplied that ratio by the average abundance from the fall efforts. This approach assumes equal capture probabilities between fall and spring efforts.

All mark-recapture abundance estimators assumed: (1) the population is closed (no immigration, emigration, births or deaths during the sampling period), (2) all fish have equal chance of being caught in the second (and subsequent) sample(s), (3) marking a fish does not affect its chances of recapture, (4) no loss of marks, and (5) marks are not missed or mistaken.


## Gastric Lavage

Gastric lavage [@Foster1977] was used to examine the stomach contents of Northern Pikeminnow for the presence of juvenile Chinook Salmon and other fishes (e.g., juvenile steelhead, juvenile Sockeye Salmon, Redside Shiner *Richardsonius balteatus*, etc.). Immediately following lavage, stomach contents of individuals were preserved with 99% isopropyl alcohol in whirl-paks for later analysis in a controlled environment. For each sample, wet weight (grams) was recorded for the total combined stomach content, including all non-fish items (e.g., macroinvertebrates, organic matter), as well as that portion consisting of fish parts or matter. Fish and fish remnants were identified to the lowest taxonomic unit using diagnostic bones, or were categorized as unknown [@Hansel1988; @Frost2000]. A subset of Northern Pikeminnow captures (~ 5%) were euthanized for dissection after gastric lavage to validate the efficacy of the methodology.


```{r gastric-data}
gastric_df = raw_df %>%
  select(event_name, date, species, method, lavage_id, length, stomach_contents, comments, stomach_contents_weight,                             fish_content_weight) %>%
  mutate(bin_50 = lencat(length, w = 50)) %>%
  filter(species == "Northern Pikeminnow") %>%
  mutate(non_fish_wt = stomach_contents_weight - fish_content_weight) %>%
  mutate(lavaged = case_when(
    is.na(lavage_id) & is.na(stomach_contents) ~ FALSE,
    stomach_contents == "Did Not Lavage" ~ FALSE,
    stomach_contents == "Lost sample CG27-001" ~ FALSE,
    TRUE ~ TRUE
  )) %>%
  mutate(had_contents = case_when(
    lavaged == FALSE ~ FALSE,
    is.na(stomach_contents) ~ FALSE,
    stomach_contents == "Empty" ~ FALSE,
    TRUE ~ TRUE
  )) %>%
  mutate(had_fish_contents = case_when(
    fish_content_weight > 0 ~ TRUE,
    stomach_contents == "MacroInvert-other/Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish-Unk (fish bone/cartilage)" ~ TRUE,
    stomach_contents == "MacroInvert-other/Mountain Whitefish" ~ TRUE,
    stomach_contents == "MacroInvert-other/Algae/Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish -Shiner" ~ TRUE,
    stomach_contents == "Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish Unk" ~ TRUE,
    stomach_contents == "Detritus/Fish -Shiner" ~ TRUE,
    stomach_contents == "MacroInvert-other/Fish-Unk" ~ TRUE,
    stomach_contents == "MacroInvert-other/Detritus/Fish -Shiner" ~ TRUE,
    stomach_contents == "Fish-Unk" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Detritus/Fish-Unk" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Detritus/Fish-Unk/Other"  ~ TRUE,
    stomach_contents == "Aquatic Veg/Fish-Sucker"  ~ TRUE,
    stomach_contents == "MacroInvert-Worm/Fish-RedsideShiner"  ~ TRUE,
    stomach_contents == "Aquatic Veg/Detritus/Fish-RedsideShiner"  ~ TRUE,
    stomach_contents == "MacroInvert-Other/Fish-Unk" ~ TRUE,
    stomach_contents == "Fish-Sucker/Other" ~ TRUE,
    stomach_contents == "Fish-Unk/Other" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Aquatic Veg/Detritus/Fish-Sucker" ~ TRUE,
    stomach_contents == "Fish-RedsideShiner" ~ TRUE,
    stomach_contents == "Fish-Chinook/Other" ~ TRUE,
    stomach_contents == "Detritus/Fish-RedsideShiner/Other" ~ TRUE,
    stomach_contents == "MacroInvert-Other/Aquatic Veg/Detritus/Fish-RedsideShiner" ~ TRUE,
    stomach_contents == "Detritus/Fish-Sucker/Other" ~ TRUE,
    stomach_contents == "Invertebrates;FishParts"  ~ TRUE,
    stomach_contents == "Invertebrates;Detritus;FishParts;IntestinalWorms"  ~ TRUE,
    stomach_contents == "FishParts"  ~ TRUE,
    stomach_contents == "FishParts;IntestinalWorms"  ~ TRUE,
    TRUE ~ FALSE
  )) %>%
  mutate(had_chinook = case_when(
    stomach_contents == "Fish-Chinook/Other" ~ TRUE,
    TRUE ~ FALSE
  ))

gastric_tbl = gastric_df %>%
  group_by(event_name) %>%
  summarise(captured = n(),
            lavaged = sum(lavaged),
            stmch_contents = sum(had_contents),
            fish_contents = sum(had_fish_contents)) %>%
  adorn_totals("row")

stmch_df = gastric_df %>%
  filter(stomach_contents_weight > 0) %>%
  select(event_name,
         date,
         length,
         stomach_contents_weight,
         fish_content_weight,
         non_fish_wt) %>%
  mutate(p_fish = fish_content_weight / stomach_contents_weight)

psd_df = gastric_df %>%
  group_by(bin_50) %>%
  summarize(n = n())

```


## Bioenergetics

```{r shoup-temp-data, eval = F}
shoup_temp_df = read_tsv(here("analysis/data/raw_data/USGS_13307000_Salmon_River_Nr_Shoup.txt"),
                   comment = "#") %>%
  rename(discharge_cfs = `47768_00060`,
         discharge_cfs_cd = `47768_00060_cd`,
         gage_ht_ft = `47769_00065`,
         gage_ht_ft_cd = `47769_00065_cd`,
         water_temp_c = `47773_00010`,
         water_temp_c_cd = `47773_00010_cd`)

```

```{r read-bio-outputs, message=FALSE, warning=FALSE, include=FALSE}
fmt_bio_out = function(x) {
  x = x %>%
    clean_names() %>%
    mutate(date = as.Date(date, "%m/%d")) %>%
    mutate(cum_cons_fish_g = cumsum(cons_fish_g)) %>% 
    mutate(month = month(date))
  return(x)
  
}

# fall, fish 10% - 90%
fall_f10 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I90_F10.csv")) %>% fmt_bio_out()
fall_f20 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I80_F20.csv")) %>% fmt_bio_out()
fall_f30 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I70_F30.csv")) %>% fmt_bio_out()
fall_f40 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I60_F40.csv")) %>% fmt_bio_out()
fall_f50 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I50_F50.csv")) %>% fmt_bio_out()
fall_f60 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I40_F60.csv")) %>% fmt_bio_out()
fall_f70 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I30_F70.csv")) %>% fmt_bio_out()
fall_f80 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I20_F80.csv")) %>% fmt_bio_out()
fall_f90 = read_csv(here("analysis/data/raw_data/Bioenergetics_Fall_I10_F90.csv")) %>% fmt_bio_out()

# spring, fish 10% - 90%
spring_f10 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I90_F10.csv")) %>% fmt_bio_out()
spring_f20 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I80_F20.csv")) %>% fmt_bio_out()
spring_f30 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I70_F30.csv")) %>% fmt_bio_out()
spring_f40 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I60_F40.csv")) %>% fmt_bio_out()
spring_f50 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I50_F50.csv")) %>% fmt_bio_out()
spring_f60 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I40_F60.csv")) %>% fmt_bio_out()
spring_f70 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I30_F70.csv")) %>% fmt_bio_out()
spring_f80 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I20_F80.csv")) %>% fmt_bio_out()
spring_f90 = read_csv(here("analysis/data/raw_data/Bioenergetics_Spring_I10_F90.csv")) %>% fmt_bio_out()

# average size of fall and spring pikeminnow
avg_fall_NPM   = 352.9
avg_spring_NPM = 393.7

# average size of DSR and NRR juveniles
avg_DSR_g = 10.3
avg_NRR_g = 10.9

# compile fall results
fall_results = fall_f10 %>%
  select(date, temperature_c, cum_cons_fish_g) %>%
  rename(f10_g = cum_cons_fish_g) %>%
  mutate(f20_g = fall_f20$cum_cons_fish_g,
         f30_g = fall_f30$cum_cons_fish_g,
         f40_g = fall_f40$cum_cons_fish_g,
         f50_g = fall_f50$cum_cons_fish_g,
         f60_g = fall_f60$cum_cons_fish_g,
         f70_g = fall_f70$cum_cons_fish_g,
         f80_g = fall_f80$cum_cons_fish_g,
         f90_g = fall_f90$cum_cons_fish_g) %>%
  mutate( across(contains('_g'),
                 .fns = list(n = ~./avg_DSR_g),
                 .names = "{col}_{fn}") )

fall_g_summ = fall_results %>%
  select(f10_g:f90_g) %>%
  pivot_longer(f10_g:f90_g) %>%
  group_by(name) %>%
  summarize(cumm_g = max(value))

rm(fall_f10, fall_f20, fall_f30, fall_f40, fall_f50, fall_f60, fall_f70, fall_f80, fall_f90)

# compile spring results
spring_results = spring_f10 %>%
  select(date, temperature_c, cum_cons_fish_g) %>%
  rename(f10_g = cum_cons_fish_g) %>%
  mutate(f20_g = spring_f20$cum_cons_fish_g,
         f30_g = spring_f30$cum_cons_fish_g,
         f40_g = spring_f40$cum_cons_fish_g,
         f50_g = spring_f50$cum_cons_fish_g,
         f60_g = spring_f60$cum_cons_fish_g,
         f70_g = spring_f70$cum_cons_fish_g,
         f80_g = spring_f80$cum_cons_fish_g,
         f90_g = spring_f90$cum_cons_fish_g) %>%
  mutate( across(contains('_g'),
                 .fns = list(n = ~./avg_NRR_g),
                 .names = "{col}_{fn}") )

spring_g_summ = spring_results %>%
  select(f10_g:f90_g) %>%
  pivot_longer(f10_g:f90_g) %>%
  group_by(name) %>%
  summarize(cumm_g = max(value))

rm(spring_f10, spring_f20, spring_f30, spring_f40, spring_f50, spring_f60, spring_f70, spring_f80, spring_f90)

```

To estimate the total consumption potential (i.e., the number or amount of juvenile Chinook Salmon consumed during the peaks of DSR [fall] and NRR [spring] emigrations) of Northern Pikeminnow in Deadwater Slough, we used the Fish Bioenergetics v4.0 application developed by @Deslauriers2017 and applied in the R statistical software [@RCoreTeam2021]. The daily rate of consumption in grams for an individual Northern Pikeminnow was estimated based on the following inputs: predator and prey energy densities, predator start and end weights, and water temperatures. Predator energy density for Northern Pikeminnow was fixed at 6,703 Joules(J)/g [@Deslauriers2017]. Prey energy densities were fixed at 21,500 J/g for juvenile Chinook Salmon [@Moss2016]. The predator start weight was calculated using a weight-length formula [@Parker1995] and the average length of Northern Pikeminnow caught in Deadwater Slough during our study. The average length of Northern Pikeminnow caught during the fall and spring efforts were `r avg_fall_NPM` and `r avg_spring_NPM` mm, respectively, which calculated to average starting weights of 504.4 and 670.5 g. We assumed no growth in individual Northern Pikeminnow, and so predator start and end weights are equal, i.e., we assumed the population biomass was stable. Mean daily water temperatures were summarized from 15-minute interval temperature readings available March 3, 2013 to June 14, 2021 from a gage station approximately 22 river kilometers downstream of Deadwater Slough near Shoup, Idaho [@USGS2016].

The largest uncertainty among model parameters was the proportion of the Northern Pikeminnow diet consisting of fish (e.g., juvenile Chinook Salmon) versus other food items (e.g., invertebrates). Therefore, we varied the proportion of the diet consisting of fish versus invertebrates to range from 10-90%, in 10% intervals, for both categories. Energy densities for invertebrates was fixed at 3,000 J/g. We estimate the g of (any) fish consumed for each model run. For simplicity, we assume that any fish prey have the same energy densities as juvenile Chinook Salmon and we do not differentiate juvenile Chinook Salmon from other fish prey than may be present in Deadwater slough (e.g., juvenile steelhead, juvenile Sockeye Salmon, Redside Shiner). Separate models were also run for a 77-day fall period from September 15 - November 30 and a 92-day period in the spring from March 1 - May 31 to coincide with peak emigrations of DSR and NRR juveniles from the Lemhi River, the largest Chinook Salmon population in the Upper Salmon MPG. This resulted in 18 separate model runs (9 diet scenarios and 2 seasons). Each model run provided an estimate of the amount (grams) of fish consumed by an individual Northern Pikeminnow during the fall or spring time periods.

<!-- During this time, water temperatures typically exceed the range (0-7$^\circ$C) that would illicit concealment behavior or torpor from juvenile Chinook Salmon. -->

To estimate the total biomass of fish potentially consumed by all Northern Pikeminnow in Deadwater Slough, we then multiplied the grams of fish consumed by an individual Northern Pikeminnow  during each period (fall and spring) by the estimated predator population size for that period. The total biomass was further converted to an estimate of the total number of fish consumed each period by dividing by the average weight of DSR (`r avg_DSR_g` g) and NRR (`r avg_NRR_g` g) emigrants in the Upper Salmon MPG. The weight of an average DSR and NRR emigrants was taken from fish caught at seven rotary screw traps located throughout the Upper Salmon MPG upstream of Deadwater Slough during the fall and spring time periods. This calculation assumes that all fish prey items consumed by Northern Pikeminnow are, on average, the same size as DSR and NRR emigrants.

<!-- Sawtooth Hatchery, East Fork Salmon, Pahsimeroi, Upper Lemhi, Hayden Creek, Lower Lemhi, North Fork Salmon -->

<!--
## Juvenile Chinook Salmon Abundance

Juvenile Chinook Salmon abundances were estimated at 5 rotary screw traps in the upper Salmon River basin: Sawtooth, Pahsimeroi, Hayden Creek, Upper Lemhi, and Lower Lemhi. Abundances were calculated by Idaho Department of Fish and Game at each trap which made up the production estimate for juvenile Chinook Salmon in the Upper Salmon Basin (Table X) (McClure et al. 2020).
-->

```{r adult-impacts}
# pull in SAR numbers
sar = read_csv(here("analysis/data/raw_data", 
                    "WSSCh_sar_4See.csv")) %>%
  summarise(across(c(medsar, sdsar),
                   median)) %>%
  summarise(across(c(medsar, sdsar),
               ~ . / 100))

# summarize potential Chinook eaten for each time period by one pikeminnow
adult_impact = fall_results %>%
  summarise(across(ends_with("g_n"), max)) %>%
  add_column(season = "Fall",
             .before = 0) %>%
  bind_rows(spring_results %>%
              summarise(across(ends_with("g_n"), max)) %>%
              add_column(season = "Spring",
                         .before = 0)) %>%
  pivot_longer(cols = ends_with("g_n"),
               names_to = "perc_diet",
               values_to = "juv_chnk") %>%
  mutate(across(perc_diet,
                str_extract,
                "[:digit:]+"),
         across(perc_diet,
                as.integer)) %>%
  left_join(spring_abund %>%
              select(N_F:Uci_F,
                     N_S:Uci_S) %>%
              pivot_longer(everything()) %>%
              mutate(season = if_else(str_detect(name, "_F$"),
                                      "Fall",
                                      "Spring")) %>%
              mutate(across(name,
                            str_remove,
                            "_F$"),
                     across(name,
                            str_remove,
                            "_S$")) %>%
              pivot_wider(names_from = name,
                          values_from = value)) %>%
  mutate(smolt_N = N * juv_chnk,
         smolt_Lci = Lci * juv_chnk,
         smolt_Uci = Uci * juv_chnk) %>%
  bind_cols(sar) %>%
  mutate(adult_N = smolt_N * medsar,
         adult_Lci = smolt_Lci * qnorm(0.025, medsar, sdsar),
         adult_Uci = smolt_Uci * qnorm(0.975, medsar, sdsar))

# sum fall and spring impacts
total_impacts = adult_impact %>%
  group_by(perc_diet) %>%
  summarise(across(c(ends_with("_N"),
                     ends_with("_Lci"),
                     ends_with("_Uci")),
                   sum))

```


# Results

## Northern Pikeminnow Abundance

We caught `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2019", "n_fish"])`, `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2020", "n_fish"])`, and `r prettyNum(total_cpue[total_cpue$event_name == "Spring 2021", "n_fish"])` Northern Pikeminnow during the fall 2019, fall 2020, and spring 2021 efforts, respectively, for a total of `r prettyNum(sum(total_cpue$n_fish), big.mark = ",")` fish caught using hook-and-line angling. The CPUE, measured as number of Northern Pikeminnow caught per angler hour, was `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2019", "catch_per_hr"], digits = 3)` for fall 2019, `r prettyNum(total_cpue[total_cpue$event_name == "Fall 2020", "catch_per_hr"], digits = 3)` for fall 2020, and `r prettyNum(total_cpue[total_cpue$event_name == "Spring 2021", "catch_per_hr"], digits = 2)` for spring 2021 (Figure \@ref(fig:cpue-fig)). During the mark-recapture efforts, there were `r as.character(english(sum(N_mods[[3]][[1]]$m)))` recaptures in fall 2019 which included `r as.character(english(LP_mod[[3]][[1]]$m))` unique individuals (i.e., `r as.character(english(sum(N_mods[[3]][[1]]$m) - LP_mod[[3]][[1]]$m))` individual was captured more than once). There were an additional `r as.character(english(sum(N_mods[[3]][[3]]$m)))` recaptures in fall 2020 which included `r as.character(english(LP_mod[[3]][[3]]$m))` unique individuals. Summaries of parameters for both the single census and multiple census mark-recapture estimators are provided in Table \@ref(tab:abund-data-lp) and Table \@ref(tab:abund-data-schn), respectively. 

Mark-recapture abundance estimates for Northern Pikeminnow in Deadwater Slough during fall 2019 ranged from `r prettyNum(min(all_est$N[all_est$event_name == "Fall 2019"]), big.mark = ",")` to `r prettyNum(max(all_est$N[all_est$event_name == "Fall 2019"]), big.mark = ",")` and for fall 2020 ranged from `r prettyNum(min(all_est$N[all_est$event_name == "Fall 2020"]), big.mark = ",")` to `r prettyNum(max(all_est$N[all_est$event_name == "Fall 2020"]), big.mark = ",")` (Table \@ref(tab:abund-tab)). In both cases, the multiple census estimators were consistently larger than the single census estimators, although the size of the 95% confidence intervals were more varied (Figure \@ref(fig:abund-fig)). Table \@ref(tab:abund-tab) provides point estimates and confidence intervals for each estimator for the fall mark-recapture efforts.

All mark-recapture estimators yielded estimates with overlapping confidence intervals. However, because our sampling design most closely matched a multiple census estimator (i.e., we released marked fish each day and recaptures from all previous days were recorded for each day), we fell those estimators most appropriate. Additionally, because the Schnabel estimator includes a small sample size modification, as in our case (i.e., few recaptures), we feel it is most appropriate. The Schnabel estimator has the added benefit of more precise confidence intervals and is more straightforward than the Schumacher-Eschmeyer estimate as it is essentially the weighted average among multiple Chapman-modified Lincoln-Peterson estimates. Therefore, further analyses and results will be based on the Schnabel estimates of abundance.

Using the mean of the Schnabel estimates of Northern Pikeminnow abundance across the two fall sampling events, `r prettyNum(mean(all_est$N[all_est$model == "Schnabel"]), big.mark = ",")` (95% CI: `r paste(prettyNum(round(c(spring_abund$Lci_F, spring_abund$Uci_F)), big.mark = ","), collapse = " - ")`), and multiplying the ratio (`r round(total_cpue$catch_per_hr[total_cpue$event_name == "Spring 2021"] / mean(total_cpue$catch_per_hr[total_cpue$event_name %like% "Fall"]), 2)`) between the spring CPUE (`r round(total_cpue$catch_per_hr[total_cpue$event_name == "Spring 2021"], 2)`) and mean of the fall CPUEs (`r round(mean(total_cpue$catch_per_hr[total_cpue$event_name %like% "Fall"]), 2)`), we estimated there to be `r prettyNum(round(spring_abund$N_S), big.mark = ",")` (95% CI: `r paste(prettyNum(round(c(spring_abund$Lci_S, spring_abund$Uci_S)), big.mark = ","), collapse = " - ")`) Northern Pikeminnow in Deadwater Slough during spring 2021.


## Gastric Lavage

We examined the stomach contents of `r prettyNum(gastric_tbl$lavaged[gastric_tbl$event_name == "Total"], big.mark = ",")` Northern Pikeminnow from Deadwater Slough using gastric lavage methods. Of those, we found contents of some form in `r prettyNum(gastric_tbl$stmch_contents[gastric_tbl$event_name == "Total"], big.mark = ",")` (`r prettyNum((gastric_tbl$stmch_contents[gastric_tbl$event_name == "Total"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Total"]) * 100, digits = 3)`%) stomachs and confirmed fish or fish parts in `r prettyNum(gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"], big.mark = ",")` (`r prettyNum((gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"] / gastric_tbl$stmch_contents[gastric_tbl$event_name == "Total"]) * 100, digits = 3)`%) of those. Table \@ref(tab:gastric-tab) summarizes gastric lavage results for each sampling effort. For those individuals with stomach contents, the average wet weight of total contents was `r prettyNum(mean(stmch_df$stomach_contents_weight), digits = 2)` g (median = `r prettyNum(median(stmch_df$stomach_contents_weight), digits = 3)` g; range = `r prettyNum(min(stmch_df$stomach_contents_weight), digits = 3)`-`r prettyNum(max(stmch_df$stomach_contents_weight), digits = 3)` g). Overall, fish or fish remnants consisted of `r prettyNum(mean(stmch_df$p_fish) * 100, digits = 3)`% of the overall of all stomach contents examined.


## Bioenergetics

We estimated an individual, average-size (`r avg_fall_NPM` mm) Northern Pikeminnow to consume `r median(fall_g_summ$cumm_g)` g (range `r min(fall_g_summ$cumm_g)` - `r max(fall_g_summ$cumm_g)` g) of fish during the DSR emigration to maintain their body size, depending on the proportion of diet consisting of fish versus invertebrates (Figure \@ref(fig:bio-p)). Similarly, we estimated an average-size (`r avg_spring_NPM` mm) Northern Pikeminnow to consume `r median(spring_g_summ$cumm_g)` g (range `r min(spring_g_summ$cumm_g)` - `r max(spring_g_summ$cumm_g)` g) of fish during the NRR emigration (Figure \@ref(fig:bio-p)). Given an average weight of `r avg_DSR_g` g for DSR emigrants, that would equate to `r round(median(adult_impact$juv_chnk[adult_impact$season == "Fall"]), 2)` (range `r round(min(adult_impact$juv_chnk[adult_impact$season == "Fall"]), 2)` - `r round(max(adult_impact$juv_chnk[adult_impact$season == "Fall"]), 2)`) fish consumed by an individual during fall and an additional `r round(median(adult_impact$juv_chnk[adult_impact$season == "Spring"]), 2)` (range `r round(min(adult_impact$juv_chnk[adult_impact$season == "Spring"]), 2)` - `r round(max(adult_impact$juv_chnk[adult_impact$season == "Spring"]), 2)`) fish consumed using an average weight of `r avg_NRR_g` g for NRR emigrants.

Given a mean Northern Pikeminnow population size of `r prettyNum(unique(adult_impact$N[adult_impact$season == "Fall"]), big.mark = ",")` from fall estimates and an estimate of `r prettyNum(round(unique(adult_impact$N[adult_impact$season == "Spring"]), 0), big.mark = ",")` for spring 2021 and using the median value from diet scenarios (i.e, 50% of their diet consists of fish), we'd estimate that Northern Pikeminnow can consume `r prettyNum(round(median(adult_impact$smolt_N[adult_impact$season == "Fall"]), 0), big.mark = ",")` (95% CI: `r prettyNum(round(min(adult_impact$smolt_N[adult_impact$season == "Fall"]), 0), big.mark = ",")` - `r prettyNum(round(max(adult_impact$smolt_N[adult_impact$season == "Fall"]), 0), big.mark = ",")`) fish during the DSR emigration and `r prettyNum(round(median(adult_impact$smolt_N[adult_impact$season == "Spring"]), 0), big.mark = ",")` (95% CI: `r prettyNum(round(min(adult_impact$smolt_N[adult_impact$season == "Spring"]), 0), big.mark = ",")` - `r prettyNum(round(max(adult_impact$smolt_N[adult_impact$season == "Spring"]), 0), big.mark = ",")`) fish during the NRR emigration in Deadwater Slough. Table \@ref(tab:adult-imp) shows the estimated number of fish consumed by an individual Northern Pikeminnow and by the population across all diet scenarios during both the fall (DSR) and spring (NRR) peak emigration seasons.

Across both seasons and all diet scenarios, we estimated the total number of fish consumed to be between `r prettyNum(round(min(total_impacts$smolt_N), 0), big.mark = ",")` and `r prettyNum(round(max(total_impacts$smolt_N), 0), big.mark = ",")` (Table \@ref(tab:adult-imp)). The estimated number of fish consumed by a Northern Pikeminnow begins to taper off between the 30-90% diet scenarios. So although we are uncertain of the diet proportions consisting of fish versus invertebrates, the impact of that uncertainty is somewhat constrained.

<!--
## Juvenile Chinook Salmon Abundance
For context, throughout the migration periods of DSR and NRR life histories it is estimated that 113,976 individuals are produced and therefore available within the upper Salmon River basin (Table x).

The abundance of juvenile Chinook Salmon for the upper Salmon River basin was estimated at 6 rotary screw traps [@McClure2020]. Overall, in 2020, there were an estimated 59,289 DSR, 22,264 NRR, and 10,159 parr estimated among all these traps in the upper Salmon River basin (Table X.)
-->


# Discussion

```{r john-day}
john_day_res_abund = 85316
john_day_rkms = 123
john_day_dens = john_day_res_abund / john_day_rkms

low_columbia_fish_km = 2814

```

The mean population size of Northern Pikeminnow in the Deadwater Slough during the fall season was estimated to be `r prettyNum(unique(adult_impact$N[adult_impact$season == "Fall"]), big.mark = ",")` and during the spring 2021 to be `r prettyNum(round(unique(adult_impact$N[adult_impact$season == "Spring"]), 0), big.mark = ",")`. Those estimates translate to linear densities of `r prettyNum(round(unique(adult_impact$N[adult_impact$season == "Fall"]) / ddw_rkms), big.mark = ",")` and `r prettyNum(round(unique(adult_impact$N[adult_impact$season == "Spring"]) / ddw_rkms), big.mark = ",")` which is `r round(unique(adult_impact$N[adult_impact$season == "Fall"]) / ddw_rkms / john_day_dens)` and `r round(unique(adult_impact$N[adult_impact$season == "Spring"]) / ddw_rkms / john_day_dens)` times greater than densities reported by @Beamesderfer1991 for the John Day Reservoir and approximately `r as.character(english(round(unique(adult_impact$N[adult_impact$season == "Fall"]) / ddw_rkms / low_columbia_fish_km)))` and `r as.character(english(round(unique(adult_impact$N[adult_impact$season == "Spring"]) / ddw_rkms / low_columbia_fish_km)))` times greater than projections for the lower Columbia River [@Beamesderfer1996]. These densities for Deadwater Slough initially seem unrealistic especially given the size (volume) of the Salmon River at the slough relative to the Columbia River. However, we did catch `r prettyNum(nrow(cmr_df), big.mark = ",")` Northern Pikeminnow over the course of the study, of which only `r sum(cmr_df$capture_type == "Recapture", na.rm = T)` fish (one in every `r round(nrow(cmr_df) / sum(cmr_df$capture_type == "Recapture", na.rm = T))`) were recaptures. Further, @Beamesderfer1991 did acknowledge that they were unsuccessful in finding a suitable method for sampling offshore; they noted that water velocity, depth, irregular bottom contours, and barge traffic made sampling offshore ineffective and so their abundance estimates only apply to nearshore areas. This was not the case at Deadwater Slough where maximum depth was approximately 10-15 m with a relatively homogeneous bottom contour i.e., angling was effective for the entire area. Our estimates of Northern Pikeminnow areal density are also higher than those reported elsewhere. We estimate the density of Northern Pikeminnow in Deadwater Slough, as fish per hectare, to be `r prettyNum(round(unique(adult_impact$N[adult_impact$season == "Fall"]) / ddw_hectares), big.mark = ",")` for fall and `r prettyNum(round(unique(adult_impact$N[adult_impact$season == "Spring"]) / ddw_hectares), big.mark = ",")` for spring. For comparison, the only other available estimates of areal density, that the authors are aware of, are 4.4 fish per hectare for John Day Reservoir [@Beamesderfer1991] and 15 fish per hectare in Lake Washington [@Bartoo1977].

```{r psd}
s_size = 250
q_size = 380

psd_df = cmr_df %>%
  select(species, count, length, recap, event_name) %>%
  filter(recap  != TRUE)

fs = psd_df %>%
  filter(length >= s_size) %>%
  nrow()

fq = psd_df %>%
  filter(length >= q_size) %>%
  nrow()

psd = 100 * (fq/fs)

```

Northern Pikeminnow in Deadwater Slough were not only abundant, but anglers noticed that many were also large-bodied. For that reason, we calculated the proportional stock density (PSD) for Northern Pikeminnow in Deadwater Slough, which is a measure of species size structure. PSD is a ratio, typically expressed as a percentage, between the number of "quality_sized" (larger) individuals and "stock-sized" individuals. 

$$
PSD_{i} = 100 * \frac{FQ_{i}}{FS_{i}}
$$

where $FQ_{i}$ is the number of fish $\ge$ quality-length for species $i$, and $FS_{i}$ is the number of fish $\ge$ stock-length for species $i$. Stock and quality size definitions vary by species. We calculated the PSD for Northern Pikeminnow in Deadwater Slough using `r prettyNum(s_size, digits = 0)` mm TL for stock-size and `r prettyNum(q_size, digits = 0)` mm TL for quality-size [@Winther2020]. The PSD for Northern Pikeminnow in Deadwater Slough across all three efforts was `r prettyNum(psd, digits = 1)`% i.e., `r prettyNum(psd, digits = 1)`% of captured fish were over the quality size classification defined by @Winther2020. For comparison, @Winther2020 reported a PSD for Northern Pikeminnow captured below Bonneville Dam of 41% and 18% in Bonneville Reservoir, suggesting that a larger fraction of Northern Pikeminnow in Deadwater Slough are of a quality size relative to populations reported elsewhere in the Columbia River. In fact, the state record Northern Pikeminnow, which measured `r max(cmr_df$length, na.rm = T)` mm (`r round(max(cmr_df$length, na.rm = T) / 25.4, 1)` in) TL, was caught in Deadwater Slough during the fall 2020 effort.


## Mark-Recapture Model

All mark-recapture abundance estimators suggest a large number of Northern Pikeminnow occupying Deadwater Slough. Estimators assumed: (1) the population is closed (no immigration, emigration, births, or deaths during the sampling period), (2) all fish have equal chance of being caught in the second (and subsequent) samples(s), (3) marking a fish does not affect its chances of recapture, (4) no loss of marks, and (5) marks are not missed or mistaken. If the population is actually open (potential immigration and/or emigration during the survey period), our estimators should still provide unbiased estimates of abundance as long as the immigration and emigration rates are equal between marked and unmarked fish. Given the size of the sampling area, and the limited length of the sampling period (two weeks), we are comfortable with the assumption of no immigration or emigration. Assumption (3) indicates whether the second (and subsequent) surveys are random samples of the population. Angling methods may provide a size selection bias, but that only affects the interpretation of the abundance estimates (i.e., our estimates are the abundance of Northern Pikeminnow susceptible to angling above some size threshold). Unequal catchability between individual fish is very difficult to assess, especially if that heterogeneity arises from being caught once; however, we did recapture two individual fish more than once suggesting that marked fish were still susceptible to angling. We are also comfortable with assumptions 4 and 5 (no loss of marks and no mistaken or missed marks) given that marks were physical (hole punches in fins) and that each fish was examined on a measuring board to collect lengths.

We do consider two potential violations of assumption, both which reduces the probability that a marked fish is susceptible to capture in the second (and subsequent) samples. First, the assumption of a closed population could be violated if some marked fish that are released back to the population die. We don't believe this case to be likely, as fish that were dead or nearly so after processing were not released back to the population (nor recorded as such), and those that were released were hand-released only if they were able to swim away on their own volition; however, the potential for marked and released fish to have died at a higher rate than unmarked fish should be acknowledged. The second, and more likely, reason is that marked and released fish did not mix thoroughly back into the population (at least not at a fast enough rate), reducing their probability of capture in subsequent captures, thus violating assumption (2). We attempted to release marked fish throughout Deadwater Slough to facilitate mixing back into the population; however, anecdotally volunteer anglers would congregate to particular areas of the slough either to socialize with other anglers, because the fishing was good, etc. and if marked and released fish were not readily available in those areas that would make marked fish less susceptible to capture. This violation would, in effect, reduce the number of marked fish available for recapture or reduce the marking fraction in some areas of the slough. Violations of assumption (2) would lead to an overestimate of abundance of Northern Pikeminnow which is a real possibility in our study.

The spring abundance estimate was smaller than either fall abundance estimate. However, our approach assumed equal capture probabilities between the fall and spring sample efforts. If it does differ, we suspect that the capture probability in the spring would be lower due to higher flows (i.e., reduced densities), which would lead to our spring abundance estimate being biased low. Therefore, we presume our abundance estimate of Northern Pikeminnow for the spring 2021 effort to be a conservative estimate.


## Gastric Lavage

The majority of fish caught during the study received gastric lavage. To evaluate the efficacy of the method, we euthanized nine Northern Pikeminnow after gastric lavage was completed and removed the remaining stomach contents via dissection. In each case, no additional stomach contents were identified, suggesting that gastric lavage was effective in removing stomach contents, although our sample size was low. However, in total, we only identified fish or fish parts in `r prettyNum(gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"], big.mark = ",")` (`r round(gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Total"] * 100, 1)`%) of the `r prettyNum(gastric_tbl$lavaged[gastric_tbl$event_name == "Total"], big.mark = ",")` Northern Pikeminnow examined using gastric lavage. Aside from juvenile Chinook Salmon, identified species included Redshine Shiner, Largescale Sucker *Catostomus macrocheilus*, sculpin *Cottus* spp., and Mountain Whitefish *Prosopium williamsoni*; however, decomposition from digestion rendered most stomach contents unidentifiable. 

Although we only identified fish or fish parts within `r round(gastric_tbl$fish_contents[gastric_tbl$event_name == "Total"] / gastric_tbl$lavaged[gastric_tbl$event_name == "Total"] * 100, 1)`% of Northern Pikeminnow examined and that fish remnants were only `r prettyNum(mean(stmch_df$p_fish) * 100, digits = 3)`% of the overall stomach contents, we believe those numbers to be misleading...

<!--
Concerns with gastric lavage. We only observed juvenile Chinook salmon (and/or other fishes) in a very small number of stomach contents. However, we don't necessarily believe that to mean that pikeminnow in Deadwater Slough rarely consume juvenile Chinook salmon. Are there other cases where gastric lavage failed to document predation? How soon after consumption do you need to take a sample? So instead, we made some assumptions about the proportion of a pikeminnows diet consisting of Chinook salmon.
-->


## Bioenergetics
<!--
OUR APPROACH:
1. g of fish consumed during DSR and NRR peak emigrations
2. Combine results from #1 for total g consumed by an individual NPM
3. Parse out the percentage of fish prey that is juvenile Chinook salmon
  - start w/ conservative scenarios of 10% and 25%
4. Divide total g consumed by 10.6 g, the average juvenile Chinook Salmon from Upper Salmon MPG, to estimate the # of juvenile Chinook Salmon consumed
5. Multiply results from #4 by a "stable" NPM population size estimate
6. Multiply results from #5 by SAR from McCann et al. 2019 for Upper Salmon MPG Chinook
-->

An average-size Northern Pikeminnow from Deadwater Slough is estimated to consume `r median(fall_g_summ$cumm_g)` g (range `r min(fall_g_summ$cumm_g)` - `r max(fall_g_summ$cumm_g)` g) and `r median(spring_g_summ$cumm_g)` g (range `r min(spring_g_summ$cumm_g)` - `r max(spring_g_summ$cumm_g)` g) of fish during spring and fall, respectively, to maintain its body weight using mean daily water temperatures recorded at a nearby stream gage [@USGS2016]. This equates to `r median(fall_g_summ$cumm_g) + median(spring_g_summ$cumm_g)` g of fish consumed during the DSR and NRR peak emigrations assuming the median value among diet scenarios (i.e., if 50% of their diet consists of fish); values ranged from a minimum of `r min(fall_g_summ$cumm_g) + min(spring_g_summ$cumm_g)` g if only 10% of the diet is fish to a maximum of `r max(fall_g_summ$cumm_g) + max(spring_g_summ$cumm_g)` g if 90% of the diet is fish.

<!-- The following needs to be updated after we finalize some results -->
This approach currently assumes that juvenile Chinook Salmon are the only fish prey available to or preyed upon by Northern Pikeminnow. It further assumes that all prey available have energy densities equal to juvenile Chinook Salmon, which may not be far from the truth, given that other salmonids including juvenile steelhead and Sockeye Salmon are likely also prevalent as available prey in Deadwater Slough, especially during the spring migration. Additionally, hatchery smolt releases (Chinook Salmon, steelhead, and Sockeye Salmon) are also prevalent in the mainstem Salmon River during the spring migration. However, our study is focused on potential impacts to natural-origin DSR and NRR Chinook Salmon, in which case, let’s consider a “thought exercise” where DSR and NRR Chinook Salmon represent only 10% and 25% of total fish prey consumed by Northern Pikeminnow during these periods. Under these scenarios, the average Northern Pikeminnow would consume 8.95 g (range 4.52 – 10.05 g) if 10% of prey were natural-origin Chinook Salmon and 22.38 g (range 11.31 – 25.12) if 25%. 

To estimate the total number of possible juvenile Chinook Salmon that could be consumed, we divided the cumulative consumption in grams for an individual Northern Pikeminnow by the average weight of a Chinook Salmon emigrant (taken from all rotary screw traps in the Upper Salmon MPG) to come up with a juvenile equivalency, and then multiplied this by a "stable" estimate of abundance for Northern Pikeminnow in Deadwater Slough, resulting in an estimate of the equivalent toal number of Chinook Salmon juveniles consumed. If we assume an average juvenile Chinook Salmon of 10.6 g, the mean from DSR and NRR Chinook Salmon emigrants in the Upper Salmon MPG, this equates to 0.84 juvenile Chinook Salmon (range 0.43 – 0.94) under the 10% scenario and 2.11 juvenile Chinook Salmon (range 1.07 – 2.37) under the 25% scenario.

Let’s now consider a stable Northern Pikeminnow population size of 10,000 (roughly the mean of fall and spring abundance estimates, divided by two to account for half of marked individuals not being available for recapture). In this case, the Northern Pikeminnow population in Deadwater Slough would be estimated to consume 8,400 (range 4,300 – 9,400) or 21,100 (range 10,700 – 23,700) under the 10% and 25% scenarios, respectively.


## Impacts to Adult Returns

<!-- Also update this after finalizing results -->
Finally, let's take our thought exercise one additional step and estimate the number of additional adult Chinook Salmon that might be expected to return to Lower Granite Dam if predation in the Deadwater Slough was reduced or eliminated. Our approach here was to multiply the total estimated juvenile Chinook Salmon consumed by an estimate of Granite-to-Granite smolt-to-adult survival rate (SAR) from @McCann2019 for Upper Salmon River MPG Chinook Salmon. Assuming an SAR of `r round(sar$medsar, 5)` (SE: `r prettyNum(round(sar$sdsar, 5))`) we'll consider the "adult equivalents" to our estimates of juveniles consumed. Under this scenario, the consumed juveniles would be equivalent to 51.6 adults (range 26.4 – 57.7) and 129.6 adults (range 65.7 – 145.6). However, we believe these 10% and 25% scenarios to be conservative, especially during the fall DSR emigration period. During spring, natural-origin steelhead and Sockeye Salmon are also actively emigrating from the Upper Salmon River and hatchery-origin releases of all three species (Chinook Salmon, steelhead, and Sockeye Salmon) are present in the river, and so 10% or 25% may be reasonable. However, during fall, DSR Chinook Salmon are likely the dominant prey species available to Chinook Salmon in Deadwater Slough as 1) no (or at least minimal) hatchery releases are present in the river and 2) fall emigrations of steelhead and Sockeye Salmon are less prominent than in Chinook Salmon. Note that this thought exercise only includes the Northern Pikeminnow population in Deadwater Slough even though they are present throughout the upper Salmon River, although likely at lower densities than in Deadwater Slough, and also ignores potential impacts to ESA-listed steelhead and Sockeye Salmon that are also a portion of the Northern Pikeminnow diet.

<!--
Additional thoughts here:
*	SAR results. Those results are GRA - GRA SARs, estimated from multiple years of PIT tag data. Seem pretty good to me.
* Maybe a plot of multiple scenarios
-->


## Avian Predation

Although not formally assessed in this study, avian predators including Great Blue Herons *Ardea herodias* and Bald Eagles *Haliaeetus leucocephalus* are another potential source of mortality for juvenile Chinook Salmon and other ESA-listed salmonids in the Deadwater Slough. the Deadwater Slough is recognized as an important bird watching and nesting area due to the associated upstream braided channels and riparian and backwater habitats [(Deadwater Slough - Audubon Important Bird Areas)](https://www.audubon.org/important-bird-areas/deadwater-slough#). Several piscivorous bird species have been documented using Deadwater Slough including the Common *Mergus merganser* and Hooded *Lophodytes cucullatus* mergansers, the Great Blue Heron, the Double-crested Cormorant *Phalacrocorax auritus*, and the Belted Kingfisher *Megaceryle alcyon* [@eBird2021]. During the initial sampling effort in fall 2019, a two-person crew walked the entire reach including surrounding and upstream areas scanning for passive integrated transponder (PIT) tags that are implanted into thousands of natural- and hatchery-origin salmonids in the Upper Salmon River, annually, to monitor movement and survival. During that informal survey, 10 PIT tags were recovered near active bird nests or in an upstream anastomizing reach where herons and eagles are prevalent, suggesting that mortality may have been a result of avian predation. The PIT tag histories in [PTAGIS](https://www.ptagis.org/) indicate these tags were implanted into a combination of juvenile Chinook Salmon (3), Sockeye Salmon (4), and steelhead (3), all juveniles. Two of the Chinook Salmon and one steelhead were natural-origin, the remaining were of hatchery-origin. Avian predation contributes a major component of the total mortality for yearling Chinook Salmon in some locations in the lower Snake and Columbia rivers, particularly at hydroelectric dams and within reservoirs [@Evans2012; -@Evans2016]; however, we did not observe large colonies of piscivorous birds within the study area. Although we did observe Belted Kingfishers, mergansers, and Great Blue Herons at Deadwater Slough during field efforts; Great Blue Herons were especially prevalent in the anastomizing reach immediately upriver of the slackwater reach. Additionally, there is documentation of individual Double-crested Cormorants [@eBird2021] at the Deadwater Slough, although the site is not within their breeding range; rather, it is part of a migration corridor. Given the current avian species known to occupy Deadwater Slough, it is unlikely that avian predation on juvenile salmonids is comparable to elsewhere in the Columbia River basin with large piscivorous bird colonies. Nevertheless, we hypothesize that the reservoir-like conditions and associated habitat features at the Deadwater Slough may increase the probability of avian predation on juvenile Chinook Salmon and other ESA-listed salmonids from the many piscivorous birds known to use the site. Future estimates of predation would benefit from consideration of the contribution of piscivorous avian predators.


## Management Implications

<!-- Again, some of the following numbers need to be updated after results are formalized -->
Chinook Salmon populations in the Upper Salmon River MPG support local fisheries and economies in years with sufficient abundance and have substantial cultural value in the region. These populations additionally support downriver commercial and subsistence fisheries in the Snake and Columbia rivers. Recovery of the MPG is desired which requires that at least five of the eight populations must meet criteria set forth by @McElhany2000 and @ICTRT2007 for the MPG to be considered viable and for recovery of the Snake River Evolutionary Significant Unit. Spawner abundance is perhaps the most important metric considered in determining a population's viability. We estimated that consumption of juvenile Chinook Salmon by Northern Pikeminnow in the Deadwater Slough potentially reduces annual adult natural-origin returns by 26.4 to 145.6 to upriver populations. Although this does not sound like a substantial amount, it represents 4.7% - 26.1% of the total mean adult escapement of 558 reported for the Upper Salmon River MPG in 2017 - 2019 [@Kinzer2020]. Presumably, reductions in adult returns also affect natural-origin Sockeye Salmon and steelhead as well as hatchery populations in the Upper Salmon which provide for recreational fishing opportunities. Consequently, reducing predation mortality at Deadwater Slough could potentially benefit multiple upriver natural and hatchery populations for multiple ESA-listed species. Because the Deadwater Slough is part of the migratory pathway for emigrating salmonids, including for multiple species and populations, the impact of that benefit could be higher than tributary rehabilitation actions, which typically benefit a single population. Moreover, the deepened, slack water conditions that favor northern pikeminnow at Deadwater Slough are indirectly the result of manmade activities i.e., the failure of a manmade mining reservoir dam. Given these reasons, it seems that Deadwater Slough could be a candidate for management or restoration actions to benefit local Chinook Salmon populations.

We envision two potential management actions at reducing predation at Deadwater Slough: 1) removing the Dump Creek alluvial fan and 2) a local Northern Pikeminnow bounty program to encourage harvest in Deadwater Slough aimed at reducing the predator population size. Both actions have evident pros and cons. Removing the Dump Creek alluvial fan has the benefit of restoring the Salmon River to a more natural flow (e.g., increased water velocity, decreased depth) and bathymetry (e.g., heterogeneous substrate) that likely existed in the reach prior to the failure of the mining reservoir dam in Dump Creek. Restoring flow would presumably reduce Northern Pikeminnow densities to levels similar to upstream and downstream reaches where recent studies identified higher survival and transition probabilities than those at Deadwater Slough (@Axel2015; @Ackerman2018; @Porter2019). However, we do not know the feasibility of removing or alleviating the Dump Creek alluvial fan, and if it could be removed or altered, future disturbance events could potentially move additional loose sediment in the Dump Creek drainage, thereby creating a new alluvial fan. Additionally, restoring the flow would likely diminish the value of the reach as an important bird watching and nesting area. 

Northern Pikeminnow bounty programs have proven successful at reducing population sizes and impacts on emigrating salmonids elsewhere (citation). A local bounty program in the Salmon River has the potential to boost the local economy (to an unknown degree) which has been negatively impacted by low returns of Chinook Salmon, steelhead, and Sockeye Salmon in recent decades. Many local business rely on license and gear sales for local sport fisheries, but low salmon and steelhead returns have eliminated or reduced the duration of fisheries in some years, and a local Northern Pikeminnow bounty program could allow the local economy to recoup some of those lost revenues. On the downside, bounty programs require continual effort and harvest to suppress the population size and so would require year of continued funding and local buy-in to remain effective. If funding or effort was alleviated, Northern Pikeminnow would likely recover to a higher population size without additional alterations to the habitat. 
<!--
What about adding cover? It could potentially provide refugia for juvenile salmonids, but could make recreational angling more difficult

Is there anything in the literature that discusses habitat preferences for pike minnow? If we speed up velocities and add some cover potentially pike minnow predation success will be lowered. Will these fish just move elsewhere? 
-->


## Conclusions

* We suggest that the habitat modifications that created the Deadwater Slough have resulted in favorable conditions for Northern Pikeminnow, including improved conditions for predation upon juvenile Chinook Salmon ***(add detail here)***. Therefore, predation by Northern Pikeminnow in the Deadwater Slough likely has a consequential impact on ESA-listed Chinook Salmon populations in the Upper Salmon River MPG.
*	We have also presented a novel modeling framework for estimating predation on native, critically endangered anadromous species which can be applied to other areas of interest. John day? Others?
*	The end. 


# Acknowledgements

The authors extend much appreciation to the many volunteers who assisted with field efforts including collaborators from the Bureau of Reclamation, Idaho Office of Species Conservation, Idaho Deparment of Fish and Game, and the Lemhi Regional Land Trust, among others. Special thanks to Chelsea Welke, Tulley Mackey, Jared Barker, and Brian Hamilton for their help in the field. Special thanks to Caitlin Alcott and Inter-Fluve for their administrative support and guidance. Funding for this study was provided by the Bureau of Reclamation, Pacific Northwest Regional Office (contract No. 140R1021F0018) with assistance from the Idaho Office of Species Conservation.


\newpage

# Literature Cited 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

# Tables

<div id="tables"></div>

```{r abund-data-lp}
LP_mod %>%
  select(event_name, species, data) %>%
  distinct() %>%
  select(-species) %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  rename(`Effort` = event_name) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Summary of Northern Pikeminnow angling survey data for single-census mark-recapture estimators. M is the total number of fish caught in the first sample (week), marked and returned to the population; n is the total number of fish caught in the second sample (week), and m is the number of previously marked fish caught in the second week.") %>%
  kable_styling()

```

\newpage

```{r abund-data-schn}
N_mods %>%
  select(event_name, species, data) %>%
  distinct() %>%
  select(-species) %>%
  unnest(data) %>%
  mutate(across(event_name,
                ~ str_replace(., "_", " "))) %>%
  select(event_name, date, M, n, m, u, R) %>%
  rename(`Effort` = event_name,
         Date = date) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Summary of Northern Pikeminnow angling survey data for multiple-census mark-recapture estimators. M is the total number of fish caught in previous samples (days), marked and returned to the population; n is the total number of fish caught in the current sample (day); m is the number of marked fish caught in that sample; u is the number of unmarked Northern Pikeminnow caught, and R is the number of marked fish returned to the population. Dates of sampling are also provided.") %>%
  kable_styling()

```

\newpage

```{r abund-tab}
all_est %>%
  select(-c(species, range:prop_range)) %>%
  rename(`Effort` = event_name,
         Estimator = model,
         `L CI` = Lci,
         `U CI` = Uci) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Point estimates, standard errors, and 95% confidence intervals for each of the mark-recapture estimators and for the fall sampling efforts. Standard errors are not available for the multiple-census estimators.") %>%
  kable_styling()

```

```{r spring-N, eval = F}
spring_abund %>%
  rowwise() %>%
  mutate(`Avg. Fall N (CI)` = paste0(prettyNum(round(N_F), big.mark = ","),
                                     " (",
                                     paste0(prettyNum(round(c(Lci_F, Uci_F)), big.mark = ","),
                                            collapse = ", "),
                                     ")"),
         `Spring N (CI)` = paste0(prettyNum(round(N_S), big.mark = ","),
                                     " (",
                                     paste0(prettyNum(round(c(Lci_S, Uci_S)), big.mark = ","),
                                            collapse = ", "),
                                     ")")) %>%
  ungroup() %>%
  select(Species = species,
         `Avg Fall CPUE` = cpue_F,
         `Spring CPUE` = cpue_S,
         ends_with("(CI)")) %>%
  kable(booktabs = T,
        caption = "Average CPUE and abundance in the fall (95% confidence interval), and CPUE and estimates of spring abundance (95% confidence interval) for Northern Pikeminnow in Deadwater Slough.") %>%
  kable_styling()

```

\newpage

```{r gastric-tab}
gastric_tbl %>%
  rename(Effort = event_name,
         Captured = captured,
         Lavaged = lavaged,
         'Stomach Contents' = stmch_contents,
         'Fish Contents' = fish_contents) %>%
  mutate(Effort = recode(Effort,
                         `Fall_2019` = "Fall 2019",
                         `Fall_2020` = "Fall 2020",
                         `Spring_2021` = "Spring 2021")) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Summary of gastric lavage results including the total number of fish captured and gastric lavaged. For Northern Pikeminnow that were gastric lavaged, we show the number containing stomach contents, and of those, the number containing fish contents.") %>%
  kable_styling()

```

\newpage

```{r adult-imp}
adult_impact %>%
  select(season,
         perc_diet,
         juv_chnk,
         smolt_N,
         smolt_Lci,
         smolt_Uci,
         medsar,
         sdsar,
         adult_N,
         adult_Lci,
         adult_Uci) %>%
  mutate(juv_chnk = round(juv_chnk, 2),
         smolt_N = round(smolt_N, 0),
         smolt_Lci = round(smolt_Lci, 0),
         smolt_Uci = round(smolt_Uci, 0),
         medsar = round(medsar, 5),
         sdsar = round(sdsar, 5),
         adult_N = round(adult_N, 0),
         adult_Lci = round(adult_Lci, 0),
         adult_Uci = round(adult_Uci, 0)) %>%
  rename(Season = season,
         `p Fish` = perc_diet,
         `Fish Per NPM` = juv_chnk,
         `Fish N` = smolt_N,
         `Fish L CI` = smolt_Lci,
         `Fish U CI` = smolt_Uci,
         `Median SAR` = medsar,
         `SD SAR` = sdsar,
         `Adult N` = adult_N,
         `Adult L CI` = adult_Lci,
         `Adult U CI` = adult_Uci) %>%
  kable(booktabs = T,
        format.args = list(big.mark = ","),
        caption = "Estimates of the number of fish consumed for each season and diet scenario. The diet scenario indicates the proportion of the Northern Pikeminnow diet consisting of fish. The 'Fish Per NPM' column indicates the number of fish an individual Northern Pikeminnow to consume during the fall or spring seasons assuming an average weight of 10.3 (DSR) and 10.9 (NRR) grams for juvenile Chinook Salmon and is taken from each of the 18 bioenergetics model runs. The number of fish consumed (and 95% confidence intervals) are calculated using Northern Pikeminnow abundance estimates of 28,144 (95% CI: 14,378 - 59,978) for fall and 14,897 (95% CI: 7,610 - 31,747) for spring. The number of 'adult equivalents' is also estimated using a Lower Granite Dam smolt-to-adult rate (SAR) for Chinook Salmon from McCann et al. 2019.") %>%
  kable_styling(font_size = 8)

# adult_impact %>%
#   mutate(stage = "Smolt") %>%
#   select(#event_name, 
#          #model,
#          stage,
#          starts_with("smolt")) %>%
#   rename_with(.fn = ~ str_remove(., "smolt_"),
#               .cols = starts_with("smolt")) %>%
#   bind_rows(adult_impact %>%
#               mutate(stage = "Adult Equivalent") %>%
#               select(#event_name, model,
#                      stage,
#                      starts_with("adult")) %>%
#               rename_with(.fn = ~ str_remove(., "adult_"),
#                           .cols = starts_with("adult"))) %>%
#   kable(booktabs = T,
#         format.args = list(big.mark = ","),
#         col.names = c("Stage",
#                       "N",
#                       "Lower 95% CI",
#                       "Upper 95% CI"),
#         digits = 0,
#         caption = "Estimates of smolts consumed during fall migration by Northern Pikeminnow, and the adult equivalent of those smolts based on SARs.") %>%
#   kable_styling()

```

\newpage

# Figures

<div id="figures"></div>

```{r map, out.width = "85%", fig.cap = "Map of the Deadwater Slough study area. The high-resolution orthoimage portion surrounding the Deadwater Slough was generated from aerial images taken by an unmanned aircraft system (drone). The red polygon indicates the reach characterized by unnaturally slow water velocities and a deepened channel. The location of the Dump Creek delta is indicated."}
knitr::include_graphics("../figures/deadwater_map_low_res.png")

```

\newpage

```{r cpue-fig, fig.cap = "The number of Northern Pikeminnow caught per angler effort for each sample effort."}
total_cpue %>%
  ggplot(aes(x = event_name,
             y = catch_per_hr)) +
  geom_col(fill = "gray30") +
  labs(y = "Catch Per Angler Hour") +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(size = 11,
                                   color = "black"),
        axis.title.y = element_text(vjust = 3),
        axis.text.y = element_text(size = 11,
                                   color = "black"))

```

\newpage

```{r abund-fig, fig.cap = "Estimates of abundance of Northern Pikeminnow using different mark-recapture estimators and for the fall sampling events. Note the y-axis is truncated at 100."}
all_est %>%
  mutate(across(c(N, Lci, Uci),
                ~ . / 1000)) %>%
  ggplot(aes(x = model,
             y = N,
             color = model)) +
  geom_point(size = 4) +
  geom_errorbar(aes(ymin = Lci,
                    ymax = Uci),
                width = 0.1) +
  facet_wrap(~ event_name) +
  coord_cartesian(ylim = c(0, 100)) +
  labs(x = "Estimator",
       y = "Abundance (x 1,000)") +
  #theme_bw() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 45,
                                   hjust = 1,
                                   size = 11,
                                   color = "black"),
        axis.text.y = element_text(size = 11,
                                   color = "black"),
        strip.text.x = element_text(size = 11,
                                    color = "black")) +
  scale_color_brewer(palette = "Dark2")

```

\newpage

```{r stmch-cont-p, eval = F, fig.cap = "A stomach contents plot."}
stmch_cont_per_sz_p = gastric_df %>%
  filter(method %in% "Angling") %>%
  ggplot() +
  aes(x = fish_or_parts) +
  geom_bar(fill = "#DB740E") +
  labs(x = "Stomach Contents",
       y = "Frequency") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1)) +
  facet_wrap(vars(npm_50),
             nrow = 2L)

stmch_cont_per_sz_p

```

```{r length-freq-p, fig.cap = "Length frequency histogram of Northern Pikeminnow caught using hook-and-line angling during the study."}
length_freq_p = gastric_df %>%
  ggplot(aes(length)) +
  geom_histogram(breaks = seq(150, 650, by = 50),
                 col = "black",
                 fill = "gray30",
                 alpha = .2) +
  labs(x = "Total Length (mm)",
       y = "Frequency") +
  xlim(c(100, 700)) +
  ylim(c(0, 800)) +
  scale_x_continuous(breaks = seq(0, 650, by = 50)) +
  scale_y_continuous(breaks = seq(0, 550, by = 50)) +
  theme(axis.text.x = element_text(size = 11,
                                   color = "black"),
        axis.text.y = element_text(size = 11,
                                   color = "black",
                                   vjust = 3)) +
  theme_classic()

length_freq_p

```

\newpage

```{r bio-p, fig.cap = "The cumulative amount of fish (g) consumed by an individual Northern Pikeminnow during the peak DSR (fall) and NRR (spring) Chinook Salmon emigrations (top panel) and corresponding daily mean water temperatures (bottom panel). The black line is the median among diet scenarios (i.e., where 50% of the Northern Pikeminnow diet consists of fish) and the gray area shows the range among model scenarios (i.e., 10 - 90% of Northern Pikeminnow diet consists of fish). Daily mean water temperatures were summarized from six years of data available from the Shoup gage station. "}
spring_results$season = "Spring"
fall_results$season = "Fall"
bio_results = rbind(spring_results, fall_results)
bio_results$ymd = (ymd(bio_results$date))

pFish = bio_results %>%
  ggplot(aes(ymd, f50_g)) +
  geom_line(size = 1.15) +
  geom_ribbon(data = bio_results,
              aes(ymd,
                  ymin = f10_g,
                  ymax = f90_g),
              color = "grey65",
              alpha = 0.4) +
  theme_bw() +
  labs(y = "Fish consumed (g)",
       x = "",
       title = "") +
  facet_rep_wrap(~season,
                 scales = "free_x",
                 repeat.tick.labels = F) +
  theme(strip.background = element_rect(color = "white",
                                        fill = "white"),
        strip.text.x = element_text(size = 12),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 11,
                                   color = "black"),
        axis.title.y = element_text(vjust = 1,
                                    size = 12),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        plot.margin = unit(c(-.1, .3, -.3, .2), "cm"))

pTemp = bio_results %>%
  ggplot(aes(ymd, temperature_c)) +
  geom_line(color = "navyblue",
            size = 1.15) +
  theme_bw() +
  labs(y = expression("Water temp"*~degree*C),
       x = "Month",
       title = "") +
  facet_rep_wrap(~season,
                 scales = "free_x",
                 repeat.tick.labels = F) +
  theme(strip.background = element_rect(color = "white",
                                        fill = "white"),
        strip.text.x = element_blank(),
        axis.text.x = element_text(size = 11,
                                   color = "black"),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 11,
                                   color = "black"),
        axis.title.y = element_text(vjust = 0.1,
                                    size = 12),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        plot.margin = unit(c(-.1, .3, .1, .1), "cm"))

p_list = list(pFish, pTemp)
n_col = floor(sqrt(length(p_list)))

bio_p = do.call("grid.arrange",
                c(p_list, ncol = n_col))

```

\newpage

```{r adult-imp-p, fig.cap = "The estimated number of DSR (fall) and NRR (spring) emigrants consumed by Northern Pikeminnow in Deadwater Slough (top panel) across a range of diet scenarios where 10-90% of the diet consists of juvenile Chinook salmon. The bottom panel provides the adult equivalents assuming a Lower Granite Dam smolt-to-adult rate (SAR) from McCann et al. 2019."}
adult_impact %>%
  mutate(stage = "Juv. Emigrant") %>%
  select(stage,
         season,
         perc_diet,
         starts_with("smolt")) %>%
  rename_with(.fn = ~ str_remove(., "smolt_"),
              .cols = starts_with("smolt")) %>%
  bind_rows(adult_impact %>%
              mutate(stage = "Adult Equivalent") %>%
              select(stage,
                     season,
                     perc_diet,
                     starts_with("adult")) %>%
              rename_with(.fn = ~ str_remove(., "adult_"),
                          .cols = starts_with("adult"))) %>%
  ggplot(aes(x = perc_diet,
             y = N,
             color = as.factor(perc_diet))) +
  geom_errorbar(aes(ymin = Lci,
                    ymax = Uci),
                width = 0.1) +
  geom_point(size = 4) +
  facet_grid(fct_rev(stage) ~ season,
             scales = "free_y") +
  scale_color_viridis_d(name = "Percent\nFish in Diet") +
  theme(axis.text.x = element_blank(),
        legend.position = "bottom",
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.text.y = element_text(size = 11,
                                   color = "black"),
        strip.text.x = element_text(size = 11,
                                    color = "black"),
        strip.text.y = element_text(size = 11,
                                    color = "black")) +
  labs(y = "Number Chinook Consumed")

```

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()

```

\newpage

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())

```
